<html lang="en"><head>
    <meta charset="utf-8">
    <title>The Browser DOM</title>
    <script src="https://www.w3.org/Tools/respec/respec-w3c-common" class="remove"></script>
    <script class="remove">
      var respecConfig = {
              specStatus:     "ED"
          ,   shortName:      "browser-dom"
          ,   editors:      [{ name: "Up for the taking" }]
          ,   wg:             "HTML Working Group"
          ,   wgURI:          "http://www.w3.org/html/wg/"
          ,   wgPublicList:   "public-html"
          ,   wgPatentURI:    "http://www.w3.org/2004/01/pp-impl/40318/status"
          ,   license:        "cc-by"
          ,   processVersion: "2014"
        };
    </script>
  </head>
  <body>
    <section id="abstract">
      <p>
        Some DOM interfaces and behaviours used in browsers such as <code>History</code> or <code>Location</code>.
      </p>
    </section>
    <section id="sotd">
      <p>
        This specification is an experimental breakup of the
        <a href="http://www.w3.org/TR/html51/">HTML specification</a>. You can see the full list on
        <a href="https://darobin.github.io/breakup/specs/">the index page</a> and take part in the
        discussion in <a href="https://github.com/darobin/breakup/">the repository</a>.
      </p>
    </section>
  

<section><h3 id="documents">3.1 Documents</h3>

  <p>Every XML and HTML document in an HTML UA is represented by a <code id="documents:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object. <a href="#refsDOM">[DOM]</a></p>

  <p><dfn id="the-document's-address"><a href="https://dom.spec.whatwg.org/#concept-document-url">The document's
  address</a></dfn> is the <i>URL associated with a <code id="documents:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code></i> (as defined in the DOM
  standard). It is initially set when the <code id="documents:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, but that can change
  during the lifetime of the <code id="documents:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>; for example, it changes when the user <a href="#navigate" id="documents:navigate">navigates</a> to a <a href="#scroll-to-fragid" id="documents:scroll-to-fragid">fragment identifier</a>
  on the page and when the <code id="documents:dom-history-pushstate"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState()</a></code> method is called
  with a new <a href="/breakup/specs/core-algorithms/#url" id="documents:url">URL</a>. <a href="#refsDOM">[DOM]</a></p>
  

  <p class="warning">Interactive user agents typically expose <a id="documents:the-document's-address" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a> in
  their user interface. This is the primary mechanism by which a user can tell if a site is
  attempting to impersonate another.</p>

  <p>When a <code id="documents:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created by a <a href="/breakup/specs/browser-dom/#concept-script" id="documents:concept-script">script</a> using
  the <code id="documents:dom-domimplementation-createdocument"><a href="/breakup/specs/core-algorithms/#dom-domimplementation-createdocument">createDocument()</a></code> or <code id="documents:dom-domimplementation-createhtmldocument"><a href="/breakup/specs/core-algorithms/#dom-domimplementation-createhtmldocument">createHTMLDocument()</a></code> APIs, <a id="documents:the-document's-address-2" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the
  document's address</a> is the same as <a id="documents:the-document's-address-3" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a> of the
  <a href="/breakup/specs/browser-dom/#responsible-document" id="documents:responsible-document">responsible document</a> specified by the script's <a href="/breakup/specs/browser-dom/#settings-object" id="documents:settings-object">settings object</a>, and the
  <code id="documents:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is both <a href="#ready-for-post-load-tasks" id="documents:ready-for-post-load-tasks">ready for post-load tasks</a> and <a href="#completely-loaded" id="documents:completely-loaded">completely
  loaded</a> immediately.</p>

  <p><dfn id="the-document's-referrer">The document's referrer</dfn> is an <a href="/breakup/specs/core-algorithms/#absolute-url" id="documents:absolute-url">absolute URL</a> that can be set when the
  <code id="documents:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created. If it is not explicitly set, then its value is the empty
  string.</p>

  <p>Each <code id="documents:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object has a <dfn id="reload-override-flag">reload override flag</dfn> that is originally
  unset. The flag is set by the <code id="documents:dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> and <code id="documents:dom-document-open-2"><a href="/breakup/specs/browser-dom/#dom-document-open">document.write()</a></code> methods in certain situations. When the flag is
  set, the <code id="documents:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> also has a <dfn id="reload-override-buffer">reload override buffer</dfn> which is a Unicode
  string that is used as the source of the document when it is reloaded.</p>

  <p>When the user agent is to perform <dfn id="an-overridden-reload">an overridden reload</dfn>, given a <a href="#source-browsing-context" id="documents:source-browsing-context">source
  browsing context</a>, it must act as follows:</p>

  <ol><li><p>Let <var>source</var> be the value of the <a href="/breakup/specs/browser-dom/#browsing-context" id="documents:browsing-context">browsing context</a>'s
   <a href="/breakup/specs/browser-dom/#active-document" id="documents:active-document">active document</a>'s <a href="/breakup/specs/browser-dom/#reload-override-buffer" id="documents:reload-override-buffer">reload override buffer</a>.</p></li><li><p>Let <var>address</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="documents:browsing-context-2">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="documents:active-document-2">active
   document</a>'s <a href="https://dom.spec.whatwg.org/#concept-document-url" id="documents:the-document's-address-4" data-x-internal="the-document's-address">address</a>.</p></li><li>

    <p><a href="#navigate" id="documents:navigate-2">Navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="documents:browsing-context-3">browsing context</a> to
    a resource whose source is <var>source</var>, with <a href="#replacement-enabled" id="documents:replacement-enabled">replacement enabled</a>
    and <a href="#exceptions-enabled" id="documents:exceptions-enabled">exceptions enabled</a>. The <a href="#source-browsing-context" id="documents:source-browsing-context-2">source browsing context</a> is that given to
    the <a href="/breakup/specs/browser-dom/#an-overridden-reload" id="documents:an-overridden-reload">overridden reload</a> algorithm. When the
    <a href="#navigate" id="documents:navigate-3">navigate</a> algorithm creates a <code id="documents:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object for this purpose, set
    that <code id="documents:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#reload-override-flag" id="documents:reload-override-flag">reload override flag</a> and set its <a href="/breakup/specs/browser-dom/#reload-override-buffer" id="documents:reload-override-buffer-2">reload override
    buffer</a> to <var>source</var>.</p>

    <p>When it comes time to <a href="#set-the-document's-address" id="documents:set-the-document's-address">set the document's address</a> in the <a href="#navigate" id="documents:navigate-4">navigation algorithm</a>, use <var>address</var> as the
    <a href="#override-url" id="documents:override-url">override URL</a>.</p>

   </li></ol>



  <section><h4 id="the-document-object">3.1.1 The <code id="the-document-object:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object</h4>

  <p>The DOM specification defines a <code id="the-document-object:dom-document"><a href="/breakup/specs/core-algorithms/#dom-document">Document</a></code> interface, which
  this specification extends significantly:</p>

  <pre class="idl">enum <dfn id="documentreadystate">DocumentReadyState</dfn> { "loading", "interactive", "complete" };

[OverrideBuiltins]
partial /*sealed*/ interface <dfn id="document">Document</dfn> {
  // <a href="/breakup/specs/browser-dom/#resource-metadata-management" id="the-document-object:resource-metadata-management">resource metadata management</a>
  [PutForwards=<a href="/breakup/specs/core-algorithms/#dom-url-href" id="the-document-object:dom-url-href">href</a>, Unforgeable] readonly attribute <a href="/breakup/specs/browser-dom/#location" id="the-document-object:location">Location</a>? <a href="/breakup/specs/browser-dom/#dom-document-location" id="the-document-object:dom-document-location">location</a>;
  attribute DOMString <a href="/breakup/specs/browser-dom/#dom-document-domain" id="the-document-object:dom-document-domain">domain</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-document-referrer" id="the-document-object:dom-document-referrer">referrer</a>;
  attribute DOMString <a href="/breakup/specs/browser-dom/#dom-document-cookie" id="the-document-object:dom-document-cookie">cookie</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-document-lastmodified" id="the-document-object:dom-document-lastmodified">lastModified</a>;
  readonly attribute <a href="/breakup/specs/browser-dom/#documentreadystate" id="the-document-object:documentreadystate">DocumentReadyState</a> <a href="/breakup/specs/browser-dom/#dom-document-readystate" id="the-document-object:dom-document-readystate">readyState</a>;

  // <a href="/breakup/specs/browser-dom/#dom-tree-accessors" id="the-document-object:dom-tree-accessors">DOM tree accessors</a>
  <a href="/breakup/specs/browser-dom/#dom-document-nameditem" id="the-document-object:dom-document-nameditem">getter</a> object (DOMString name);
  attribute DOMString <a href="/breakup/specs/browser-dom/#document.title" id="the-document-object:document.title">title</a>;
  attribute DOMString <a href="#dom-document-dir" id="the-document-object:dom-document-dir">dir</a>;
  attribute <a href="#htmlelement" id="the-document-object:htmlelement">HTMLElement</a>? <a href="/breakup/specs/browser-dom/#dom-document-body" id="the-document-object:dom-document-body">body</a>;
  readonly attribute <a href="#htmlheadelement" id="the-document-object:htmlheadelement">HTMLHeadElement</a>? <a href="/breakup/specs/browser-dom/#dom-document-head" id="the-document-object:dom-document-head">head</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-images" id="the-document-object:dom-document-images">images</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-2">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-embeds" id="the-document-object:dom-document-embeds">embeds</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-3">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-plugins" id="the-document-object:dom-document-plugins">plugins</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-4">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-links" id="the-document-object:dom-document-links">links</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-5">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-forms" id="the-document-object:dom-document-forms">forms</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-6">HTMLCollection</a> <a href="/breakup/specs/browser-dom/#dom-document-scripts" id="the-document-object:dom-document-scripts">scripts</a>;
  NodeList <a href="/breakup/specs/browser-dom/#dom-document-getelementsbyname" id="the-document-object:dom-document-getelementsbyname">getElementsByName</a>(DOMString elementName);
  NodeList <a href="http://www.w3.org/TR/microdata/#dom-document-getitems" id="the-document-object:dom-document-getitems">getItems</a>(optional DOMString typeNames = ""); // <a href="http://www.w3.org/TR/microdata/#microdata" id="the-document-object:microdata">microdata</a>
  [SameObject] readonly attribute <a href="/breakup/specs/core-algorithms/#domelementmap-2" id="the-document-object:domelementmap-2">DOMElementMap</a> <a href="/breakup/specs/browser-dom/#dom-document-csselementmap" id="the-document-object:dom-document-csselementmap">cssElementMap</a>;
  readonly attribute <a href="#htmlscriptelement" id="the-document-object:htmlscriptelement">HTMLScriptElement</a>? <a href="/breakup/specs/browser-dom/#dom-document-currentscript" id="the-document-object:dom-document-currentscript">currentScript</a>;

  // <a href="/breakup/specs/browser-dom/#dynamic-markup-insertion" id="the-document-object:dynamic-markup-insertion">dynamic markup insertion</a>
  <a href="/breakup/specs/browser-dom/#document" id="the-document-object:document-2">Document</a> <a href="/breakup/specs/browser-dom/#dom-document-open" id="the-document-object:dom-document-open">open</a>(optional DOMString type = "text/html", optional DOMString replace = "");
  <a href="/breakup/specs/browser-dom/#windowproxy" id="the-document-object:windowproxy">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-document-open" id="the-document-object:dom-document-open-2">open</a>(DOMString url, DOMString name, DOMString features, optional boolean replace = false);
  void <a href="/breakup/specs/browser-dom/#dom-document-close" id="the-document-object:dom-document-close">close</a>();
  void <a href="/breakup/specs/browser-dom/#dom-document-write" id="the-document-object:dom-document-write">write</a>(DOMString... text);
  void <a href="/breakup/specs/browser-dom/#dom-document-writeln" id="the-document-object:dom-document-writeln">writeln</a>(DOMString... text);

  // <a href="#editing" id="the-document-object:editing">user interaction</a>
  readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-document-object:windowproxy-2">WindowProxy</a>? <a href="/breakup/specs/browser-dom/#dom-document-defaultview" id="the-document-object:dom-document-defaultview">defaultView</a>;
  readonly attribute <a href="/breakup/specs/core-algorithms/#element" id="the-document-object:element">Element</a>? <a href="#dom-document-activeelement" id="the-document-object:dom-document-activeelement">activeElement</a>;
  boolean <a href="#dom-document-hasfocus" id="the-document-object:dom-document-hasfocus">hasFocus</a>();
  attribute DOMString <a href="#designMode" id="the-document-object:designMode">designMode</a>;
  boolean <a href="#execCommand" id="the-document-object:execCommand">execCommand</a>(DOMString commandId, optional boolean showUI = false, optional DOMString value = "");
  boolean <a href="#dom-document-querycommandenabled" id="the-document-object:dom-document-querycommandenabled">queryCommandEnabled</a>(DOMString commandId);
  boolean <a href="#dom-document-querycommandindeterm" id="the-document-object:dom-document-querycommandindeterm">queryCommandIndeterm</a>(DOMString commandId);
  boolean <a href="#dom-document-querycommandstate" id="the-document-object:dom-document-querycommandstate">queryCommandState</a>(DOMString commandId);
  boolean <a href="#dom-document-querycommandsupported" id="the-document-object:dom-document-querycommandsupported">queryCommandSupported</a>(DOMString commandId);
  DOMString <a href="#dom-document-querycommandvalue" id="the-document-object:dom-document-querycommandvalue">queryCommandValue</a>(DOMString commandId);
  readonly attribute <a href="/breakup/specs/core-algorithms/#htmlcollection" id="the-document-object:htmlcollection-7">HTMLCollection</a> <a href="#dom-document-commands" id="the-document-object:dom-document-commands">commands</a>;

  // special <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="the-document-object:event-handler-idl-attributes">event handler IDL attributes</a> that only apply to Document objects
  [LenientThis] attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="the-document-object:eventhandler">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onreadystatechange" id="the-document-object:handler-onreadystatechange">onreadystatechange</a>;

  // <a href="#Document-partial">also has obsolete members</a>
};
<a href="/breakup/specs/browser-dom/#document" id="the-document-object:document-3">Document</a> implements <a href="/breakup/specs/browser-dom/#globaleventhandlers" id="the-document-object:globaleventhandlers">GlobalEventHandlers</a>;</pre></section>



  <section><h4 id="resource-metadata-management">3.1.2 <dfn>Resource metadata management</dfn></h4>

  <dl class="domintro"><dt><var>document</var> . <code id="resource-metadata-management:dom-document-referrer"><a href="/breakup/specs/browser-dom/#dom-document-referrer">referrer</a></code></dt><dd>

    <p>Returns <a href="https://dom.spec.whatwg.org/#concept-document-url" id="resource-metadata-management:the-document's-address" data-x-internal="the-document's-address">the address</a> of the <code id="resource-metadata-management:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
    from which the user navigated to this one, unless it was blocked or there was no such document,
    in which case it returns the empty string.</p>

    <p>The <code id="resource-metadata-management:link-type-noreferrer"><a href="#link-type-noreferrer">noreferrer</a></code> link type can be used to block the
    referrer.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-referrer"><code>referrer</code></dfn> attribute must return
  <a href="/breakup/specs/browser-dom/#the-document's-referrer" id="resource-metadata-management:the-document's-referrer">the document's referrer</a>.</p>

  

  <p class="note">In the case of HTTP, the <code id="resource-metadata-management:dom-document-referrer-2"><a href="/breakup/specs/browser-dom/#dom-document-referrer">referrer</a></code> IDL
  attribute will match the <code id="resource-metadata-management:http-referer"><a href="/breakup/specs/core-algorithms/#http-referer">Referer</a></code> (sic) header that was sent when
  <a href="/breakup/specs/core-algorithms/#fetch" id="resource-metadata-management:fetch">fetching</a> the current page.</p>

  <p class="note">Typically user agents are configured to not report referrers in the case where the
  referrer uses an encrypted protocol and the current page does not (e.g. when navigating from an
  <code id="resource-metadata-management:https-protocol"><a data-x-internal="https-protocol" href="http://tools.ietf.org/html/rfc7230#section-2.7.2">https:</a></code> page to an <code id="resource-metadata-management:http-protocol"><a data-x-internal="http-protocol" href="http://tools.ietf.org/html/rfc7230#section-2.7.1">http:</a></code>
  page).</p>

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="resource-metadata-management:dom-document-cookie"><a href="/breakup/specs/browser-dom/#dom-document-cookie">cookie</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns the HTTP cookies that apply to the <code id="resource-metadata-management:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>. If there are no cookies or
    cookies can't be applied to this resource, the empty string will be returned.</p>

    <p>Can be set, to add a new cookie to the element's set of HTTP cookies.</p>

    <p>If the contents are <a href="/breakup/specs/browser-dom/#sandboxed-origin-browsing-context-flag" id="resource-metadata-management:sandboxed-origin-browsing-context-flag">sandboxed into a
    unique origin</a> (e.g. in an <code id="resource-metadata-management:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> with the <code id="resource-metadata-management:attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute), a <code id="resource-metadata-management:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception
    will be thrown on getting and setting.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-cookie"><code>cookie</code></dfn> attribute represents the cookies
  of the resource identified by <a id="resource-metadata-management:the-document's-address-2" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a>.</p>

  <p>A <code id="resource-metadata-management:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object that falls into one of the following conditions is a
  <dfn id="cookie-averse-document-object">cookie-averse <code>Document</code> object</dfn>:</p>

  <ul><li>A <code id="resource-metadata-management:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that has no <a href="/breakup/specs/browser-dom/#browsing-context" id="resource-metadata-management:browsing-context">browsing context</a>.</li><li>A <code id="resource-metadata-management:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> whose <a href="https://dom.spec.whatwg.org/#concept-document-url" id="resource-metadata-management:the-document's-address-3" data-x-internal="the-document's-address">address</a> does not
   use a server-based naming authority.</li></ul>

  

  <p id="sandboxCookies">On getting, if the document is a <a href="/breakup/specs/browser-dom/#cookie-averse-document-object" id="resource-metadata-management:cookie-averse-document-object">cookie-averse <code>Document</code>
  object</a>, then the user agent must return the empty string. Otherwise, if the
  <code id="resource-metadata-management:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#origin-2" id="resource-metadata-management:origin-2">origin</a> is not a scheme/host/port tuple, the user agent must
  throw a <code id="resource-metadata-management:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception. Otherwise, the user agent must first <a href="/breakup/specs/browser-dom/#obtain-the-storage-mutex" id="resource-metadata-management:obtain-the-storage-mutex">obtain
  the storage mutex</a> and then return the <a href="/breakup/specs/core-algorithms/#cookie-string" id="resource-metadata-management:cookie-string">cookie-string</a> for <a id="resource-metadata-management:the-document's-address-4" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a>
  for a "non-HTTP" API, decoded using the <a href="/breakup/specs/core-algorithms/#utf-8-decoder" id="resource-metadata-management:utf-8-decoder">UTF-8 decoder</a>. <a href="#refsCOOKIES">[COOKIES]</a>
  <a href="/breakup/specs/html/#fingerprinting-vector" id="resource-metadata-management:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>On setting, if the document is a <a href="/breakup/specs/browser-dom/#cookie-averse-document-object" id="resource-metadata-management:cookie-averse-document-object-2">cookie-averse <code>Document</code> object</a>, then
  the user agent must do nothing. Otherwise, if the <code id="resource-metadata-management:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#origin-2" id="resource-metadata-management:origin-2-2">origin</a> is
  not a scheme/host/port tuple, the user agent must throw a <code id="resource-metadata-management:securityerror-3"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception.
  Otherwise, the user agent must <a href="/breakup/specs/browser-dom/#obtain-the-storage-mutex" id="resource-metadata-management:obtain-the-storage-mutex-2">obtain the storage mutex</a> and then act as it would when
  <a href="/breakup/specs/core-algorithms/#receives-a-set-cookie-string" id="resource-metadata-management:receives-a-set-cookie-string">receiving a set-cookie-string</a> for <a id="resource-metadata-management:the-document's-address-5" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the
  document's address</a> via a "non-HTTP" API, consisting of the new value encoded as UTF-8. <a href="#refsCOOKIES">[COOKIES]</a> <a href="#refsENCODING">[ENCODING]</a></p>

  <p class="note">Since the <code id="resource-metadata-management:dom-document-cookie-2"><a href="/breakup/specs/browser-dom/#dom-document-cookie">cookie</a></code> attribute is accessible
  across frames, the path restrictions on cookies are only a tool to help manage which cookies are
  sent to which parts of the site, and are not in any way a security feature.</p>

  <hr>

  

  <dl class="domintro"><dt><var>document</var> . <code id="resource-metadata-management:dom-document-lastmodified"><a href="/breakup/specs/browser-dom/#dom-document-lastmodified">lastModified</a></code></dt><dd>
    <p>Returns the date of the last modification to the document, as reported by the server, in the
    form "<code>MM/DD/YYYY&nbsp;hh:mm:ss</code>", in the user's local time zone.</p>
    <p>If the last modification date is not known, the current time is returned instead.</p>
   </dd></dl>

  

  <p>The <dfn id="dom-document-lastmodified"><code>lastModified</code></dfn> attribute, on
  getting, must return the date and time of the <code id="resource-metadata-management:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s source file's last
  modification, in the user's local time zone, in the following format:</p>

  <ol><li> The month component of the date. </li><li> A U+002F SOLIDUS character (/). </li><li> The day component of the date. </li><li> A U+002F SOLIDUS character (/). </li><li> The year component of the date. </li><li> A U+0020 SPACE character. </li><li> The hours component of the time. </li><li> A U+003A COLON character (:). </li><li> The minutes component of the time. </li><li> A U+003A COLON character (:). </li><li> The seconds component of the time. </li></ol>

  <p>All the numeric components above, other than the year, must be given as two <a href="/breakup/specs/core-algorithms/#ascii-digits" id="resource-metadata-management:ascii-digits">ASCII
  digits</a> representing the number in base ten, zero-padded if necessary. The year must be
  given as the shortest possible string of four or more <a href="/breakup/specs/core-algorithms/#ascii-digits" id="resource-metadata-management:ascii-digits-2">ASCII digits</a> representing the
  number in base ten, zero-padded if necessary.</p>

  <p>The <code id="resource-metadata-management:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s source file's last modification date and time must be derived from
  relevant features of the networking protocols used, e.g. from the value of the HTTP <code id="resource-metadata-management:http-last-modified"><a href="/breakup/specs/core-algorithms/#http-last-modified">Last-Modified</a></code> header of the document, or from metadata in the
  file system for local files. If the last modification date and time are not known, the attribute
  must return the current date and time in the above format.</p>

  <hr>

  

  <dl class="domintro"><dt><var>document</var> . <code id="resource-metadata-management:dom-document-readystate"><a href="/breakup/specs/browser-dom/#dom-document-readystate">readyState</a></code></dt><dd>
    <p>Returns "<code>loading</code>" while the <code id="resource-metadata-management:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is loading, "<code>interactive</code>" once it is finished parsing but still loading sub-resources, and
    "<code>complete</code>" once it has loaded.</p>
    <p>The <code id="resource-metadata-management:event-readystatechange"><a href="/breakup/specs/html/#event-readystatechange">readystatechange</a></code> event fires on the
    <code id="resource-metadata-management:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object when this value changes.</p>
   </dd></dl>

  

  <p>Each document has a <dfn id="current-document-readiness">current document readiness</dfn>. When a <code id="resource-metadata-management:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object
  is created, it must have its <a href="/breakup/specs/browser-dom/#current-document-readiness" id="resource-metadata-management:current-document-readiness">current document readiness</a> set to the string "<code>loading</code>" if the document is associated with an <a href="#html-parser" id="resource-metadata-management:html-parser">HTML parser</a>, an
  <a href="#xml-parser" id="resource-metadata-management:xml-parser">XML parser</a>, or an XSLT processor, and to the string "<code>complete</code>"
  otherwise. Various algorithms during page loading affect this value. When the value is set, the
  user agent must <a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="resource-metadata-management:fire-a-simple-event">fire a simple event</a> named <code id="resource-metadata-management:event-readystatechange-2"><a href="/breakup/specs/html/#event-readystatechange">readystatechange</a></code> at the <code id="resource-metadata-management:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object.</p>

  <p>A <code id="resource-metadata-management:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is said to have an <dfn id="active-parser">active parser</dfn> if it is associated with an
  <a href="#html-parser" id="resource-metadata-management:html-parser-2">HTML parser</a> or an <a href="#xml-parser" id="resource-metadata-management:xml-parser-2">XML parser</a> that has not yet been <a href="#stop-parsing" id="resource-metadata-management:stop-parsing">stopped</a> or <a href="#abort-a-parser" id="resource-metadata-management:abort-a-parser">aborted</a>.</p>

  <p>The <dfn id="dom-document-readystate"><code>readyState</code></dfn> IDL attribute must, on
  getting, return the <a href="/breakup/specs/browser-dom/#current-document-readiness" id="resource-metadata-management:current-document-readiness-2">current document readiness</a>.</p></section>

  



  <section><h4 id="dom-tree-accessors">3.1.3 <dfn>DOM tree accessors</dfn></h4>

  <p><dfn id="the-html-element-2">The <code>html</code> element</dfn> of a document is the document's root element, if there
  is one and it's an <code id="dom-tree-accessors:the-html-element"><a href="#the-html-element">html</a></code> element, or null otherwise.</p>

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-head"><a href="/breakup/specs/browser-dom/#dom-document-head">head</a></code></dt><dd>
    <p>Returns <a href="/breakup/specs/browser-dom/#the-head-element-2" id="dom-tree-accessors:the-head-element-2">the <code>head</code> element</a>.</p>
   </dd></dl>

  <p><dfn id="the-head-element-2">The <code>head</code> element</dfn> of a document is the first <code id="dom-tree-accessors:the-head-element"><a href="#the-head-element">head</a></code> element
  that is a child of <a href="/breakup/specs/browser-dom/#the-html-element-2" id="dom-tree-accessors:the-html-element-2">the <code>html</code> element</a>, if there is one, or null
  otherwise.</p>

  

  <p>The <dfn id="dom-document-head"><code>head</code></dfn> attribute, on getting, must return
  <a href="/breakup/specs/browser-dom/#the-head-element-2" id="dom-tree-accessors:the-head-element-2-2">the <code>head</code> element</a> of the document (a <code id="dom-tree-accessors:the-head-element-3"><a href="#the-head-element">head</a></code> element or
  null).</p>

  

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-tree-accessors:document.title"><a href="/breakup/specs/browser-dom/#document.title">title</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns the document's title, as given by <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2">the <code>title</code> element</a> for
    HTML and as given by the SVG <code>title</code> element for SVG.</p>

    <p>Can be set, to update the document's title. If there is no appropriate element to update, the
    new value is ignored.</p>

   </dd></dl>

  <p><dfn id="the-title-element-2">The <code>title</code> element</dfn> of a document is the first <code id="dom-tree-accessors:the-title-element"><a href="#the-title-element">title</a></code> element
  in the document (in <a href="/breakup/specs/core-algorithms/#tree-order" id="dom-tree-accessors:tree-order">tree order</a>), if there is one, or null otherwise.</p>

  

  <p>The <dfn id="document.title"><code>title</code></dfn> attribute
  must, on getting, run the following algorithm:</p>

  <ol><li><p>If the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element">root element</a> is an <code id="dom-tree-accessors:svg"><a href="#svg">svg</a></code> element in the <a href="/breakup/specs/core-algorithms/#svg-namespace" id="dom-tree-accessors:svg-namespace">SVG
   namespace</a>, then let <var>value</var> be a concatenation of the data of all the
   child <code id="dom-tree-accessors:text"><a href="/breakup/specs/core-algorithms/#text">Text</a></code> nodes of the first <code>title</code> element in the <a href="/breakup/specs/core-algorithms/#svg-namespace" id="dom-tree-accessors:svg-namespace-2">SVG
   namespace</a> that is a child of the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element-2">root element</a>. <a href="#refsSVG">[SVG]</a></p></li><li><p>Otherwise, let <var>value</var> be a concatenation of the data of all the child
   <code id="dom-tree-accessors:text-2"><a href="/breakup/specs/core-algorithms/#text">Text</a></code> nodes of <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2-2">the <code>title</code> element</a>, in <a href="/breakup/specs/core-algorithms/#tree-order" id="dom-tree-accessors:tree-order-2">tree
   order</a>, or the empty string if <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2-3">the <code>title</code> element</a> is
   null.</p></li><li><p><a href="/breakup/specs/core-algorithms/#strip-and-collapse-whitespace" id="dom-tree-accessors:strip-and-collapse-whitespace">Strip and collapse whitespace</a> in <var>value</var>.</p></li><li><p>Return <var>value</var>.</p></li></ol>

  <p>On setting, the steps corresponding to the first matching condition in the following list must
  be run:</p>

  <dl class="switch"><dt>If the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element-3">root element</a> is an <code id="dom-tree-accessors:svg-2"><a href="#svg">svg</a></code> element in the <a href="/breakup/specs/core-algorithms/#svg-namespace" id="dom-tree-accessors:svg-namespace-3">SVG
   namespace</a> <a href="#refsSVG">[SVG]</a></dt><dd>

    <ol><li><p>Let <var>element</var> be the first <code>title</code> element in
     the <a href="/breakup/specs/core-algorithms/#svg-namespace" id="dom-tree-accessors:svg-namespace-4">SVG namespace</a> that is a child of the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element-4">root element</a>, if any. If
     there isn't one, create a <code>title</code> element in the <a href="/breakup/specs/core-algorithms/#svg-namespace" id="dom-tree-accessors:svg-namespace-5">SVG
     namespace</a>, append it to the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element-5">root element</a>, and let <var>element</var> be that element. <a href="#refsSVG">[SVG]</a></p></li><li><p>Act as if the <code id="dom-tree-accessors:textcontent"><a href="/breakup/specs/core-algorithms/#textcontent">textContent</a></code> IDL attribute of <var>element</var> was
     set to the new value being assigned.</p></li></ol>

   </dd><dt>If the <a href="/breakup/specs/core-algorithms/#root-element" id="dom-tree-accessors:root-element-6">root element</a> is in the <a href="/breakup/specs/core-algorithms/#html-namespace-2" id="dom-tree-accessors:html-namespace-2">HTML namespace</a></dt><dd>

    <ol><li><p>If <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2-4">the <code>title</code> element</a> is null and <a href="/breakup/specs/browser-dom/#the-head-element-2" id="dom-tree-accessors:the-head-element-2-3">the <code>head</code>
     element</a> is null, then abort these steps.</p></li><li><p>If <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2-5">the <code>title</code> element</a> is null, then create a new
     <code id="dom-tree-accessors:the-title-element-3"><a href="#the-title-element">title</a></code> element and <a href="/breakup/specs/core-algorithms/#concept-node-append" id="dom-tree-accessors:concept-node-append">append</a> it to <a href="/breakup/specs/browser-dom/#the-head-element-2" id="dom-tree-accessors:the-head-element-2-4">the
     <code>head</code> element</a>, and let <var>element</var> be the newly created
     element; otherwise, let <var>element</var> be <a href="/breakup/specs/browser-dom/#the-title-element-2" id="dom-tree-accessors:the-title-element-2-6">the <code>title</code>
     element</a>.</p></li><li><p>Act as if the <code id="dom-tree-accessors:textcontent-2"><a href="/breakup/specs/core-algorithms/#textcontent">textContent</a></code> IDL attribute of <var>element</var> was
     set to the new value being assigned.</p></li></ol>

   </dd><dt>Otherwise</dt><dd>

    <p>Do nothing.</p>

   </dd></dl>

  

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-body"><a href="/breakup/specs/browser-dom/#dom-document-body">body</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2">the body element</a>.</p>

    <p>Can be set, to replace <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-2">the body element</a>.</p>

    <p>If the new value is not a <code id="dom-tree-accessors:the-body-element"><a href="#the-body-element">body</a></code> or <code id="dom-tree-accessors:frameset"><a href="#frameset">frameset</a></code> element, this will throw
    a <code id="dom-tree-accessors:hierarchyrequesterror"><a href="/breakup/specs/core-algorithms/#hierarchyrequesterror">HierarchyRequestError</a></code> exception.</p>

   </dd></dl>

  <p><dfn id="the-body-element-2">The body element</dfn> of a document is the first child of <a href="/breakup/specs/browser-dom/#the-html-element-2" id="dom-tree-accessors:the-html-element-2-2">the <code>html</code>
  element</a> that is either a <code id="dom-tree-accessors:the-body-element-3"><a href="#the-body-element">body</a></code> element or a <code id="dom-tree-accessors:frameset-2"><a href="#frameset">frameset</a></code> element. If
  there is no such element, it is null.</p>

  

  <p>The <dfn id="dom-document-body"><code>body</code></dfn> attribute, on getting, must return
  <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-3">the body element</a> of the document (either a <code id="dom-tree-accessors:the-body-element-4"><a href="#the-body-element">body</a></code> element, a
  <code id="dom-tree-accessors:frameset-3"><a href="#frameset">frameset</a></code> element, or null). On setting, the following algorithm must be run:</p>

  <ol><li>If the new value is not a <code id="dom-tree-accessors:the-body-element-5"><a href="#the-body-element">body</a></code> or <code id="dom-tree-accessors:frameset-4"><a href="#frameset">frameset</a></code> element, then throw a
   <code id="dom-tree-accessors:hierarchyrequesterror-2"><a href="/breakup/specs/core-algorithms/#hierarchyrequesterror">HierarchyRequestError</a></code> exception and abort these steps.</li><li>Otherwise, if the new value is the same as <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-4">the body element</a>, do nothing. Abort
   these steps.</li><li>Otherwise, if <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-5">the body element</a> is not null, then replace that element with the
   new value in the DOM, as if the root element's <code>replaceChild()</code> method had
   been called with the new value and <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-6">the incumbent body
   element</a> as its two arguments respectively, then abort these steps.</li><li>Otherwise, if there is no root element, throw a <code id="dom-tree-accessors:hierarchyrequesterror-3"><a href="/breakup/specs/core-algorithms/#hierarchyrequesterror">HierarchyRequestError</a></code> exception
   and abort these steps.</li><li>Otherwise, <a href="/breakup/specs/browser-dom/#the-body-element-2" id="dom-tree-accessors:the-body-element-2-7">the body element</a> is null, but there's a root element. Append
   the new value to the root element.</li></ol>

  

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-images"><a href="/breakup/specs/browser-dom/#dom-document-images">images</a></code></dt><dd>
    <p>Returns an <code id="dom-tree-accessors:htmlcollection"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> of the <code id="dom-tree-accessors:the-img-element"><a href="#the-img-element">img</a></code> elements in the <code id="dom-tree-accessors:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>
   </dd><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-embeds"><a href="/breakup/specs/browser-dom/#dom-document-embeds">embeds</a></code></dt><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-plugins"><a href="/breakup/specs/browser-dom/#dom-document-plugins">plugins</a></code></dt><dd>
    <p>Return an <code id="dom-tree-accessors:htmlcollection-2"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> of the <code id="dom-tree-accessors:the-embed-element"><a href="#the-embed-element">embed</a></code> elements in the <code id="dom-tree-accessors:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>
   </dd><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-links"><a href="/breakup/specs/browser-dom/#dom-document-links">links</a></code></dt><dd>
    <p>Returns an <code id="dom-tree-accessors:htmlcollection-3"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> of the <code id="dom-tree-accessors:the-a-element"><a href="#the-a-element">a</a></code> and <code id="dom-tree-accessors:the-area-element"><a href="#the-area-element">area</a></code> elements
    in the <code id="dom-tree-accessors:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that have <code id="dom-tree-accessors:attr-hyperlink-href"><a href="#attr-hyperlink-href">href</a></code>
    attributes.</p>
   </dd><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-forms"><a href="/breakup/specs/browser-dom/#dom-document-forms">forms</a></code></dt><dd>
    <p>Return an <code id="dom-tree-accessors:htmlcollection-4"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> of the <code id="dom-tree-accessors:the-form-element"><a href="#the-form-element">form</a></code> elements in the <code id="dom-tree-accessors:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>
   </dd><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-scripts"><a href="/breakup/specs/browser-dom/#dom-document-scripts">scripts</a></code></dt><dd>
    <p>Return an <code id="dom-tree-accessors:htmlcollection-5"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> of the <code id="dom-tree-accessors:the-script-element"><a href="#the-script-element">script</a></code> elements in the <code id="dom-tree-accessors:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>
   </dd></dl>

  

  

  <p>The <dfn id="dom-document-images"><code>images</code></dfn> attribute must return an
  <code id="dom-tree-accessors:htmlcollection-6"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node, whose filter matches only
  <code id="dom-tree-accessors:the-img-element-2"><a href="#the-img-element">img</a></code> elements.</p>

  <p>The <dfn id="dom-document-embeds"><code>embeds</code></dfn> attribute must return an
  <code id="dom-tree-accessors:htmlcollection-7"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node, whose filter matches only
  <code id="dom-tree-accessors:the-embed-element-2"><a href="#the-embed-element">embed</a></code> elements.</p>

  <p>The <dfn id="dom-document-plugins"><code>plugins</code></dfn> attribute must return the
  same object as that returned by the <code id="dom-tree-accessors:dom-document-embeds-2"><a href="/breakup/specs/browser-dom/#dom-document-embeds">embeds</a></code>
  attribute.</p>

  <p>The <dfn id="dom-document-links"><code>links</code></dfn> attribute must return an
  <code id="dom-tree-accessors:htmlcollection-8"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node, whose filter matches only
  <code id="dom-tree-accessors:the-a-element-2"><a href="#the-a-element">a</a></code> elements with <code id="dom-tree-accessors:attr-hyperlink-href-2"><a href="#attr-hyperlink-href">href</a></code> attributes and
  <code id="dom-tree-accessors:the-area-element-2"><a href="#the-area-element">area</a></code> elements with <code id="dom-tree-accessors:attr-hyperlink-href-3"><a href="#attr-hyperlink-href">href</a></code> attributes.</p>

  <p>The <dfn id="dom-document-forms"><code>forms</code></dfn> attribute must return an
  <code id="dom-tree-accessors:htmlcollection-9"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node, whose filter matches only
  <code id="dom-tree-accessors:the-form-element-2"><a href="#the-form-element">form</a></code> elements.</p>

  <p>The <dfn id="dom-document-scripts"><code>scripts</code></dfn> attribute must return an
  <code id="dom-tree-accessors:htmlcollection-10"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node, whose filter matches only
  <code id="dom-tree-accessors:the-script-element-2"><a href="#the-script-element">script</a></code> elements.</p>

  <hr>

  

  <dl class="domintro"><dt><var>collection</var> = <var>document</var> . <code id="dom-tree-accessors:dom-document-getelementsbyname"><a href="/breakup/specs/browser-dom/#dom-document-getelementsbyname">getElementsByName</a></code>(<var>name</var>)</dt><dd>

    <p>Returns a <code id="dom-tree-accessors:nodelist"><a href="/breakup/specs/core-algorithms/#nodelist">NodeList</a></code> of elements in the <code id="dom-tree-accessors:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that have a <code>name</code> attribute with the value <var>name</var>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-getelementsbyname"><code>getElementsByName(<var>name</var>)</code></dfn> method takes a string <var>name</var>, and must
  return a <a href="/breakup/specs/core-algorithms/#live" id="dom-tree-accessors:live">live</a> <code id="dom-tree-accessors:nodelist-2"><a href="/breakup/specs/core-algorithms/#nodelist">NodeList</a></code> containing all the <a href="/breakup/specs/core-algorithms/#html-elements" id="dom-tree-accessors:html-elements">HTML elements</a> in
  that document that have a <code>name</code> attribute whose value is equal to the <var>name</var> argument (in a <a href="/breakup/specs/core-algorithms/#case-sensitive" id="dom-tree-accessors:case-sensitive">case-sensitive</a> manner), in <a href="/breakup/specs/core-algorithms/#tree-order" id="dom-tree-accessors:tree-order-3">tree
  order</a>. When the method is invoked on a <code id="dom-tree-accessors:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object again with the same
  argument, the user agent may return the same as the object returned by the earlier call. In other
  cases, a new <code id="dom-tree-accessors:nodelist-3"><a href="/breakup/specs/core-algorithms/#nodelist">NodeList</a></code> object must be returned.</p>

  

  <hr>

  <dl class="domintro"><dt><var>element</var> . <code id="dom-tree-accessors:dom-document-csselementmap"><a href="/breakup/specs/browser-dom/#dom-document-csselementmap">cssElementMap</a></code></dt><dd>

    <p>Returns a <code id="dom-tree-accessors:domelementmap-2"><a href="/breakup/specs/core-algorithms/#domelementmap-2">DOMElementMap</a></code> object for the <code id="dom-tree-accessors:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> representing the
    current <a href="/breakup/specs/core-algorithms/#css-element-reference-identifier" id="dom-tree-accessors:css-element-reference-identifier">CSS element reference
    identifiers</a>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-csselementmap"><code>cssElementMap</code></dfn> IDL attribute
  allows authors to define <a href="/breakup/specs/core-algorithms/#css-element-reference-identifier" id="dom-tree-accessors:css-element-reference-identifier-2">CSS element reference
  identifiers</a>, which are used in certain CSS features to override the normal <a href="/breakup/specs/core-algorithms/#concept-id" id="dom-tree-accessors:concept-id">ID</a>-based mapping. <a href="#refsCSSIMAGES">[CSSIMAGES]</a></p>

  <p>When a <code id="dom-tree-accessors:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, it must be associated with an initially-empty <dfn id="css-id-overrides-list">CSS
  ID overrides list</dfn>, which consists of a list of mappings each of which consists of a string
  name mapped to an <code id="dom-tree-accessors:element"><a href="/breakup/specs/core-algorithms/#element">Element</a></code> node.</p>

  <p>Each entry in the <a href="/breakup/specs/browser-dom/#css-id-overrides-list" id="dom-tree-accessors:css-id-overrides-list">CSS ID overrides list</a>, while it is in the list and is either
  <a href="/breakup/specs/core-algorithms/#in-a-document" id="dom-tree-accessors:in-a-document">in the <code>Document</code></a> or is an <code id="dom-tree-accessors:the-img-element-3"><a href="#the-img-element">img</a></code>,
  <code id="dom-tree-accessors:the-video-element"><a href="#the-video-element">video</a></code>, or <code id="dom-tree-accessors:the-canvas-element"><a href="#the-canvas-element">canvas</a></code> element, defines a <a href="/breakup/specs/core-algorithms/#css-element-reference-identifier" id="dom-tree-accessors:css-element-reference-identifier-3">CSS element reference
  identifier</a> mapping the given name to the given <code id="dom-tree-accessors:element-2"><a href="/breakup/specs/core-algorithms/#element">Element</a></code>. <a href="#refsCSSIMAGES">[CSSIMAGES]</a></p>

  <p>On getting, the <code id="dom-tree-accessors:dom-document-csselementmap-2"><a href="/breakup/specs/browser-dom/#dom-document-csselementmap">cssElementMap</a></code> IDL attribute
  must return a <code id="dom-tree-accessors:domelementmap-2-2"><a href="/breakup/specs/core-algorithms/#domelementmap-2">DOMElementMap</a></code> object, associated with the following algorithms, which
  expose the current mappings:</p>

  <dl><dt>The algorithm for getting the list of name-element mappings</dt><dd>

    <p>Return the <code id="dom-tree-accessors:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#css-id-overrides-list" id="dom-tree-accessors:css-id-overrides-list-2">CSS ID overrides list</a>, maintaining the order
    in which the entries were originally added to the list.</p>

   </dd><dt>The algorithm for mapping a name to a certain element</dt><dd>

    <p>Let <var>name</var> be the name passed to the algorithm and <var>element</var> be the <code id="dom-tree-accessors:element-3"><a href="/breakup/specs/core-algorithms/#element">Element</a></code> passed to the algorithm.</p>

    <p>If <var>element</var> is null, run the algorithm for deleting mappings by name,
    passing it <var>name</var>.</p>

    <p>Otherwise, if there is an entry in the <code id="dom-tree-accessors:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#css-id-overrides-list" id="dom-tree-accessors:css-id-overrides-list-3">CSS ID overrides
    list</a> whose name is <var>name</var>, replace its current value with <var>element</var>.</p>

    <p>Otherwise, add a mapping to the <code id="dom-tree-accessors:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#css-id-overrides-list" id="dom-tree-accessors:css-id-overrides-list-4">CSS ID overrides list</a>
    whose name is <var>name</var> and whose element is <var>element</var>.</p>

   </dd><dt>The algorithm for deleting mappings by name</dt><dd>

    <p>If there is an entry in the <code id="dom-tree-accessors:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#css-id-overrides-list" id="dom-tree-accessors:css-id-overrides-list-5">CSS ID overrides list</a> whose
    name is the name passed to this algorithm, remove it. This also undefines the <a href="/breakup/specs/core-algorithms/#css-element-reference-identifier" id="dom-tree-accessors:css-element-reference-identifier-4">CSS element
    reference identifier</a> for that name. <a href="#refsCSSIMAGES">[CSSIMAGES]</a></p>

   </dd></dl>

  

  <hr>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-tree-accessors:dom-document-currentscript"><a href="/breakup/specs/browser-dom/#dom-document-currentscript">currentScript</a></code></dt><dd>

    <p>Returns the <code id="dom-tree-accessors:the-script-element-3"><a href="#the-script-element">script</a></code> element that is currently executing. In the case of reentrant
    <code id="dom-tree-accessors:the-script-element-4"><a href="#the-script-element">script</a></code> execution, returns the one that most recently started executing amongst
    those that have not yet finished executing.</p>

    <p>Returns null if the <code id="dom-tree-accessors:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is not currently executing a <code id="dom-tree-accessors:the-script-element-5"><a href="#the-script-element">script</a></code>
    element (e.g. because the running script is an event handler, or a timeout).</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-currentscript"><code>currentScript</code></dfn> attribute, on
  getting, must return the value to which it was most recently initialised. When the
  <code id="dom-tree-accessors:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, the <code id="dom-tree-accessors:dom-document-currentscript-2"><a href="/breakup/specs/browser-dom/#dom-document-currentscript">currentScript</a></code> must be initialised to null.</p>

  

  

  <hr>

  <p id="dom-document-namedItem-which">The <code id="dom-tree-accessors:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code> interface <a href="/breakup/specs/core-algorithms/#support-named-properties" id="dom-tree-accessors:support-named-properties">supports named properties</a>. The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="dom-tree-accessors:supported-property-names">supported property names</a> at
  any moment consist of the values of the <code>name</code> content attributes of
  all the
    <code id="dom-tree-accessors:the-applet-element"><a href="#the-applet-element">applet</a></code>,
    <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed">exposed</a> <code id="dom-tree-accessors:the-embed-element-3"><a href="#the-embed-element">embed</a></code>,
    <code id="dom-tree-accessors:the-form-element-3"><a href="#the-form-element">form</a></code>,
    <code id="dom-tree-accessors:the-iframe-element"><a href="#the-iframe-element">iframe</a></code>,
    <code id="dom-tree-accessors:the-img-element-4"><a href="#the-img-element">img</a></code>, and
    <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-2">exposed</a> <code id="dom-tree-accessors:the-object-element"><a href="#the-object-element">object</a></code>
  elements in the <code id="dom-tree-accessors:document-22"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that have non-empty <code>name</code> content
  attributes, and the values of the <code id="dom-tree-accessors:the-id-attribute"><a href="#the-id-attribute">id</a></code> content attributes of all the
    <code id="dom-tree-accessors:the-applet-element-2"><a href="#the-applet-element">applet</a></code> and
    <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-3">exposed</a> <code id="dom-tree-accessors:the-object-element-2"><a href="#the-object-element">object</a></code>
  elements in the <code id="dom-tree-accessors:document-23"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that have non-empty <code id="dom-tree-accessors:the-id-attribute-2"><a href="#the-id-attribute">id</a></code> content
  attributes, and the values of the <code id="dom-tree-accessors:the-id-attribute-3"><a href="#the-id-attribute">id</a></code> content attributes of all the
    <code id="dom-tree-accessors:the-img-element-5"><a href="#the-img-element">img</a></code>
  elements in the <code id="dom-tree-accessors:document-24"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that have both non-empty <code>name</code> content
  attributes and non-empty <code id="dom-tree-accessors:the-id-attribute-4"><a href="#the-id-attribute">id</a></code> content attributes. The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="dom-tree-accessors:supported-property-names-2">supported
  property names</a> must be in <a href="/breakup/specs/core-algorithms/#tree-order" id="dom-tree-accessors:tree-order-4">tree order</a>, ignoring later duplicates, with values
  from <code id="dom-tree-accessors:the-id-attribute-5"><a href="#the-id-attribute">id</a></code> attributes coming before values from <code>name</code> attributes when the same element contributes both.</p>

  <p>To <a href="/breakup/specs/core-algorithms/#determine-the-value-of-a-named-property" id="dom-tree-accessors:determine-the-value-of-a-named-property">determine the value of a named property</a> <var>name</var> when <dfn id="dom-document-nameditem">the <code>Document</code> object is indexed for property
  retrieval</dfn>, the user agent must return the value obtained using the following steps:</p>

  <ol><li>

    <p>Let <var>elements</var> be the list of <a href="/breakup/specs/browser-dom/#dom-document-nameditem-filter" id="dom-tree-accessors:dom-document-nameditem-filter">named elements</a> with the name <var>name</var> in the <code id="dom-tree-accessors:document-25"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.

    </p><p class="note">There will be at least one such element, by definition.</p>

   </li><li>

    <p>If <var>elements</var> has only one element, and that element is an
    <code id="dom-tree-accessors:the-iframe-element-2"><a href="#the-iframe-element">iframe</a></code> element, then return the <code id="dom-tree-accessors:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="dom-tree-accessors:nested-browsing-context">nested
    browsing context</a> represented by that <code id="dom-tree-accessors:the-iframe-element-3"><a href="#the-iframe-element">iframe</a></code> element, and abort these
    steps.</p>

   </li><li>

    <p>Otherwise, if <var>elements</var> has only one element, return that element and
    abort these steps.</p>

   </li><li>

    <p>Otherwise return an <code id="dom-tree-accessors:htmlcollection-11"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="dom-tree-accessors:document-26"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node,
    whose filter matches only <a href="/breakup/specs/browser-dom/#dom-document-nameditem-filter" id="dom-tree-accessors:dom-document-nameditem-filter-2">named elements</a> with
    the name <var>name</var>.</p> 

   </li></ol>

  <p><dfn id="dom-document-nameditem-filter">Named elements</dfn> with the name <var>name</var>, for the purposes of the above algorithm, are those that are either:</p>

  <ul><li><code id="dom-tree-accessors:the-applet-element-3"><a href="#the-applet-element">applet</a></code>, <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-4">exposed</a> <code id="dom-tree-accessors:the-embed-element-4"><a href="#the-embed-element">embed</a></code>, <code id="dom-tree-accessors:the-form-element-4"><a href="#the-form-element">form</a></code>,
   <code id="dom-tree-accessors:the-iframe-element-4"><a href="#the-iframe-element">iframe</a></code>, <code id="dom-tree-accessors:the-img-element-6"><a href="#the-img-element">img</a></code>, or <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-5">exposed</a> <code id="dom-tree-accessors:the-object-element-3"><a href="#the-object-element">object</a></code> elements that
   have a <code>name</code> content attribute whose value is <var>name</var>, or</li><li><code id="dom-tree-accessors:the-applet-element-4"><a href="#the-applet-element">applet</a></code> or <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-6">exposed</a> <code id="dom-tree-accessors:the-object-element-4"><a href="#the-object-element">object</a></code> elements that have an <code id="dom-tree-accessors:the-id-attribute-6"><a href="#the-id-attribute">id</a></code> content attribute whose value is <var>name</var>, or</li><li><code id="dom-tree-accessors:the-img-element-7"><a href="#the-img-element">img</a></code> elements that have an <code id="dom-tree-accessors:the-id-attribute-7"><a href="#the-id-attribute">id</a></code> content attribute
   whose value is <var>name</var>, and that have a non-empty <code>name</code>
   content attribute present also.</li></ul>

  <p>An <code id="dom-tree-accessors:the-embed-element-5"><a href="#the-embed-element">embed</a></code> or <code id="dom-tree-accessors:the-object-element-5"><a href="#the-object-element">object</a></code> element is said to be <dfn id="exposed">exposed</dfn> if it has
  no <a href="/breakup/specs/browser-dom/#exposed" id="dom-tree-accessors:exposed-7">exposed</a> <code id="dom-tree-accessors:the-object-element-6"><a href="#the-object-element">object</a></code> ancestor, and, for <code id="dom-tree-accessors:the-object-element-7"><a href="#the-object-element">object</a></code> elements, is
  additionally either not showing its <a href="#fallback-content" id="dom-tree-accessors:fallback-content">fallback content</a> or has no <code id="dom-tree-accessors:the-object-element-8"><a href="#the-object-element">object</a></code> or
  <code id="dom-tree-accessors:the-embed-element-6"><a href="#the-embed-element">embed</a></code> descendants.</p>

  

  <hr>

  <p class="note">The <code id="dom-tree-accessors:dom-document-dir"><a href="#dom-document-dir">dir</a></code> attribute on the
  <code id="dom-tree-accessors:document-27"><a href="/breakup/specs/browser-dom/#document">Document</a></code> interface is defined along with the <code id="dom-tree-accessors:the-dir-attribute"><a href="#the-dir-attribute">dir</a></code>
  content attribute.</p></section>



   

  <section><h4 id="loading-xml-documents">3.1.4 Loading XML documents</h4>

  <pre class="idl">partial interface <a href="/breakup/specs/core-algorithms/#xmldocument" id="loading-xml-documents:xmldocument">XMLDocument</a> {
  boolean <a href="/breakup/specs/browser-dom/#dom-xmldocument-load" id="loading-xml-documents:dom-xmldocument-load">load</a>(DOMString url);
};</pre>

  
  
  

  <p>The <dfn id="dom-xmldocument-load"><code>load(<var>url</var>)</code></dfn> method
  must run the following steps:</p>

  <ol><li><p>Let <var>document</var> be the <code id="loading-xml-documents:xmldocument-2"><a href="/breakup/specs/core-algorithms/#xmldocument">XMLDocument</a></code> object on which the
   method was invoked.</p></li><li><p><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="loading-xml-documents:resolve-a-url">Resolve</a> the method's first argument, relative to the
   <a href="/breakup/specs/browser-dom/#api-base-url" id="loading-xml-documents:api-base-url">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="loading-xml-documents:entry-settings-object">entry settings object</a>. If this is not
   successful, throw a <code id="loading-xml-documents:syntaxerror"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception and abort these steps. Otherwise, let <var>url</var> be the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="loading-xml-documents:absolute-url">absolute URL</a>.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="loading-xml-documents:origin-2">origin</a> of <var>url</var> is not the same as the
   <a href="/breakup/specs/browser-dom/#origin-2" id="loading-xml-documents:origin-2-2">origin</a> of <var>document</var>, throw a <code id="loading-xml-documents:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception
   and abort these steps.</p></li><li><p>Remove all child nodes of <var>document</var>, without firing any mutation
   events.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#current-document-readiness" id="loading-xml-documents:current-document-readiness">current document readiness</a> of <var>document</var> to "<code>loading</code>".</p></li><li><p>Run the remainder of these steps <a href="/breakup/specs/core-algorithms/#in-parallel" id="loading-xml-documents:in-parallel">in parallel</a>, and return true from the
   method.</p></li><li><p>Let <var>result</var> be a <code id="loading-xml-documents:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object.</p></li><li><p>Let <var>success</var> be false.</p></li><li><p><a href="/breakup/specs/core-algorithms/#fetch" id="loading-xml-documents:fetch">Fetch</a> <var>url</var> from the <a href="/breakup/specs/browser-dom/#origin-2" id="loading-xml-documents:origin-2-3">origin</a> of
   <var>document</var>, using the <a href="/breakup/specs/browser-dom/#referrer-source" id="loading-xml-documents:referrer-source">referrer source</a> specified by the
   <a href="/breakup/specs/browser-dom/#entry-settings-object" id="loading-xml-documents:entry-settings-object-2">entry settings object</a>, with the <i>blocking flag</i> set and the <i>force same-origin flag</i> set.</p></li><li>

    <p>If the fetch attempt was successful, and the resource's <a href="/breakup/specs/core-algorithms/#content-type" id="loading-xml-documents:content-type">Content-Type metadata</a> is an <a href="/breakup/specs/core-algorithms/#xml-mime-type" id="loading-xml-documents:xml-mime-type">XML MIME type</a>, then run
    these substeps:</p>

    <ol><li><p>Create a new <a href="#xml-parser" id="loading-xml-documents:xml-parser">XML parser</a> associated with the <var>result</var>
     document.</p></li><li><p>Pass this parser the fetched document.</p></li><li><p>If there is an XML well-formedness or XML namespace well-formedness error, then remove
     all child nodes from <var>result</var>. Otherwise let <var>success</var> be
     true.</p></li></ol>

   </li><li>

    <p><a href="/breakup/specs/browser-dom/#queue-a-task" id="loading-xml-documents:queue-a-task">Queue a task</a> to run the following steps.</p>

    <ol><li><p>Set the <a href="/breakup/specs/browser-dom/#current-document-readiness" id="loading-xml-documents:current-document-readiness-2">current document readiness</a> of <var>document</var> to
     "<code>complete</code>".</p></li><li><p>Replace all the children of <var>document</var> by the children of <var>result</var> (even if it has no children), firing mutation events as if a
     <code id="loading-xml-documents:documentfragment"><a href="/breakup/specs/core-algorithms/#documentfragment">DocumentFragment</a></code> containing the new children had been inserted.</p></li><li><p><a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="loading-xml-documents:fire-a-simple-event">Fire a simple event</a> named <code id="loading-xml-documents:event-load"><a href="/breakup/specs/html/#event-load">load</a></code> at <var>document</var>.</p></li></ol>

   </li></ol></section></section><section><h3 id="windows">6.1 Browsing contexts</h3>

  <p>A <dfn id="browsing-context">browsing context</dfn> is an environment in which <code id="windows:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects are
  presented to the user.</p>

  <p class="note">A tab or window in a Web browser typically contains a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context">browsing
  context</a>, as does an <code id="windows:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> or <code id="windows:frame"><a href="#frame">frame</a></code>s in a
  <code id="windows:frameset"><a href="#frameset">frameset</a></code>.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-2">browsing context</a> has a corresponding <code id="windows:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object.</p>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-3">browsing context</a> has a <a href="/breakup/specs/browser-dom/#session-history" id="windows:session-history">session history</a>, which lists the
  <code id="windows:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects that that <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-4">browsing context</a> has presented, is
  presenting, or will present. At any time, one <code id="windows:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in each <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-5">browsing
  context</a> is designated the <dfn id="active-document">active document</dfn>. A <code id="windows:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-6">browsing context</a> is that <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-7">browsing context</a> whose <a href="/breakup/specs/browser-dom/#session-history" id="windows:session-history-2">session
  history</a> contains the <code id="windows:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, if any. (A <code id="windows:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> created using
  an API such as <code id="windows:dom-domimplementation-createdocument"><a href="/breakup/specs/core-algorithms/#dom-domimplementation-createdocument">createDocument()</a></code> has no
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-8">browsing context</a>.)</p>

  <p>Each <code id="windows:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-9">browsing context</a> is <dfn id="concept-document-window">associated</dfn> with a <code id="windows:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object. A
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-10">browsing context</a>'s <code id="windows:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object forwards everything to the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-11">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="windows:active-document">active document</a>'s <code id="windows:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object.</p>

  <p class="note">In general, there is a 1-to-1 mapping from the <code id="windows:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object to the
  <code id="windows:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object. There are two exceptions. First, a <code id="windows:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> can be reused
  for the presentation of a second <code id="windows:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in the same <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-12">browsing context</a>,
  such that the mapping is then 1-to-2. This occurs when a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-13">browsing context</a> is <a href="#navigate" id="windows:navigate">navigated</a> from the initial <code id="windows:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
  to another, with <a href="#replacement-enabled" id="windows:replacement-enabled">replacement enabled</a>. Second, a <code id="windows:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> can end up
  being reused for several <code id="windows:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects when the <code id="windows:dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> method is used, such that the mapping is then
  many-to-1.</p>

  <p class="note">A <code id="windows:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> does not necessarily have a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-14">browsing context</a>
  associated with it. In particular, data mining tools are likely to never instantiate browsing
  contexts.</p>

  <hr>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-15">browsing context</a> can have a <dfn id="creator-browsing-context">creator browsing context</dfn>, the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-16">browsing context</a> that was responsible for its creation. If a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-17">browsing
  context</a> has a <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="windows:parent-browsing-context">parent browsing context</a>, then that is its <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context">creator browsing
  context</a>. Otherwise, if the <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-18">browsing context</a> has an <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="windows:opener-browsing-context">opener browsing
  context</a>, then <em>that</em> is its <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context-2">creator browsing context</a>. Otherwise, the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-19">browsing context</a> has no <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context-3">creator browsing context</a>.</p>

  <p>If a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-20">browsing context</a> <var>A</var> has a <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context-4">creator browsing
  context</a>, then the <code id="windows:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that was the <a href="/breakup/specs/browser-dom/#active-document" id="windows:active-document-2">active document</a> of that
  <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context-5">creator browsing context</a> at the time <var>A</var> was created is the
  <dfn id="creator-document">creator <code>Document</code></dfn>.</p>

  

  <p><dfn id="creating-a-new-browsing-context">Creating a browsing context</dfn>: When a <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-21">browsing context</a> is first created, it must be created with a single
  <code id="windows:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in its session history, whose <a href="https://dom.spec.whatwg.org/#concept-document-url" id="windows:the-document's-address" data-x-internal="the-document's-address">address</a> is <code id="windows:about:blank-2"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>, which is marked as being an <a href="/breakup/specs/core-algorithms/#html-documents" id="windows:html-documents">HTML document</a>, whose <a href="/breakup/specs/core-algorithms/#document's-character-encoding" id="windows:document's-character-encoding">character encoding</a> is UTF-8, and which is both <a href="#ready-for-post-load-tasks" id="windows:ready-for-post-load-tasks">ready for post-load
  tasks</a> and <a href="#completely-loaded" id="windows:completely-loaded">completely loaded</a> immediately, along with a new <code id="windows:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  object that the <code id="windows:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is associated with. The <code id="windows:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code> must have a
  single child <code id="windows:the-html-element"><a href="#the-html-element">html</a></code> node, which itself has two empty child nodes: a <code id="windows:the-head-element"><a href="#the-head-element">head</a></code>
  element, and a <code id="windows:the-body-element"><a href="#the-body-element">body</a></code> element. As soon as this <code id="windows:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, the
  user agent must <a href="/breakup/specs/browser-dom/#implement-the-sandboxing" id="windows:implement-the-sandboxing">implement the sandboxing</a> for it. If the <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-22">browsing context</a>
  has a <a href="/breakup/specs/browser-dom/#creator-document" id="windows:creator-document">creator <code>Document</code></a>, then the <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-23">browsing context</a>'s
  <code id="windows:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#the-document's-referrer" id="windows:the-document's-referrer">referrer</a> must be set to
  <a href="https://dom.spec.whatwg.org/#concept-document-url" id="windows:the-document's-address-2" data-x-internal="the-document's-address">the address</a> of that <a href="/breakup/specs/browser-dom/#creator-document" id="windows:creator-document-2">creator
  <code>Document</code></a> at the time of the <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-24">browsing context</a>'s creation.</p>

  <p class="note">If the <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-25">browsing context</a> is created specifically to be immediately
  navigated, then that initial navigation will have <a href="#replacement-enabled" id="windows:replacement-enabled-2">replacement enabled</a>.</p>

  <p id="about-blank-origin">The <a href="/breakup/specs/browser-dom/#origin-2" id="windows:origin-2">origin</a> and <a href="/breakup/specs/browser-dom/#effective-script-origin" id="windows:effective-script-origin">effective script origin</a> of the
  <code id="windows:about:blank-3"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> are set when the <code id="windows:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created.
  If the new <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-26">browsing context</a> has a <a href="/breakup/specs/browser-dom/#creator-browsing-context" id="windows:creator-browsing-context-6">creator browsing context</a>, then the
  <a href="/breakup/specs/browser-dom/#origin-2" id="windows:origin-2-2">origin</a> of the <code id="windows:about:blank-4"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="windows:concept-origin-alias">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="windows:origin-2-3">origin</a> of the <a href="/breakup/specs/browser-dom/#creator-document" id="windows:creator-document-3">creator
  <code>Document</code></a> and the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="windows:effective-script-origin-2">effective script origin</a> of the
  <code id="windows:about:blank-5"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-22"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="windows:concept-origin-alias-2">alias</a> to the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="windows:effective-script-origin-3">effective script origin</a> of the
  <a href="/breakup/specs/browser-dom/#creator-document" id="windows:creator-document-4">creator <code>Document</code></a>. Otherwise, the <a href="/breakup/specs/browser-dom/#origin-2" id="windows:origin-2-4">origin</a> of the
  <code id="windows:about:blank-6"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-23"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is a globally unique identifier assigned when the
  new <a href="/breakup/specs/browser-dom/#browsing-context" id="windows:browsing-context-27">browsing context</a> is created and the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="windows:effective-script-origin-4">effective script origin</a> of the
  <code id="windows:about:blank-7"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="windows:document-24"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="windows:concept-origin-alias-3">alias</a> to its <a href="/breakup/specs/browser-dom/#origin-2" id="windows:origin-2-5">origin</a>.</p>

  


  <section><h4 id="nested-browsing-contexts">6.1.1 Nested browsing contexts</h4>

  <p>Certain elements (for example, <code id="nested-browsing-contexts:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> elements) can instantiate further <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context">browsing contexts</a>. These are called <dfn id="nested-browsing-context">nested browsing contexts</dfn>. If a browsing context <var>P</var> has a
  <code id="nested-browsing-contexts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>D</var> with an element <var>E</var> that nests
  another browsing context <var>C</var> inside it, then <var>C</var> is said to be
  <dfn id="browsing-context-nested-through">nested through</dfn> <var>D</var>, and <var>E</var> is said to be the <dfn id="browsing-context-container">browsing context container</dfn> of <var>C</var>.
  If the <a href="/breakup/specs/browser-dom/#browsing-context-container" id="nested-browsing-contexts:browsing-context-container">browsing context container</a> element <var>E</var> is <a href="/breakup/specs/core-algorithms/#in-a-document" id="nested-browsing-contexts:in-a-document">in</a> the <code id="nested-browsing-contexts:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>D</var>, then <var>P</var> is
  said to be the <dfn id="parent-browsing-context">parent browsing context</dfn> of <var>C</var> and <var>C</var> is said to be a <dfn id="child-browsing-context">child browsing context</dfn> of <var>P</var>.
  Otherwise, the <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context">nested browsing context</a> <var>C</var> has no <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context">parent
  browsing context</a>.</p>

  <p>A browsing context <var>A</var> is said to be an <dfn id="ancestor-browsing-context">ancestor</dfn> of a browsing context <var>B</var> if there exists a browsing
  context <var>A'</var> that is a <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context">child browsing context</a> of <var>A</var> and that is itself an <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context">ancestor</a> of
  <var>B</var>, or if the browsing context <var>A</var> is the
  <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-2">parent browsing context</a> of <var>B</var>.</p>

  <p>A browsing context that is not a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-2">nested browsing context</a> has no <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-3">parent
  browsing context</a>, and is the <dfn id="top-level-browsing-context">top-level browsing context</dfn> of all the browsing
  contexts for which it is an <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context-2">ancestor browsing context</a>.</p>

  <p>The transitive closure of <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-4">parent browsing contexts</a>
  for a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-3">nested browsing context</a> gives the list of <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context-3">ancestor browsing contexts</a>.</p>

  <p>The <dfn id="list-of-the-descendant-browsing-contexts">list of the descendant browsing contexts</dfn> of a <code id="nested-browsing-contexts:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>d</var> is the (ordered) list returned by the following algorithm:</p>

  <ol><li><p>Let <var>list</var> be an empty list.</p></li><li>

    <p>For each <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-2">child browsing context</a> of <var>d</var> that is <a href="/breakup/specs/browser-dom/#browsing-context-nested-through" id="nested-browsing-contexts:browsing-context-nested-through">nested through</a> an element that is <a href="/breakup/specs/core-algorithms/#in-a-document" id="nested-browsing-contexts:in-a-document-2">in the <code>Document</code></a> <var>d</var>, in the <a href="/breakup/specs/core-algorithms/#tree-order" id="nested-browsing-contexts:tree-order">tree
    order</a> of the elements nesting those <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context-2">browsing
    contexts</a>, run these substeps:</p>

    <ol><li><p>Append that <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-3">child browsing context</a> to the list <var>list</var>.</p>

     </li><li><p>Append the <a href="/breakup/specs/browser-dom/#list-of-the-descendant-browsing-contexts" id="nested-browsing-contexts:list-of-the-descendant-browsing-contexts">list of the descendant browsing contexts</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="nested-browsing-contexts:active-document">active
     document</a> of that <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-4">child browsing context</a> to the list <var>list</var>.</p></li></ol>

   </li><li><p>Return the constructed <var>list</var>.</p></li></ol>

  <p>A <code id="nested-browsing-contexts:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is said to be <dfn id="fully-active">fully active</dfn> when it is the <a href="/breakup/specs/browser-dom/#active-document" id="nested-browsing-contexts:active-document-2">active
  document</a> of its <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context-3">browsing context</a>, and either its browsing context is a
  <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="nested-browsing-contexts:top-level-browsing-context">top-level browsing context</a>, or it has a <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-5">parent browsing context</a> and the
  <code id="nested-browsing-contexts:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <a href="/breakup/specs/browser-dom/#browsing-context-nested-through" id="nested-browsing-contexts:browsing-context-nested-through-2">through which</a> it is
  <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-4">nested</a> is itself <a href="/breakup/specs/browser-dom/#fully-active" id="nested-browsing-contexts:fully-active">fully active</a>.</p>

  <p>Because they are nested through an element, <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-5">child browsing
  contexts</a> are always tied to a specific <code id="nested-browsing-contexts:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in their <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-6">parent browsing
  context</a>. User agents must not allow the user to interact with <a href="/breakup/specs/browser-dom/#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-6">child browsing contexts</a> of elements that are in <code id="nested-browsing-contexts:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s that are
  not themselves <a href="/breakup/specs/browser-dom/#fully-active" id="nested-browsing-contexts:fully-active-2">fully active</a>.</p>

  <p>A <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-5">nested browsing context</a> can have a <a href="#seamless-browsing-context-flag" id="nested-browsing-contexts:seamless-browsing-context-flag">seamless browsing context flag</a>
  set, if it is embedded through an <code id="nested-browsing-contexts:the-iframe-element-2"><a href="#the-iframe-element">iframe</a></code> element with a <code id="nested-browsing-contexts:attr-iframe-seamless"><a href="#attr-iframe-seamless">seamless</a></code> attribute.</p>

  <p>A <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-6">nested browsing context</a> can be put into a <dfn id="delaying-load-events-mode">delaying <code>load</code> events mode</dfn>. This is used when it is <a href="#navigate" id="nested-browsing-contexts:navigate">navigated</a>, to <a href="#delay-the-load-event" id="nested-browsing-contexts:delay-the-load-event">delay the load event</a> of the <a href="/breakup/specs/browser-dom/#browsing-context-container" id="nested-browsing-contexts:browsing-context-container-2">browsing
  context container</a> before the new <code id="nested-browsing-contexts:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created.</p>



  <p>The <dfn id="document-family">document family</dfn> of a <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context-4">browsing context</a> consists of the union of all
  the <code id="nested-browsing-contexts:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects in that <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context-5">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="nested-browsing-contexts:session-history">session
  history</a> and the <a href="/breakup/specs/browser-dom/#document-family" id="nested-browsing-contexts:document-family">document families</a> of all those
  <code id="nested-browsing-contexts:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects. The <a href="/breakup/specs/browser-dom/#document-family" id="nested-browsing-contexts:document-family-2">document family</a> of a <code id="nested-browsing-contexts:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object
  consists of the union of all the <a href="/breakup/specs/browser-dom/#document-family" id="nested-browsing-contexts:document-family-3">document families</a> of the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="nested-browsing-contexts:browsing-context-6">browsing contexts</a> that are <a href="/breakup/specs/browser-dom/#browsing-context-nested-through" id="nested-browsing-contexts:browsing-context-nested-through-3">nested through</a> the <code id="nested-browsing-contexts:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object.</p>


  <section><h5 id="navigating-nested-browsing-contexts-in-the-dom">6.1.1.1 Navigating nested browsing contexts in the DOM</h5>

  <dl class="domintro"><dt><var>window</var> . <code id="navigating-nested-browsing-contexts-in-the-dom:dom-top"><a href="/breakup/specs/browser-dom/#dom-top">top</a></code></dt><dd>

    <p>Returns the <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> for the <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context">top-level browsing context</a>.</p>

   </dd><dt><var>window</var> . <code id="navigating-nested-browsing-contexts-in-the-dom:dom-parent"><a href="/breakup/specs/browser-dom/#dom-parent">parent</a></code></dt><dd>

    <p>Returns the <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> for the <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:parent-browsing-context">parent browsing context</a>.</p>

   </dd><dt><var>window</var> . <code id="navigating-nested-browsing-contexts-in-the-dom:dom-frameelement"><a href="/breakup/specs/browser-dom/#dom-frameelement">frameElement</a></code></dt><dd>

    <p>Returns the <code id="navigating-nested-browsing-contexts-in-the-dom:element"><a href="/breakup/specs/core-algorithms/#element">Element</a></code> for the <a href="/breakup/specs/browser-dom/#browsing-context-container" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-container">browsing context container</a>.</p>

    <p>Returns null if there isn't one.</p>

    <p>Throws a <code id="navigating-nested-browsing-contexts-in-the-dom:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception in cross-origin situations.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-top"><code>top</code></dfn> IDL attribute on the <code id="navigating-nested-browsing-contexts-in-the-dom:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object
  of a <code id="navigating-nested-browsing-contexts-in-the-dom:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context">browsing context</a> <var>b</var> must return
  the <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-3"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of its <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-2">top-level browsing context</a> (which would be
  its own <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-4"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object if it was a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-3">top-level browsing context</a>
  itself), if it has one, or its own <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-5"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object otherwise (e.g. if it was a
  detached <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:nested-browsing-context">nested browsing context</a>).</p>

  <p>The <dfn id="dom-parent"><code>parent</code></dfn> IDL attribute on the <code id="navigating-nested-browsing-contexts-in-the-dom:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  object of a <code id="navigating-nested-browsing-contexts-in-the-dom:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-2">browsing context</a> <var>b</var> must
  return the <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-6"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:parent-browsing-context-2">parent browsing context</a>, if there
  is one (i.e. if <var>b</var> is a <a href="/breakup/specs/browser-dom/#child-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:child-browsing-context">child browsing context</a>), or the
  <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-7"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-3">browsing context</a> <var>b</var> itself,
  otherwise (i.e. if it is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-4">top-level browsing context</a> or a detached <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:nested-browsing-context-2">nested
  browsing context</a>).</p>

  <p>The <dfn id="dom-frameelement"><code>frameElement</code></dfn> IDL attribute on the
  <code id="navigating-nested-browsing-contexts-in-the-dom:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of a <code id="navigating-nested-browsing-contexts-in-the-dom:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>d</var>, on getting, must run
  the following algorithm:</p>

  <ol><li><p>If <var>d</var> is not a <code id="navigating-nested-browsing-contexts-in-the-dom:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:nested-browsing-context-3">nested browsing
   context</a>, return null and abort these steps.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#browsing-context-container" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-container-2">browsing context container</a>'s <a id="navigating-nested-browsing-contexts-in-the-dom:node-document" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a> does not have the
   <a href="/breakup/specs/browser-dom/#same-origin" id="navigating-nested-browsing-contexts-in-the-dom:same-origin">same</a> <a href="/breakup/specs/browser-dom/#effective-script-origin" id="navigating-nested-browsing-contexts-in-the-dom:effective-script-origin">effective script origin</a> as the
   <a href="/breakup/specs/browser-dom/#effective-script-origin" id="navigating-nested-browsing-contexts-in-the-dom:effective-script-origin-2">effective script origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="navigating-nested-browsing-contexts-in-the-dom:entry-settings-object">entry settings object</a>, then
   throw a <code id="navigating-nested-browsing-contexts-in-the-dom:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p></li><li><p>Return the <a href="/breakup/specs/browser-dom/#browsing-context-container" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-container-3">browsing context container</a> for <var>b</var>.</p></li></ol></section></section>

  



  <section><h4 id="auxiliary-browsing-contexts">6.1.2 Auxiliary browsing contexts</h4>

  <p>It is possible to create new browsing contexts that are related to a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="auxiliary-browsing-contexts:top-level-browsing-context">top-level browsing
  context</a> without being nested through an element. Such browsing contexts are called <dfn id="auxiliary-browsing-context">auxiliary browsing contexts</dfn>. Auxiliary browsing contexts
  are always <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="auxiliary-browsing-contexts:top-level-browsing-context-2">top-level browsing contexts</a>.</p>

  <p>An <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="auxiliary-browsing-contexts:auxiliary-browsing-context">auxiliary browsing context</a> has an <dfn id="opener-browsing-context">opener browsing context</dfn>, which is
  the <a href="/breakup/specs/browser-dom/#browsing-context" id="auxiliary-browsing-contexts:browsing-context">browsing context</a> from which the <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="auxiliary-browsing-contexts:auxiliary-browsing-context-2">auxiliary browsing context</a> was
  created.</p>


  <section><h5 id="navigating-auxiliary-browsing-contexts-in-the-dom">6.1.2.1 Navigating auxiliary browsing contexts in the DOM</h5>

  <p>The <dfn id="dom-opener"><code>opener</code></dfn> IDL attribute on the <code id="navigating-auxiliary-browsing-contexts-in-the-dom:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  object, on getting, must return the <code id="navigating-auxiliary-browsing-contexts-in-the-dom:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context">browsing
  context</a> from which the current <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-2">browsing context</a> was created (its <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="navigating-auxiliary-browsing-contexts-in-the-dom:opener-browsing-context">opener
  browsing context</a>), if there is one, if it is still available, and if the current
  <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-3">browsing context</a> has not <i id="navigating-auxiliary-browsing-contexts-in-the-dom:disowned-its-opener"><a href="/breakup/specs/browser-dom/#disowned-its-opener">disowned its opener</a></i>;
  otherwise, it must return null. On setting, if the new value is null then the current
  <a href="/breakup/specs/browser-dom/#browsing-context" id="navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-4">browsing context</a> must <dfn id="disowned-its-opener">disown its opener</dfn>; if
  the new value is anything else then the user agent must

    
    call the [[DefineOwnProperty]] internal method of the <code id="navigating-auxiliary-browsing-contexts-in-the-dom:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, passing the
    property name "<code>opener</code>" as the property key, and the Property Descriptor {
    [[Value]]: <var>value</var>, [[Writable]]: true, [[Enumerable]]: true,
    [[Configurable]]: true } as the property descriptor,
    

  where <var>value</var> is the new value.</p></section></section>



  <section><h4 id="secondary-browsing-contexts">6.1.3 Secondary browsing contexts</h4>

  <p>User agents may support <dfn id="secondary-browsing-context">secondary browsing
  contexts</dfn>, which are <a href="/breakup/specs/browser-dom/#browsing-context" id="secondary-browsing-contexts:browsing-context">browsing contexts</a> that form part
  of the user agent's interface, apart from the main content area.</p>

  </section>



  

  <section><h4 id="security-nav">6.1.4 Security</h4>

  <p id="security-1">A <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context">browsing context</a> <var>A</var> is <dfn id="familiar-with">familiar
  with</dfn> a second <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context-2">browsing context</a> <var>B</var> if one of the following
  conditions is true:</p>

  <ul><li>Either the <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2">origin</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document">active document</a> of <var>A</var>
   is the <a href="/breakup/specs/browser-dom/#same-origin" id="security-nav:same-origin">same</a> as the <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2-2">origin</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document-2">active
   document</a> of <var>B</var>, or</li><li>The browsing context <var>A</var> is a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="security-nav:nested-browsing-context">nested browsing context</a> with a
   <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context">top-level browsing context</a>, and its <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-2">top-level browsing context</a> is <var>B</var>, or</li><li>The browsing context <var>B</var> is an <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="security-nav:auxiliary-browsing-context">auxiliary browsing context</a> and
   <var>A</var> is <a href="/breakup/specs/browser-dom/#familiar-with" id="security-nav:familiar-with">familiar with</a> <var>B</var>'s <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="security-nav:opener-browsing-context">opener
   browsing context</a>, or</li><li>The browsing context <var>B</var> is not a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-3">top-level browsing context</a>,
   but there exists an <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="security-nav:ancestor-browsing-context">ancestor browsing context</a> of <var>B</var> whose
   <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document-3">active document</a> has the <a href="/breakup/specs/browser-dom/#same-origin" id="security-nav:same-origin-2">same</a> <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2-3">origin</a> as
   the <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document-4">active document</a> of <var>A</var> (possibly in fact being <var>A</var> itself).</li></ul>

  <hr>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context-3">browsing context</a> <var>A</var> is <dfn id="allowed-to-navigate">allowed to navigate</dfn> a
  second <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context-4">browsing context</a> <var>B</var> if the following algorithm terminates
  positively:</p>

  <ol><li><p>If <var>A</var> is not the same <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context-5">browsing context</a> as <var>B</var>, and <var>A</var> is not one of the <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-2">ancestor browsing contexts</a> of <var>B</var>, and <var>B</var>
   is not a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-4">top-level browsing context</a>, and <var>A</var>'s <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document-5">active
   document</a>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="security-nav:active-sandboxing-flag-set">active sandboxing flag set</a> has its <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="security-nav:sandboxed-navigation-browsing-context-flag">sandboxed navigation
   browsing context flag</a> set, then abort these steps negatively.</p></li><li><p>Otherwise, if <var>B</var> is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-5">top-level browsing context</a>, and is
   one of the <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-3">ancestor browsing contexts</a> of <var>A</var>, and <var>A</var>'s <a id="security-nav:node-document" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="security-nav:active-sandboxing-flag-set-2">active sandboxing
   flag set</a> has its <a href="/breakup/specs/browser-dom/#sandboxed-top-level-navigation-browsing-context-flag" id="security-nav:sandboxed-top-level-navigation-browsing-context-flag">sandboxed top-level navigation browsing context flag</a> set,
   then abort these steps negatively.</p></li><li><p>Otherwise, if <var>B</var> is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-6">top-level browsing context</a>, and is
   neither <var>A</var> nor one of the <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-4">ancestor
   browsing contexts</a> of <var>A</var>, and <var>A</var>'s
   <code id="security-nav:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="security-nav:active-sandboxing-flag-set-3">active sandboxing flag set</a> has its <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="security-nav:sandboxed-navigation-browsing-context-flag-2">sandboxed
   navigation browsing context flag</a> set, and <var>A</var> is not the <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="security-nav:one-permitted-sandboxed-navigator">one
   permitted sandboxed navigator</a> of <var>B</var>, then abort these steps
   negatively.</p></li><li><p>Otherwise, terminate positively!</p></li></ol>

  <hr>

  <p>An element has a <dfn id="browsing-context-scope-origin">browsing context scope origin</dfn> if its <code id="security-nav:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s
  <a href="/breakup/specs/browser-dom/#browsing-context" id="security-nav:browsing-context-6">browsing context</a> is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="security-nav:top-level-browsing-context-7">top-level browsing context</a> or if all of its
  <code id="security-nav:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-5">ancestor browsing contexts</a>
  all have <a href="/breakup/specs/browser-dom/#active-document" id="security-nav:active-document-6">active documents</a> whose <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2-4">origin</a> are the
  <a href="/breakup/specs/browser-dom/#same-origin" id="security-nav:same-origin-3">same origin</a> as the element's <a id="security-nav:node-document-2" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2-5">origin</a>. If an
  element has a <a href="/breakup/specs/browser-dom/#browsing-context-scope-origin" id="security-nav:browsing-context-scope-origin">browsing context scope origin</a>, then its value is the
  <a href="/breakup/specs/browser-dom/#origin-2" id="security-nav:origin-2-6">origin</a> of the element's <a id="security-nav:node-document-3" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</p></section>

  



  

  <section><h4 id="groupings-of-browsing-contexts">6.1.5 Groupings of browsing contexts</h4>

  <p>Each <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context">browsing context</a> is defined as having a list of one or more <dfn id="directly-reachable-browsing-contexts">directly
  reachable browsing contexts</dfn>. These are:</p>

  <ul><li>The <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-2">browsing context</a> itself.</li><li>All the <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-3">browsing context</a>'s <a href="/breakup/specs/browser-dom/#child-browsing-context" id="groupings-of-browsing-contexts:child-browsing-context">child browsing
   contexts</a>.</li><li>The <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-4">browsing context</a>'s <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="groupings-of-browsing-contexts:parent-browsing-context">parent browsing context</a>.</li><li>All the <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-5">browsing contexts</a> that have the <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-6">browsing
   context</a> as their <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="groupings-of-browsing-contexts:opener-browsing-context">opener browsing context</a>.</li><li>The <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-7">browsing context</a>'s <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="groupings-of-browsing-contexts:opener-browsing-context-2">opener browsing context</a>.</li></ul>

  <p>The transitive closure of all the <a href="/breakup/specs/browser-dom/#browsing-context" id="groupings-of-browsing-contexts:browsing-context-8">browsing contexts</a> that
  are <a href="/breakup/specs/browser-dom/#directly-reachable-browsing-contexts" id="groupings-of-browsing-contexts:directly-reachable-browsing-contexts">directly reachable browsing contexts</a> forms a <dfn id="unit-of-related-browsing-contexts">unit of related browsing
  contexts</dfn>.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#unit-of-related-browsing-contexts" id="groupings-of-browsing-contexts:unit-of-related-browsing-contexts">unit of related browsing contexts</a> is then further divided into the smallest
  number of groups such that every member of each group has an <a href="/breakup/specs/browser-dom/#active-document" id="groupings-of-browsing-contexts:active-document">active document</a> with an
  <a href="/breakup/specs/browser-dom/#effective-script-origin" id="groupings-of-browsing-contexts:effective-script-origin">effective script origin</a> that, through appropriate manipulation of the <code id="groupings-of-browsing-contexts:dom-document-domain"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code> attribute, could be made to be the same as
  other members of the group, but could not be made the same as members of any other group. Each
  such group is a <dfn id="unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</dfn>.</p>

  <p class="note">There is also at most one <a href="/breakup/specs/browser-dom/#event-loop" id="groupings-of-browsing-contexts:event-loop">event loop</a> per <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="groupings-of-browsing-contexts:unit-of-related-similar-origin-browsing-contexts">unit of related
  similar-origin browsing contexts</a> (though several <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="groupings-of-browsing-contexts:unit-of-related-similar-origin-browsing-contexts-2">units of related similar-origin browsing contexts</a> can
  have a shared <a href="/breakup/specs/browser-dom/#event-loop" id="groupings-of-browsing-contexts:event-loop-2">event loop</a>).</p></section>

  



  <section><h4 id="browsing-context-names">6.1.6 Browsing context names</h4>

  <p>Browsing contexts can have a <dfn id="browsing-context-name">browsing context name</dfn>. By default, a browsing context
  has no name (its name is not set).</p>

  <p>A <dfn id="valid-browsing-context-name">valid browsing context name</dfn> is any string with at least one character that does
  not start with a U+005F LOW LINE character. (Names starting with an underscore are reserved for
  special keywords.)</p>

  <p>A <dfn id="valid-browsing-context-name-or-keyword">valid browsing context name or keyword</dfn> is any string that is either a <a href="/breakup/specs/browser-dom/#valid-browsing-context-name" id="browsing-context-names:valid-browsing-context-name">valid
  browsing context name</a> or that is an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="browsing-context-names:ascii-case-insensitive">ASCII case-insensitive</a> match for one of:
  <code>_blank</code>, <code>_self</code>, <code>_parent</code>, or <code>_top</code>.</p>

  <p>These values have different meanings based on whether the page is sandboxed or not, as
  summarised in the following (non-normative) table. In this table, "current" means the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="browsing-context-names:browsing-context">browsing context</a> that the link or script is in, "parent" means the <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="browsing-context-names:parent-browsing-context">parent
  browsing context</a> of the one the link or script is in, "master" means the nearest
  <a href="/breakup/specs/browser-dom/#ancestor-browsing-context" id="browsing-context-names:ancestor-browsing-context">ancestor browsing context</a> of the one the link or script is in that is not itself in a
  <a href="#attr-iframe-seamless" id="browsing-context-names:attr-iframe-seamless">seamless iframe</a>, "top" means the <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context">top-level
  browsing context</a> of the one the link or script is in, "new" means a new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-2">top-level
  browsing context</a> or <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="browsing-context-names:auxiliary-browsing-context">auxiliary browsing context</a> is to be created, subject to
  various user preferences and user agent policies, "none" means that nothing will happen, and
  "maybe new" means the same as "new" if the "<code id="browsing-context-names:attr-iframe-sandbox-allow-popups"><a href="/breakup/specs/browser-dom/#attr-iframe-sandbox-allow-popups">allow-popups</a></code>" keyword is also specified on the
  <code id="browsing-context-names:attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute (or if the user overrode the
  sandboxing), and the same as "none" otherwise.</p>

  <table><thead><tr><th rowspan="2">Keyword
     </th><th rowspan="2">Ordinary effect
     </th><th colspan="5">Effect in an <code id="browsing-context-names:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> with...
    </th></tr><tr><th><code>seamless=""</code>
     </th><th><code>sandbox=""</code>
     </th><th><code>sandbox="" seamless=""</code>
     </th><th><code>sandbox="allow-top-navigation"</code>
     </th><th><code>sandbox="allow-top-navigation" seamless=""</code>

   </th></tr></thead><tbody><tr><td>none specified, for links and form submissions 
     </td><td>current
     </td><td>master
     </td><td>current
     </td><td>master
     </td><td>current
     </td><td>master

    </td></tr><tr><td>empty string
     </td><td>current
     </td><td>master
     </td><td>current
     </td><td>master
     </td><td>current
     </td><td>master

    </td></tr><tr><td><code>_blank</code>
     </td><td>new
     </td><td>new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new

    </td></tr><tr><td><code>_self</code>
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current

    </td></tr><tr><td><code>_parent</code> if there isn't a parent
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current

    </td></tr><tr><td><code>_parent</code> if parent is also top
     </td><td>parent/top
     </td><td>parent/top
     </td><td>none
     </td><td>none
     </td><td>parent/top
     </td><td>parent/top

    </td></tr><tr><td><code>_parent</code> if there is one and it's not top
     </td><td>parent
     </td><td>parent
     </td><td>none
     </td><td>none
     </td><td>none
     </td><td>none

    </td></tr><tr><td><code>_top</code> if top is current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current

    </td></tr><tr><td><code>_top</code> if top is not current
     </td><td>top
     </td><td>top
     </td><td>none
     </td><td>none
     </td><td>top
     </td><td>top

    </td></tr><tr><td>name that doesn't exist
     </td><td>new
     </td><td>new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new

    </td></tr><tr><td>name that exists and is a descendant
     </td><td>specified descendant
     </td><td>specified descendant
     </td><td>specified descendant
     </td><td>specified descendant
     </td><td>specified descendant
     </td><td>specified descendant

    </td></tr><tr><td>name that exists and is current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current
     </td><td>current

    </td></tr><tr><td>name that exists and is an ancestor that is top
     </td><td>specified ancestor
     </td><td>specified ancestor
     </td><td>none
     </td><td>none
     </td><td>specified ancestor/top
     </td><td>specified ancestor/top

    </td></tr><tr><td>name that exists and is an ancestor that is not top
     </td><td>specified ancestor
     </td><td>specified ancestor
     </td><td>none
     </td><td>none
     </td><td>none
     </td><td>none

    </td></tr><tr><td>other name that exists with common top
     </td><td>specified
     </td><td>specified
     </td><td>none
     </td><td>none
     </td><td>none
     </td><td>none

    </td></tr><tr><td>name that exists with different top, if <a href="/breakup/specs/browser-dom/#familiar-with" id="browsing-context-names:familiar-with">familiar</a> and <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="browsing-context-names:one-permitted-sandboxed-navigator">one permitted sandboxed navigator</a>
     </td><td>specified
     </td><td>specified
     </td><td>specified
     </td><td>specified
     </td><td>specified
     </td><td>specified

    </td></tr><tr><td>name that exists with different top, if <a href="/breakup/specs/browser-dom/#familiar-with" id="browsing-context-names:familiar-with-2">familiar</a> but not <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="browsing-context-names:one-permitted-sandboxed-navigator-2">one permitted sandboxed navigator</a>
     </td><td>specified
     </td><td>specified
     </td><td>none
     </td><td>none
     </td><td>none
     </td><td>none

    </td></tr><tr><td>name that exists with different top, not <a href="/breakup/specs/browser-dom/#familiar-with" id="browsing-context-names:familiar-with-3">familiar</a>
     </td><td>new
     </td><td>new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new
     </td><td>maybe new

  </td></tr></tbody></table>

  <p class="tablenote"><small>Most of the restrictions on sandboxed browsing contexts are applied by
  other algorithms, e.g. the <a href="#navigate" id="browsing-context-names:navigate">navigation</a> algorithm, not <a href="/breakup/specs/browser-dom/#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" id="browsing-context-names:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">the rules
  for choosing a browsing context given a browsing context name</a> given below.</small></p>

  

  <hr>

  <p>An algorithm is <dfn id="allowed-to-show-a-popup">allowed to show a popup</dfn> if any of the following conditions is
  true:</p>

  <ul><li><p>The <a href="/breakup/specs/browser-dom/#concept-task" id="browsing-context-names:concept-task">task</a> in which the algorithm is running is currently
   processing an <a href="#activation-behaviour" id="browsing-context-names:activation-behaviour">activation behaviour</a> whose <code id="browsing-context-names:event-click"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> event
   was <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="browsing-context-names:concept-events-trusted">trusted</a>.</p></li><li>

    <p>The <a href="/breakup/specs/browser-dom/#concept-task" id="browsing-context-names:concept-task-2">task</a> in which the algorithm is running is currently
    running the event listener for a <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="browsing-context-names:concept-events-trusted-2">trusted</a> event whose
    type is in the following list:</p>

    <ul class="brief"><li><code id="browsing-context-names:event-change"><a href="/breakup/specs/html/#event-change">change</a></code></li><li><code id="browsing-context-names:event-click-2"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code></li><li><code id="browsing-context-names:event-dblclick"><a href="/breakup/specs/core-algorithms/#event-dblclick">dblclick</a></code></li><li><code id="browsing-context-names:event-mouseup"><a href="/breakup/specs/core-algorithms/#event-mouseup">mouseup</a></code></li><li><code id="browsing-context-names:event-reset"><a href="/breakup/specs/html/#event-reset">reset</a></code></li><li><code id="browsing-context-names:event-submit"><a href="/breakup/specs/html/#event-submit">submit</a></code></li></ul>

   </li><li>

    <p>The <a href="/breakup/specs/browser-dom/#concept-task" id="browsing-context-names:concept-task-3">task</a> in which the algorithm is running was <a href="/breakup/specs/browser-dom/#queue-a-task" id="browsing-context-names:queue-a-task">queued</a> by an algorithm that was <a href="/breakup/specs/browser-dom/#allowed-to-show-a-popup" id="browsing-context-names:allowed-to-show-a-popup">allowed to show a popup</a>,
    and the chain of such algorithms started within a user-agent defined timeframe.</p>

    <p class="example">For example, if a user clicked a button, it might be acceptable for a popup
    to result from that after 4 seconds, but it would likely not be acceptable for a popup to result
    from that after 4 hours.</p>

   </li></ul>

  <hr>

  <p><dfn id="the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">The rules for choosing a browsing context given a browsing context name</dfn> are as
  follows. The rules assume that they are being applied in the context of a <a href="/breakup/specs/browser-dom/#browsing-context" id="browsing-context-names:browsing-context-2">browsing
  context</a>, as part of the execution of a <a href="/breakup/specs/browser-dom/#concept-task" id="browsing-context-names:concept-task-4">task</a>.</p>

  <ol><li>

    <p>If the given browsing context name is the empty string or <code>_self</code>, then
    the chosen browsing context must be the current one.</p>

    <p>If the given browsing context name is <code>_self</code>, then this is an
    <a href="#explicit-self-navigation-override" id="browsing-context-names:explicit-self-navigation-override">explicit self-navigation override</a>, which overrides the behaviour of the
    <a href="#seamless-browsing-context-flag" id="browsing-context-names:seamless-browsing-context-flag">seamless browsing context flag</a> set by the <code id="browsing-context-names:attr-iframe-seamless-2"><a href="#attr-iframe-seamless">seamless</a></code> attribute on <code id="browsing-context-names:the-iframe-element-2"><a href="#the-iframe-element">iframe</a></code> elements.</p>

   </li><li><p>If the given browsing context name is <code>_parent</code>, then the chosen
   browsing context must be the <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="browsing-context-names:parent-browsing-context-2"><em>parent</em> browsing context</a> of the current one,
   unless there isn't one, in which case the chosen browsing context must be the current browsing
   context.</p></li><li><p>If the given browsing context name is <code>_top</code>, then the chosen browsing
   context must be the <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-3">top-level browsing context</a> of the current one, if there is one,
   or else the current browsing context.</p></li><li>

    <p>If the given browsing context name is not <code>_blank</code> and there exists a
    browsing context whose <a href="/breakup/specs/browser-dom/#browsing-context-name" id="browsing-context-names:browsing-context-name">name</a> is the same as the given
    browsing context name, and the current browsing context is <a href="/breakup/specs/browser-dom/#familiar-with" id="browsing-context-names:familiar-with-4">familiar with</a> that
    browsing context, and the user agent determines that the two browsing contexts are related
    enough that it is ok if they reach each other, then that browsing context must be the chosen
    one. If there are multiple matching browsing contexts, the user agent should select one in some
    arbitrary consistent manner, such as the most recently opened, most recently focused, or more
    closely related.</p>

    <p>If the browsing context is chosen by this step to be the current browsing context, then this
    is also an <a href="#explicit-self-navigation-override" id="browsing-context-names:explicit-self-navigation-override-2">explicit self-navigation override</a>.</p>

   </li><li>

    <p>Otherwise, a new browsing context is being requested, and what happens depends on the user
    agent's configuration and abilities  it is determined by the rules given for the first
    applicable option from the following list:</p>

    <dl class="switch"><dt id="popup-blocker">If the algorithm is not <a href="/breakup/specs/browser-dom/#allowed-to-show-a-popup" id="browsing-context-names:allowed-to-show-a-popup-2">allowed to show a popup</a> and the
     user agent has been configured to not show popups (i.e. the user agent has a "popup blocker"
     enabled)</dt><dd>

      <p>There is no chosen browsing context. The user agent may inform the user that a popup has
      been blocked.</p>

     </dd><dt id="sandboxWindowOpen">If the current browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="browsing-context-names:active-document">active document</a>'s
     <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="browsing-context-names:active-sandboxing-flag-set">active sandboxing flag set</a> has the <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="browsing-context-names:sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing
     context flag</a> set.</dt><dd>

      <p>Typically, there is no chosen browsing context.</p>

      <p>The user agent may offer to <a href="/breakup/specs/browser-dom/#creating-a-new-browsing-context" id="browsing-context-names:creating-a-new-browsing-context">create</a> a new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-4">top-level browsing context</a> or reuse
      an existing <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-5">top-level browsing context</a>. If the user picks one of those options,
      then the designated browsing context must be the chosen one (the browsing context's name isn't
      set to the given browsing context name). The default behaviour (if the user agent doesn't
      offer the option to the user, or if the user declines to allow a browsing context to be used)
      must be that there must not be a chosen browsing context.</p>

      <p class="warning">If this case occurs, it means that an author has explicitly sandboxed the
      document that is trying to open a link.</p>

     </dd><dt id="noopener">If the user agent has been configured such that in this instance it will
     create a new browsing context, and the browsing context is being requested as part of <a href="#following-hyperlinks-2" id="browsing-context-names:following-hyperlinks-2">following a hyperlink</a> whose <a href="#linkTypes">link
     types</a> include the <code id="browsing-context-names:link-type-noreferrer"><a href="#link-type-noreferrer">noreferrer</a></code> keyword</dt><dd><p>A new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-6">top-level browsing context</a> must be <a href="/breakup/specs/browser-dom/#creating-a-new-browsing-context" id="browsing-context-names:creating-a-new-browsing-context-2">created</a>. If the given browsing
     context name is not <code>_blank</code>, then the new top-level browsing context's
     name must be the given browsing context name (otherwise, it has no name). The chosen browsing
     context must be this new browsing context. The creation of such a <a href="/breakup/specs/browser-dom/#browsing-context" id="browsing-context-names:browsing-context-3">browsing context</a>
     is <dfn id="a-new-start-for-session-storage">a new start for session storage</dfn>.</p>

     <p class="note">If it is immediately <a href="#navigate" id="browsing-context-names:navigate-2">navigated</a>, then the
     navigation will be done with <a href="#replacement-enabled" id="browsing-context-names:replacement-enabled">replacement enabled</a>.</p></dd><dt>If the user agent has been configured such that in this instance it will create a new
     browsing context, and the <code id="browsing-context-names:link-type-noreferrer-2"><a href="#link-type-noreferrer">noreferrer</a></code> keyword doesn't
     apply</dt><dd><p>A new <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="browsing-context-names:auxiliary-browsing-context-2">auxiliary browsing context</a> must be created, with the <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="browsing-context-names:opener-browsing-context">opener
     browsing context</a> being the current one. If the given browsing context name is not <code>_blank</code>, then the new auxiliary browsing context's name must be the given
     browsing context name (otherwise, it has no name). The chosen browsing context must be this new
     browsing context.</p>

     <p class="note">If it is immediately <a href="#navigate" id="browsing-context-names:navigate-3">navigated</a>, then the
     navigation will be done with <a href="#replacement-enabled" id="browsing-context-names:replacement-enabled-2">replacement enabled</a>.</p></dd><dt>If the user agent has been configured such that in this instance it will reuse the current
     browsing context</dt><dd><p>The chosen browsing context is the current browsing context.</p></dd><dt>If the user agent has been configured such that in this instance it will not find a
     browsing context</dt><dd><p>There must not be a chosen browsing context.</p></dd></dl>

    <p>User agent implementors are encouraged to provide a way for users to configure the user agent
    to always reuse the current browsing context.</p>

    <p>If the current browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="browsing-context-names:active-document-2">active document</a>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="browsing-context-names:active-sandboxing-flag-set-2">active sandboxing flag
    set</a> has the <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="browsing-context-names:sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a> set and the chosen
    browsing context picked above, if any, is a new browsing context (whether top-level or
    auxiliary), then all the flags that are set in the current browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="browsing-context-names:active-document-3">active
    document</a>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="browsing-context-names:active-sandboxing-flag-set-3">active sandboxing flag set</a> when the new browsing context is
    created must be set in the new browsing context's <a href="/breakup/specs/browser-dom/#popup-sandboxing-flag-set" id="browsing-context-names:popup-sandboxing-flag-set">popup sandboxing flag set</a>, and
    the current browsing context must be set as the new browsing context's <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="browsing-context-names:one-permitted-sandboxed-navigator-3">one permitted
    sandboxed navigator</a>.</p>

   </li></ol></section></section><section><h3 id="the-window-object">6.2 The <code id="the-window-object:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object</h3>

  <pre class="idl">[PrimaryGlobal] 
/*sealed*/ interface <dfn id="window">Window</dfn> : <a href="/breakup/specs/core-algorithms/#eventtarget" id="the-window-object:eventtarget">EventTarget</a> {
  // the current browsing context
  [Unforgeable] readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-window" id="the-window-object:dom-window">window</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-2">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-self" id="the-window-object:dom-self">self</a>;
  [Unforgeable] readonly attribute <a href="/breakup/specs/browser-dom/#document" id="the-window-object:document">Document</a> <a href="/breakup/specs/browser-dom/#dom-document-2" id="the-window-object:dom-document-2">document</a>;
  attribute DOMString <a href="/breakup/specs/browser-dom/#dom-name" id="the-window-object:dom-name">name</a>; 
  [PutForwards=<a href="/breakup/specs/core-algorithms/#dom-url-href" id="the-window-object:dom-url-href">href</a>, Unforgeable] readonly attribute <a href="/breakup/specs/browser-dom/#location" id="the-window-object:location">Location</a> <a href="/breakup/specs/browser-dom/#dom-location" id="the-window-object:dom-location">location</a>;
  readonly attribute <a href="/breakup/specs/browser-dom/#history-3" id="the-window-object:history-3">History</a> <a href="/breakup/specs/browser-dom/#dom-history" id="the-window-object:dom-history">history</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-locationbar" id="the-window-object:dom-window-locationbar">locationbar</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop-2">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-menubar" id="the-window-object:dom-window-menubar">menubar</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop-3">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-personalbar" id="the-window-object:dom-window-personalbar">personalbar</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop-4">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-scrollbars" id="the-window-object:dom-window-scrollbars">scrollbars</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop-5">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-statusbar" id="the-window-object:dom-window-statusbar">statusbar</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#barprop" id="the-window-object:barprop-6">BarProp</a> <a href="/breakup/specs/browser-dom/#dom-window-toolbar" id="the-window-object:dom-window-toolbar">toolbar</a>;
  attribute DOMString <a href="/breakup/specs/browser-dom/#dom-window-status" id="the-window-object:dom-window-status">status</a>;
  void <a href="/breakup/specs/browser-dom/#dom-window-close" id="the-window-object:dom-window-close">close</a>();
  readonly attribute boolean <a href="/breakup/specs/browser-dom/#dom-window-closed" id="the-window-object:dom-window-closed">closed</a>;
  void <a href="/breakup/specs/browser-dom/#dom-window-stop" id="the-window-object:dom-window-stop">stop</a>();
  void <a href="#dom-window-focus" id="the-window-object:dom-window-focus">focus</a>();
  void <a href="#dom-window-blur" id="the-window-object:dom-window-blur">blur</a>();

  // other browsing contexts
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-3">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-frames" id="the-window-object:dom-frames">frames</a>;
  [Replaceable] readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-length" id="the-window-object:dom-length">length</a>;
  [Unforgeable] readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-4">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-top" id="the-window-object:dom-top">top</a>;
  attribute any <a href="/breakup/specs/browser-dom/#dom-opener" id="the-window-object:dom-opener">opener</a>;
  [Replaceable] readonly attribute <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-5">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-parent" id="the-window-object:dom-parent">parent</a>;
  readonly attribute <a href="/breakup/specs/core-algorithms/#element" id="the-window-object:element">Element</a>? <a href="/breakup/specs/browser-dom/#dom-frameelement" id="the-window-object:dom-frameelement">frameElement</a>;
  <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-6">WindowProxy</a> <a href="/breakup/specs/browser-dom/#dom-open" id="the-window-object:dom-open">open</a>(optional DOMString url = "about:blank", optional DOMString target = "_blank", [TreatNullAs=EmptyString] optional DOMString features = "", optional boolean replace = false);
  <a href="/breakup/specs/browser-dom/#dom-window-item" id="the-window-object:dom-window-item">getter</a> <a href="/breakup/specs/browser-dom/#windowproxy" id="the-window-object:windowproxy-7">WindowProxy</a> (unsigned long index);
  <a href="/breakup/specs/browser-dom/#dom-window-nameditem" id="the-window-object:dom-window-nameditem">getter</a> object (DOMString name);

  // the user agent
  readonly attribute <a href="/breakup/specs/browser-dom/#navigator" id="the-window-object:navigator">Navigator</a> <a href="/breakup/specs/browser-dom/#dom-navigator" id="the-window-object:dom-navigator">navigator</a>; 
  [Replaceable, SameObject] readonly attribute <a href="/breakup/specs/browser-dom/#external" id="the-window-object:external">External</a> <a href="/breakup/specs/browser-dom/#dom-external" id="the-window-object:dom-external">external</a>;
  readonly attribute <a href="#applicationcache" id="the-window-object:applicationcache">ApplicationCache</a> <a href="#dom-applicationcache" id="the-window-object:dom-applicationcache">applicationCache</a>;

  // user prompts
  void <a href="/breakup/specs/browser-dom/#dom-alert" id="the-window-object:dom-alert">alert</a>();
  void <a href="/breakup/specs/browser-dom/#dom-alert" id="the-window-object:dom-alert-2">alert</a>(DOMString message);
  boolean <a href="/breakup/specs/browser-dom/#dom-confirm" id="the-window-object:dom-confirm">confirm</a>(optional DOMString message = "");
  DOMString? <a href="/breakup/specs/browser-dom/#dom-prompt" id="the-window-object:dom-prompt">prompt</a>(optional DOMString message = "", optional DOMString default = "");
  void <a href="/breakup/specs/browser-dom/#dom-print" id="the-window-object:dom-print">print</a>();
  any <a href="/breakup/specs/browser-dom/#dom-showmodaldialog" id="the-window-object:dom-showmodaldialog">showModalDialog</a>(DOMString url, optional any argument); // deprecated

  long <a href="/breakup/specs/browser-dom/#dom-window-requestanimationframe" id="the-window-object:dom-window-requestanimationframe">requestAnimationFrame</a>(<span>FrameRequestCallback</span> callback);
  void <a href="/breakup/specs/browser-dom/#dom-window-cancelanimationframe" id="the-window-object:dom-window-cancelanimationframe">cancelAnimationFrame</a>(long handle);

  void <a href="http://www.w3.org/TR/webmessaging/#dom-window-postmessage" id="the-window-object:dom-window-postmessage">postMessage</a>(any message, DOMString targetOrigin, optional sequence&lt;<a href="/breakup/specs/core-algorithms/#transferable" id="the-window-object:transferable">Transferable</a>&gt; transfer);

  // <a href="#Window-partial">also has obsolete members</a>
};
<a href="/breakup/specs/browser-dom/#window" id="the-window-object:window-2">Window</a> implements <a href="/breakup/specs/browser-dom/#globaleventhandlers" id="the-window-object:globaleventhandlers">GlobalEventHandlers</a>;
<a href="/breakup/specs/browser-dom/#window" id="the-window-object:window-3">Window</a> implements <a href="/breakup/specs/browser-dom/#windoweventhandlers" id="the-window-object:windoweventhandlers">WindowEventHandlers</a>;</pre>



  <dl class="domintro"><dt><var>window</var> . <code id="the-window-object:dom-window-2"><a href="/breakup/specs/browser-dom/#dom-window">window</a></code></dt><dt><var>window</var> . <code id="the-window-object:dom-frames-2"><a href="/breakup/specs/browser-dom/#dom-frames">frames</a></code></dt><dt><var>window</var> . <code id="the-window-object:dom-self-2"><a href="/breakup/specs/browser-dom/#dom-self">self</a></code></dt><dd>

    <p>These attributes all return <var>window</var>.</p>

   </dd><dt><var>window</var> . <code id="the-window-object:dom-document-2-2"><a href="/breakup/specs/browser-dom/#dom-document-2">document</a></code></dt><dd>

    <p>Returns the <code id="the-window-object:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> associated with <var>window</var>.</p>

   </dd><dt><var>document</var> . <code id="the-window-object:dom-document-defaultview"><a href="/breakup/specs/browser-dom/#dom-document-defaultview">defaultView</a></code></dt><dd>

    <p>Returns the <code id="the-window-object:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the <a href="/breakup/specs/browser-dom/#active-document" id="the-window-object:active-document">active document</a>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-window"><code>window</code></dfn>, <dfn id="dom-frames"><code>frames</code></dfn>, and <dfn id="dom-self"><code>self</code></dfn>
  IDL attributes must all return the <code id="the-window-object:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <a href="/breakup/specs/browser-dom/#browsing-context" id="the-window-object:browsing-context">browsing context</a>'s
  <code id="the-window-object:windowproxy-8"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object.</p>

  <p>The <dfn id="dom-document-2"><code>document</code></dfn> IDL attribute must return
  <a href="/breakup/specs/browser-dom/#concept-document-window" id="the-window-object:concept-document-window">the <code>Window</code> object's newest <code>Document</code> object</a>.</p>

  <p class="note">The <code id="the-window-object:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object associated with a <code id="the-window-object:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object can
  change in exactly one case: when the <a href="#navigate" id="the-window-object:navigate">navigate</a> algorithm <a href="#initialise-the-document-object" id="the-window-object:initialise-the-document-object">initialises a new <code>Document</code> object</a> for the first page loaded
  in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-window-object:browsing-context-2">browsing context</a>. In that specific case, the <code id="the-window-object:window-7"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the
  original <code id="the-window-object:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> page is reused and gets a new <code id="the-window-object:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object.</p>

  <p>The <dfn id="dom-document-defaultview"><code>defaultView</code></dfn> IDL attribute of the
  <code id="the-window-object:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> interface must return the <code id="the-window-object:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="the-window-object:browsing-context-3">browsing
  context</a>'s <code id="the-window-object:windowproxy-9"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object, if there is one, or null otherwise.</p>

  <hr>

  <p>For historical reasons, <code id="the-window-object:window-8"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects must also have a writable, configurable,
  non-enumerable property named <dfn id="htmldocument"><code>HTMLDocument</code></dfn> whose value is the
  <code id="the-window-object:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> interface object.</p>

  



  

  <section><h4 id="security-window">6.2.1 Security</h4>

  <p class="critical">This section describes a security model that is underdefined, imperfect, and
  does not match implementations. Work is ongoing to attempt to resolve this, but in the meantime,
  please do not rely on this section for precision. Implementors are urged to send their feedback on
  how cross-origin cross-global access to <code id="security-window:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> and <code id="security-window:location"><a href="/breakup/specs/browser-dom/#location">Location</a></code> objects
  should work. See <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=20701">bug 20701</a>.</p>

  <p id="security-2">User agents must throw a <code id="security-window:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception whenever any
  properties of a <code id="security-window:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object are accessed when the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="security-window:incumbent-settings-object">incumbent settings
  object</a> specifies an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin">effective script origin</a> that is not the <a href="/breakup/specs/browser-dom/#same-origin" id="security-window:same-origin">same</a> as <a href="/breakup/specs/browser-dom/#concept-document-window" id="security-window:concept-document-window">the <code>Window</code> object's
  <code>Document</code></a>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin-2">effective script origin</a>, with the following
  exceptions:</p>

  <ul><li>The <code id="security-window:dom-location"><a href="/breakup/specs/browser-dom/#dom-location">location</a></code> attribute

   </li><li>The <code id="security-window:dom-window-postmessage"><a href="http://www.w3.org/TR/webmessaging/#dom-window-postmessage">postMessage()</a></code> method

   </li><li>The <code id="security-window:dom-window"><a href="/breakup/specs/browser-dom/#dom-window">window</a></code> attribute

   </li><li>The <code id="security-window:dom-frames"><a href="/breakup/specs/browser-dom/#dom-frames">frames</a></code> attribute

   </li><li>The <code id="security-window:dom-self"><a href="/breakup/specs/browser-dom/#dom-self">self</a></code> attribute

   </li><li>The <code id="security-window:dom-top"><a href="/breakup/specs/browser-dom/#dom-top">top</a></code> attribute

   </li><li>The <code id="security-window:dom-parent"><a href="/breakup/specs/browser-dom/#dom-parent">parent</a></code> attribute

   </li><li>The <code id="security-window:dom-opener"><a href="/breakup/specs/browser-dom/#dom-opener">opener</a></code> attribute

   </li><li>The <code id="security-window:dom-window-closed"><a href="/breakup/specs/browser-dom/#dom-window-closed">closed</a></code> attribute

   </li><li>The <code id="security-window:dom-window-close"><a href="/breakup/specs/browser-dom/#dom-window-close">close()</a></code> method

   </li><li>The <code id="security-window:dom-window-blur"><a href="#dom-window-blur">blur()</a></code> method

   </li><li>The <code id="security-window:dom-window-focus"><a href="#dom-window-focus">focus()</a></code> method

   </li><li>The <a href="/breakup/specs/browser-dom/#dynamic-nested-browsing-context-properties" id="security-window:dynamic-nested-browsing-context-properties">dynamic nested browsing context properties</a>

  </li></ul>

  <p>When the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="security-window:incumbent-settings-object-2">incumbent settings object</a> specifies an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin-3">effective script
  origin</a> that is different than a <a href="/breakup/specs/browser-dom/#concept-document-window" id="security-window:concept-document-window-2"><code>Window</code>
  object's <code>Document</code></a>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin-4">effective script origin</a>, the user agent must
  act as if any changes to that <code id="security-window:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's properties, getters, setters, etc, were
  not present, and as if all the properties of that <code id="security-window:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object had their
  [[Enumerable]] attribute set to false.</p>

  <p>For members that return objects (including function objects), each distinct <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin-5">effective
  script origin</a> that is not the same as the <code id="security-window:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's
  <code id="security-window:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-window:effective-script-origin-6">effective script origin</a> must be provided with a separate set
  of objects. These objects must have the prototype chain appropriate for the script for which the
  objects are created (not those that would be appropriate for scripts whose <a href="/breakup/specs/browser-dom/#global-object" id="security-window:global-object">global
  object</a>, as specified by their <a href="/breakup/specs/browser-dom/#settings-object" id="security-window:settings-object">settings object</a>, is the <code id="security-window:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  object in question).</p>

  <div class="example">

   <p>For instance, if two frames containing <code id="security-window:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s from different <a href="/breakup/specs/browser-dom/#origin-2" id="security-window:origin-2">origins</a> access the same <code id="security-window:window-7"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <code id="security-window:dom-window-postmessage-2"><a href="http://www.w3.org/TR/webmessaging/#dom-window-postmessage">postMessage()</a></code> method, they will get distinct objects that
   are not equal.</p>

  </div></section>

  




  <section><h4 id="apis-for-creating-and-navigating-browsing-contexts-by-name">6.2.2 APIs for creating and navigating browsing contexts by name</h4>

  <dl class="domintro"><dt><var>window</var> = <var>window</var> . <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-open"><a href="/breakup/specs/browser-dom/#dom-open">open</a></code>( [ <var>url</var> [, <var>target</var> [, <var>features</var> [, <var>replace</var> ] ] ] ] )</dt><dd>

    <p>Opens a window to show <var>url</var> (defaults to <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>), and
    returns it. The <var>target</var> argument gives the name of the new window. If a
    window exists with that name already, it is reused. The <var>replace</var> attribute,
    if true, means that whatever page is currently open in that window will be removed from the
    window's session history. The <var id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-open-features"><a data-x-internal="dom-open-features" href="http://dev.w3.org/csswg/cssom-view/#the-features-argument-to-the-open()-method">features</a></var> argument can be used to influence the rendering of the new window.</p>

   </dd><dt><var>window</var> . <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-name"><a href="/breakup/specs/browser-dom/#dom-name">name</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns the name of the window.</p>

    <p>Can be set, to change the name.</p>

   </dd><dt><var>window</var> . <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-window-close"><a href="/breakup/specs/browser-dom/#dom-window-close">close</a></code>()</dt><dd>

    <p>Closes the window.</p>

   </dd><dt><var>window</var> . <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-window-closed"><a href="/breakup/specs/browser-dom/#dom-window-closed">closed</a></code></dt><dd>

    <p>Returns true if the window has been closed, false otherwise.</p>

   </dd><dt><var>window</var> . <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-window-stop"><a href="/breakup/specs/browser-dom/#dom-window-stop">stop</a></code>()</dt><dd>

    <p>Cancels the document load.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-open"><code>open()</code></dfn> method on <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects
  provides a mechanism for <a href="#navigate" id="apis-for-creating-and-navigating-browsing-contexts-by-name:navigate">navigating</a> an existing <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context">browsing
  context</a> or opening and navigating an <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:auxiliary-browsing-context">auxiliary browsing context</a>.</p>

  <p>When the method is invoked, the user agent must run the following steps:</p>

  <ol><li><p>Let <var>entry settings</var> be the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="apis-for-creating-and-navigating-browsing-contexts-by-name:entry-settings-object">entry settings object</a> when the method
   was invoked.</p></li><li><p>Let <var>url</var> be the first argument.</p></li><li><p>Let <var>target</var> be the second argument.</p></li><li><p>Let <var id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-open-features-2"><a data-x-internal="dom-open-features" href="http://dev.w3.org/csswg/cssom-view/#the-features-argument-to-the-open()-method">features</a></var> be the third argument.</p></li><li><p>Let <var>replace</var> be the fourth argument.</p></li><li><p>Let <var>source browsing context</var> be the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:responsible-browsing-context">responsible browsing context</a>
   specified by <var>entry settings</var>.</p></li><li><p>If <var>target</var> is the empty string, let it be the string "<code>_blank</code>" instead.</p></li><li>

    <p>If the user has indicated a preference for which <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-2">browsing context</a> to navigate,
    follow these substeps:</p>

    <ol><li><p>Let <var>target browsing context</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-3">browsing context</a> indicated by
     the user.</p></li><li><p>If <var>target browsing context</var> is a new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:top-level-browsing-context">top-level browsing context</a>,
     let the <var>source browsing context</var> be set as <var>target browsing context</var>'s
     <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="apis-for-creating-and-navigating-browsing-contexts-by-name:one-permitted-sandboxed-navigator">one permitted sandboxed navigator</a>.</p></li></ol>

    <p class="example">For example, suppose there is a user agent that supports control-clicking a
    link to open it in a new tab. If a user clicks in that user agent on an element whose <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:handler-onclick"><a href="/breakup/specs/browser-dom/#handler-onclick">onclick</a></code> handler uses the <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:dom-open-2"><a href="/breakup/specs/browser-dom/#dom-open">window.open()</a></code> API to open a page in an iframe, but, while doing so,
    holds the control key down, the user agent could override the selection of the target browsing
    context to instead target a new tab.</p>

    <p>Otherwise, apply <a href="/breakup/specs/browser-dom/#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" id="apis-for-creating-and-navigating-browsing-contexts-by-name:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">the rules for choosing a browsing context given a browsing context
    name</a> using <var>target</var> as the name and <var>source browsing context</var> as the
    context in which the algorithm is executed. If this results in there not being a chosen browsing
    context, then throw an <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:invalidaccesserror"><a href="/breakup/specs/core-algorithms/#invalidaccesserror">InvalidAccessError</a></code> exception and abort these steps.
    Otherwise, let <var>target browsing context</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-4">browsing context</a> so
    obtained.</p>

   </li><li><p>If <var>target browsing context</var> was just created, either as part of <a href="/breakup/specs/browser-dom/#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" id="apis-for-creating-and-navigating-browsing-contexts-by-name:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name-2">the rules
   for choosing a browsing context given a browsing context name</a> or due to the user
   indicating a preference for navigating a new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:top-level-browsing-context-2">top-level browsing context</a>, then let
   <var>new</var> be true. Otherwise, let it be false.</p></li><li><p>Interpret <var>features</var> as defined in the CSSOM View specification. <a href="#refsCSSOMVIEW">[CSSOMVIEW]</a></p></li><li>

    <p>If <var>url</var> is the empty string, run the appropriate steps from the following list:</p>

    <dl><dt>If <var>new</var> is false</dt><dd><p>Jump to the step labeled <i>end</i>.</p></dd><dt>If <var>new</var> is true</dt><dd><p>Let <var>resource</var> be the <a href="/breakup/specs/core-algorithms/#url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:url">URL</a> "<code id="apis-for-creating-and-navigating-browsing-contexts-by-name:about:blank-2"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>".</p></dd></dl>

    <p>Otherwise, <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:resolve-a-url">resolve</a> <var>url</var> relative to the
    <a href="/breakup/specs/browser-dom/#api-base-url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:api-base-url">API base URL</a> specified by <var>entry settings</var>, and let <var>resource</var> be
    the <a href="/breakup/specs/core-algorithms/#resulting-absolute-url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:resulting-absolute-url">resulting absolute URL</a>, if any. If the <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:resolve-a-url-2">resolve a URL</a> algorithm
    failed, then run one of the following two steps instead:</p>

    <ul><li><p>Let <var>resource</var> be a resource representing an inline error page.</p></li><li><p>If <var>new</var> is false, jump to the step labeled <i>end</i>, otherwise, let
     <var>resource</var> be the <a href="/breakup/specs/core-algorithms/#url" id="apis-for-creating-and-navigating-browsing-contexts-by-name:url-2">URL</a> "<code id="apis-for-creating-and-navigating-browsing-contexts-by-name:about:blank-3"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>".</p></li></ul>

   </li><li>

    <p>If <var>resource</var> is "<code id="apis-for-creating-and-navigating-browsing-contexts-by-name:about:blank-4"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>" and <var>new</var> is true, <a href="/breakup/specs/browser-dom/#queue-a-task" id="apis-for-creating-and-navigating-browsing-contexts-by-name:queue-a-task">queue
    a task</a> to <a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="apis-for-creating-and-navigating-browsing-contexts-by-name:fire-a-simple-event">fire a simple event</a> named <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:event-load"><a href="/breakup/specs/html/#event-load">load</a></code> at
    <var>target browsing context</var>'s <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, with <i id="apis-for-creating-and-navigating-browsing-contexts-by-name:concept-event-target-override"><a href="/breakup/specs/core-algorithms/#concept-event-target-override">target override</a></i> set to <var>target browsing
    context</var>'s <a href="/breakup/specs/browser-dom/#concept-document-window" id="apis-for-creating-and-navigating-browsing-contexts-by-name:concept-document-window"><code>Window</code> object's
    <code>Document</code></a> object.</p>

    <p>Otherwise, <a href="#navigate" id="apis-for-creating-and-navigating-browsing-contexts-by-name:navigate-2">navigate</a> <var>target browsing context</var>
    to <var>resource</var>, with <a href="#exceptions-enabled" id="apis-for-creating-and-navigating-browsing-contexts-by-name:exceptions-enabled">exceptions enabled</a>. If <var>new</var> is true, then
    <a href="#replacement-enabled" id="apis-for-creating-and-navigating-browsing-contexts-by-name:replacement-enabled">replacement must be enabled</a> also. The <a href="#source-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:source-browsing-context">source
    browsing context</a> is <var>source browsing context</var>.</p>

   </li><li><p><i>End</i>: Return the <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of <var>target browsing
   context</var>.</p></li></ol>

  <hr>

  <p>The <dfn id="dom-name"><code>name</code></dfn> attribute of the <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object
  must, on getting, return the current <a href="/breakup/specs/browser-dom/#browsing-context-name" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-name">name</a> of the
  <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-5">browsing context</a>, if one is set, or the empty string otherwise; and, on setting, set
  the <a href="/breakup/specs/browser-dom/#browsing-context-name" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-name-2">name</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-6">browsing context</a> to the
  new value.</p>

  <p class="note">The name <a href="#resetBCName">gets reset</a> when the browsing context is
  navigated to another domain.</p>

  <hr>

  <p>The <dfn id="dom-window-close"><code>close()</code></dfn> method on <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  objects should, if all the following conditions are met, <a href="/breakup/specs/browser-dom/#close-a-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:close-a-browsing-context">close</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-7">browsing context</a> <var>A</var>:

  </p><ul class="brief"><li>The corresponding <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-8">browsing context</a> <var>A</var> is
   <a href="/breakup/specs/browser-dom/#script-closable" id="apis-for-creating-and-navigating-browsing-contexts-by-name:script-closable">script-closable</a>.</li><li>The <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:responsible-browsing-context-2">responsible browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="apis-for-creating-and-navigating-browsing-contexts-by-name:incumbent-settings-object">incumbent settings
   object</a> is <a href="/breakup/specs/browser-dom/#familiar-with" id="apis-for-creating-and-navigating-browsing-contexts-by-name:familiar-with">familiar with</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-9">browsing context</a> <var>A</var>.</li><li id="sandboxClose">The <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:responsible-browsing-context-3">responsible browsing context</a> specified by the
   <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="apis-for-creating-and-navigating-browsing-contexts-by-name:incumbent-settings-object-2">incumbent settings object</a> is <a href="/breakup/specs/browser-dom/#allowed-to-navigate" id="apis-for-creating-and-navigating-browsing-contexts-by-name:allowed-to-navigate">allowed to navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-10">browsing
   context</a> <var>A</var>.</li></ul>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-11">browsing context</a> is <dfn id="script-closable">script-closable</dfn> if it is an <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:auxiliary-browsing-context-2">auxiliary
  browsing context</a> that was created by a script (as opposed to by an action of the user), or
  if it is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:top-level-browsing-context-3">top-level browsing context</a> whose <a href="/breakup/specs/browser-dom/#session-history" id="apis-for-creating-and-navigating-browsing-contexts-by-name:session-history">session history</a> contains
  only one <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  <p>The <dfn id="dom-window-closed"><code>closed</code></dfn> attribute on <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  objects must return true if the <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-12">browsing context</a> has
  been <a href="/breakup/specs/browser-dom/#a-browsing-context-is-discarded" id="apis-for-creating-and-navigating-browsing-contexts-by-name:a-browsing-context-is-discarded">discarded</a>, and false otherwise.</p>

  <p>The <dfn id="dom-window-stop"><code>stop()</code></dfn> method on <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-7"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  objects should, if there is an existing attempt to <a href="#navigate" id="apis-for-creating-and-navigating-browsing-contexts-by-name:navigate-3">navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-13">browsing
  context</a> and that attempt is not currently running the <a href="#unload-a-document" id="apis-for-creating-and-navigating-browsing-contexts-by-name:unload-a-document">unload a document</a>
  algorithm, cancel that <a href="#navigate" id="apis-for-creating-and-navigating-browsing-contexts-by-name:navigate-4">navigation</a>; then, it must <a href="#abort-a-document" id="apis-for-creating-and-navigating-browsing-contexts-by-name:abort-a-document">abort</a> the <a href="/breakup/specs/browser-dom/#active-document" id="apis-for-creating-and-navigating-browsing-contexts-by-name:active-document">active document</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="apis-for-creating-and-navigating-browsing-contexts-by-name:browsing-context-14">browsing
  context</a> of the <code id="apis-for-creating-and-navigating-browsing-contexts-by-name:window-8"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object on which it was invoked.</p></section>

  


  <section><h4 id="accessing-other-browsing-contexts">6.2.3 Accessing other browsing contexts</h4>

  <dl class="domintro"><dt><var>window</var> . <code id="accessing-other-browsing-contexts:dom-length"><a href="/breakup/specs/browser-dom/#dom-length">length</a></code></dt><dd>

    <p>Returns the number of <a href="/breakup/specs/browser-dom/#child-browsing-context" id="accessing-other-browsing-contexts:child-browsing-context">child browsing
    contexts</a>.</p>

   </dd><dt><var>window</var>[<var>index</var>]</dt><dd>

    <p>Returns the indicated <a href="/breakup/specs/browser-dom/#child-browsing-context" id="accessing-other-browsing-contexts:child-browsing-context-2">child browsing context</a>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-length"><code>length</code></dfn> IDL attribute on the <code id="accessing-other-browsing-contexts:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  interface must return the number of <a href="/breakup/specs/browser-dom/#child-browsing-context" id="accessing-other-browsing-contexts:child-browsing-context-3">child browsing
  contexts</a> that are <a href="/breakup/specs/browser-dom/#browsing-context-nested-through" id="accessing-other-browsing-contexts:browsing-context-nested-through">nested through</a>
  elements that are <a href="/breakup/specs/core-algorithms/#in-a-document" id="accessing-other-browsing-contexts:in-a-document">in the <code>Document</code></a> that is the
  <a href="/breakup/specs/browser-dom/#active-document" id="accessing-other-browsing-contexts:active-document">active document</a> of that <code id="accessing-other-browsing-contexts:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, if that <code id="accessing-other-browsing-contexts:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code>'s
  <a href="/breakup/specs/browser-dom/#browsing-context" id="accessing-other-browsing-contexts:browsing-context">browsing context</a> shares the same <a href="/breakup/specs/browser-dom/#event-loop" id="accessing-other-browsing-contexts:event-loop">event loop</a> as the <a href="/breakup/specs/browser-dom/#responsible-document" id="accessing-other-browsing-contexts:responsible-document">responsible
  document</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="accessing-other-browsing-contexts:entry-settings-object">entry settings object</a> accessing the IDL attribute;
  otherwise, it must return zero.</p>

  

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="accessing-other-browsing-contexts:supported-property-indices">supported property indices</a> on the <code id="accessing-other-browsing-contexts:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object at any instant
  are the numbers in the range 0 .. <span><var>n</var>-1</span>, where <var>n</var> is the number returned by the <code id="accessing-other-browsing-contexts:dom-length-2"><a href="/breakup/specs/browser-dom/#dom-length">length</a></code> IDL
  attribute. If <var>n</var> is zero then there are no <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="accessing-other-browsing-contexts:supported-property-indices-2">supported property
  indices</a>.</p>

  
  <p>To <dfn id="dom-window-item">determine the value of an indexed property</dfn> <var>index</var> of a <code id="accessing-other-browsing-contexts:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, the user agent must return the
  <code id="accessing-other-browsing-contexts:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <var>index</var>th <a href="/breakup/specs/browser-dom/#child-browsing-context" id="accessing-other-browsing-contexts:child-browsing-context-4">child browsing
  context</a> of the <code id="accessing-other-browsing-contexts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that is <a href="/breakup/specs/browser-dom/#browsing-context-nested-through" id="accessing-other-browsing-contexts:browsing-context-nested-through-2">nested through</a> an element that is <a href="/breakup/specs/core-algorithms/#in-a-document" id="accessing-other-browsing-contexts:in-a-document-2">in the
  <code>Document</code></a>, sorted in the order that the elements nesting those <a href="/breakup/specs/browser-dom/#browsing-context" id="accessing-other-browsing-contexts:browsing-context-2">browsing contexts</a> were most recently inserted into the
  <code id="accessing-other-browsing-contexts:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, the <code id="accessing-other-browsing-contexts:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the most recently inserted
  <a href="/breakup/specs/browser-dom/#browsing-context-container" id="accessing-other-browsing-contexts:browsing-context-container">browsing context container</a>'s <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="accessing-other-browsing-contexts:nested-browsing-context">nested browsing context</a> being last.</p>

  <p>These properties are the <dfn id="dynamic-nested-browsing-context-properties">dynamic nested browsing context properties</dfn>.</p></section>

  



  <section><h4 id="named-access-on-the-window-object">6.2.4 Named access on the <code id="named-access-on-the-window-object:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object</h4>

  <dl class="domintro"><dt><var>window</var>[<var>name</var>]</dt><dd>

    <p>Returns the indicated element or collection of elements.</p>

    <p>As a general rule, relying on this will lead to brittle code. Which IDs end up mapping to
    this API can vary over time, as new features are added to the Web platform, for example. Instead
    of this, use <code>document.getElementById()</code> or <code>document.querySelector()</code>.</p>

   </dd></dl>

  

  <p>The <code id="named-access-on-the-window-object:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> interface <a href="/breakup/specs/core-algorithms/#support-named-properties" id="named-access-on-the-window-object:support-named-properties">supports named
  properties</a>. The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="named-access-on-the-window-object:supported-property-names">supported property names</a> at any moment consist of the
  following, in <a href="/breakup/specs/core-algorithms/#tree-order" id="named-access-on-the-window-object:tree-order">tree order</a>, ignoring later duplicates:</p>

  <ul><li>the <a href="/breakup/specs/browser-dom/#browsing-context-name" id="named-access-on-the-window-object:browsing-context-name">browsing context name</a> of any <a href="/breakup/specs/browser-dom/#child-browsing-context" id="named-access-on-the-window-object:child-browsing-context">child browsing context</a> of the
   <a href="/breakup/specs/browser-dom/#active-document" id="named-access-on-the-window-object:active-document">active document</a> whose name is not the empty string,</li><li>the value of the <code>name</code> content attribute for all <code id="named-access-on-the-window-object:the-a-element"><a href="#the-a-element">a</a></code>,
   <code id="named-access-on-the-window-object:the-applet-element"><a href="#the-applet-element">applet</a></code>, <code id="named-access-on-the-window-object:the-area-element"><a href="#the-area-element">area</a></code>, <code id="named-access-on-the-window-object:the-embed-element"><a href="#the-embed-element">embed</a></code>, <code id="named-access-on-the-window-object:the-form-element"><a href="#the-form-element">form</a></code>,
   <code id="named-access-on-the-window-object:frameset"><a href="#frameset">frameset</a></code>, <code id="named-access-on-the-window-object:the-img-element"><a href="#the-img-element">img</a></code>, and <code id="named-access-on-the-window-object:the-object-element"><a href="#the-object-element">object</a></code> elements in the <a href="/breakup/specs/browser-dom/#active-document" id="named-access-on-the-window-object:active-document-2">active
   document</a> that have a non-empty <code>name</code> content attribute, and</li><li>the value of the <code id="named-access-on-the-window-object:the-id-attribute"><a href="#the-id-attribute">id</a></code> content attribute of any <a href="/breakup/specs/core-algorithms/#html-elements" id="named-access-on-the-window-object:html-elements">HTML element</a> in the <a href="/breakup/specs/browser-dom/#active-document" id="named-access-on-the-window-object:active-document-3">active document</a> with a non-empty <code id="named-access-on-the-window-object:the-id-attribute-2"><a href="#the-id-attribute">id</a></code> content attribute.</li></ul>

  <p>To <a href="/breakup/specs/core-algorithms/#determine-the-value-of-a-named-property" id="named-access-on-the-window-object:determine-the-value-of-a-named-property">determine the value of a named property</a> <var>name</var> when <dfn id="dom-window-nameditem">the <code>Window</code> object is indexed for property
  retrieval</dfn>, the user agent must return the value obtained using the following steps:</p>

  <ol><li>

    <p>Let <var>objects</var> be the list of <a href="/breakup/specs/browser-dom/#dom-window-nameditem-filter" id="named-access-on-the-window-object:dom-window-nameditem-filter">named objects</a> with the name <var>name</var>
    in the <a href="/breakup/specs/browser-dom/#active-document" id="named-access-on-the-window-object:active-document-4">active document</a>.

    </p><p class="note">There will be at least one such object, by definition.</p>

   </li><li>

    <p>If <var>objects</var> contains a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="named-access-on-the-window-object:nested-browsing-context">nested browsing context</a>, then return
    the <code id="named-access-on-the-window-object:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object of the <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="named-access-on-the-window-object:nested-browsing-context-2">nested browsing context</a> corresponding to
    the first <a href="/breakup/specs/browser-dom/#browsing-context-container" id="named-access-on-the-window-object:browsing-context-container">browsing context container</a> in <a href="/breakup/specs/core-algorithms/#tree-order" id="named-access-on-the-window-object:tree-order-2">tree order</a> whose
    <a href="/breakup/specs/browser-dom/#browsing-context" id="named-access-on-the-window-object:browsing-context">browsing context</a> is in <var>objects</var>, and abort these steps.</p>

   </li><li>

    <p>Otherwise, if <var>objects</var> has only one element, return that element and
    abort these steps.</p>

   </li><li>

    <p>Otherwise return an <code id="named-access-on-the-window-object:htmlcollection"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> rooted at the <code id="named-access-on-the-window-object:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node,
    whose filter matches only <a href="/breakup/specs/browser-dom/#dom-window-nameditem-filter" id="named-access-on-the-window-object:dom-window-nameditem-filter-2">named objects</a> with
    the name <var>name</var>. (By definition, these will all be elements.)</p> 

   </li></ol>

  <p><dfn id="dom-window-nameditem-filter">Named objects</dfn> with the name <var>name</var>, for the purposes of the above algorithm, are those that are either:</p>

  <ul><li><a href="/breakup/specs/browser-dom/#child-browsing-context" id="named-access-on-the-window-object:child-browsing-context-2">child browsing contexts</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="named-access-on-the-window-object:active-document-5">active
   document</a> whose name is <var>name</var>,</li><li><code id="named-access-on-the-window-object:the-a-element-2"><a href="#the-a-element">a</a></code>, <code id="named-access-on-the-window-object:the-applet-element-2"><a href="#the-applet-element">applet</a></code>, <code id="named-access-on-the-window-object:the-area-element-2"><a href="#the-area-element">area</a></code>, <code id="named-access-on-the-window-object:the-embed-element-2"><a href="#the-embed-element">embed</a></code>,
   <code id="named-access-on-the-window-object:the-form-element-2"><a href="#the-form-element">form</a></code>, <code id="named-access-on-the-window-object:frameset-2"><a href="#frameset">frameset</a></code>, <code id="named-access-on-the-window-object:the-img-element-2"><a href="#the-img-element">img</a></code>, or <code id="named-access-on-the-window-object:the-object-element-2"><a href="#the-object-element">object</a></code> elements that
   have a <code>name</code> content attribute whose value is <var>name</var>, or</li><li><a href="/breakup/specs/core-algorithms/#html-elements" id="named-access-on-the-window-object:html-elements-2">HTML elements</a> that have an <code id="named-access-on-the-window-object:the-id-attribute-3"><a href="#the-id-attribute">id</a></code> content attribute
   whose value is <var>name</var>.</li></ul></section>

  


  

  <section><h4 id="garbage-collection-and-browsing-contexts">6.2.5 Garbage collection and browsing contexts</h4>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context">browsing context</a> has a strong reference to each of its <code id="garbage-collection-and-browsing-contexts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s
  and its <code id="garbage-collection-and-browsing-contexts:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object, and the user agent itself has a strong reference to its
  <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="garbage-collection-and-browsing-contexts:top-level-browsing-context">top-level browsing contexts</a>.</p>

  <p>A <code id="garbage-collection-and-browsing-contexts:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has a strong reference to its <code id="garbage-collection-and-browsing-contexts:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object.</p>

  <p class="note">A <code id="garbage-collection-and-browsing-contexts:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object <a href="/breakup/specs/core-algorithms/#implied-strong-reference" id="garbage-collection-and-browsing-contexts:implied-strong-reference">has a strong
  reference</a> to its <code id="garbage-collection-and-browsing-contexts:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object through its <code id="garbage-collection-and-browsing-contexts:dom-document-2"><a href="/breakup/specs/browser-dom/#dom-document-2">document</a></code> attribute. Thus, references from other scripts to either of
  those objects will keep both alive. Similarly, both <code id="garbage-collection-and-browsing-contexts:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> and <code id="garbage-collection-and-browsing-contexts:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  objects have <a href="/breakup/specs/core-algorithms/#implied-strong-reference" id="garbage-collection-and-browsing-contexts:implied-strong-reference-2">implied strong references</a> to the
  <code id="garbage-collection-and-browsing-contexts:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#concept-script" id="garbage-collection-and-browsing-contexts:concept-script">script</a> has a strong reference to its <a href="/breakup/specs/browser-dom/#settings-object" id="garbage-collection-and-browsing-contexts:settings-object">settings
  object</a>, and each <a href="/breakup/specs/browser-dom/#environment-settings-object" id="garbage-collection-and-browsing-contexts:environment-settings-object">environment settings object</a> has strong references to its
  <a href="/breakup/specs/browser-dom/#global-object" id="garbage-collection-and-browsing-contexts:global-object">global object</a>, <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="garbage-collection-and-browsing-contexts:responsible-browsing-context">responsible browsing context</a>, and <a href="/breakup/specs/browser-dom/#responsible-document" id="garbage-collection-and-browsing-contexts:responsible-document">responsible
  document</a> (if any).</p>

  
  <p>When a <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context-2">browsing context</a> is to <dfn id="discard-a-document">discard a <code>Document</code></dfn>, the user
  agent must run the following steps:</p>

  <ol><li><p>Set the <code id="garbage-collection-and-browsing-contexts:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <i id="garbage-collection-and-browsing-contexts:concept-document-salvageable"><a href="#concept-document-salvageable">salvageable</a></i> state to false.</p></li><li><p>Run any <a href="#unloading-document-cleanup-steps" id="garbage-collection-and-browsing-contexts:unloading-document-cleanup-steps">unloading document cleanup steps</a> for the <code id="garbage-collection-and-browsing-contexts:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that
   are defined by this specification and <a href="/breakup/specs/core-algorithms/#other-applicable-specifications" id="garbage-collection-and-browsing-contexts:other-applicable-specifications">other applicable specifications</a>.</p></li><li><p><a href="#abort-a-document" id="garbage-collection-and-browsing-contexts:abort-a-document">Abort the <code>Document</code></a>.</p></li><li><p>Remove any <a href="/breakup/specs/browser-dom/#concept-task" id="garbage-collection-and-browsing-contexts:concept-task">tasks</a> associated with the
   <code id="garbage-collection-and-browsing-contexts:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in any <a href="/breakup/specs/browser-dom/#task-source" id="garbage-collection-and-browsing-contexts:task-source">task source</a>, without running those tasks.</p></li><li><p><a href="/breakup/specs/browser-dom/#a-browsing-context-is-discarded" id="garbage-collection-and-browsing-contexts:a-browsing-context-is-discarded">Discard</a> all the <a href="/breakup/specs/browser-dom/#child-browsing-context" id="garbage-collection-and-browsing-contexts:child-browsing-context">child browsing contexts</a> of the <code id="garbage-collection-and-browsing-contexts:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p></li><li><p>Lose the strong reference from the <code id="garbage-collection-and-browsing-contexts:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context-3">browsing context</a>
   to the <code id="garbage-collection-and-browsing-contexts:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p></li></ol>

  <p class="note">Whenever a <code id="garbage-collection-and-browsing-contexts:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is <a href="/breakup/specs/browser-dom/#discard-a-document" id="garbage-collection-and-browsing-contexts:discard-a-document">discarded</a>, it is also removed from the list of <a href="http://www.w3.org/TR/workers/#the-worker's-documents" id="garbage-collection-and-browsing-contexts:the-worker's-documents">the worker's
  <code>Document</code>s</a> of each worker whose list contains that <code id="garbage-collection-and-browsing-contexts:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  <p>When <dfn id="a-browsing-context-is-discarded">a <em>browsing context</em> is discarded</dfn>, the strong reference from the user
  agent itself to the <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context-4">browsing context</a> must be severed, and all the
  <code id="garbage-collection-and-browsing-contexts:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects for all the entries in the <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context-5">browsing context</a>'s session
  history must be <a href="/breakup/specs/browser-dom/#discard-a-document" id="garbage-collection-and-browsing-contexts:discard-a-document-2">discarded</a> as well.</p>

  <p>User agents may <a href="/breakup/specs/browser-dom/#a-browsing-context-is-discarded" id="garbage-collection-and-browsing-contexts:a-browsing-context-is-discarded-2">discard</a> <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="garbage-collection-and-browsing-contexts:top-level-browsing-context-2">top-level browsing contexts</a> at any time (typically, in
  response to user requests, e.g. when a user force-closes a window containing one or more <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="garbage-collection-and-browsing-contexts:top-level-browsing-context-3">top-level browsing contexts</a>). Other <a href="/breakup/specs/browser-dom/#browsing-context" id="garbage-collection-and-browsing-contexts:browsing-context-6">browsing contexts</a> must be discarded once their
  <code id="garbage-collection-and-browsing-contexts:windowproxy-3"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object is eligible for garbage collection.</p></section>

  


  <section><h4 id="closing-browsing-contexts">6.2.6 Closing browsing contexts</h4>

  <p>When the user agent is required to <dfn id="close-a-browsing-context">close a browsing context</dfn>, it must run the
  following steps:</p>

  <ol><li><p>Let <var>specified browsing context</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="closing-browsing-contexts:browsing-context">browsing context</a>
   being closed.</p></li><li><p><a href="#prompt-to-unload-a-document" id="closing-browsing-contexts:prompt-to-unload-a-document">Prompt to unload</a> the <a href="/breakup/specs/browser-dom/#active-document" id="closing-browsing-contexts:active-document">active
   document</a> of the <var>specified browsing context</var>. If the user <a href="#refused-to-allow-the-document-to-be-unloaded" id="closing-browsing-contexts:refused-to-allow-the-document-to-be-unloaded">refused
   to allow the document to be unloaded</a>, then abort these steps.</p></li><li><p><a href="#unload-a-document" id="closing-browsing-contexts:unload-a-document">Unload</a> the <a href="/breakup/specs/browser-dom/#active-document" id="closing-browsing-contexts:active-document-2">active document</a> of the <var>specified browsing context</var> with the <var>recycle</var> parameter set to
   false.</p></li><li><p>Remove the <var>specified browsing context</var> from the user interface (e.g.
   close or hide its tab in a tabbed browser).</p></li><li><p><a href="/breakup/specs/browser-dom/#a-browsing-context-is-discarded" id="closing-browsing-contexts:a-browsing-context-is-discarded">Discard</a> the <var>specified
   browsing context</var>.</p></li></ol>

  <p>User agents should offer users the ability to arbitrarily <a href="/breakup/specs/browser-dom/#close-a-browsing-context" id="closing-browsing-contexts:close-a-browsing-context">close</a> any <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="closing-browsing-contexts:top-level-browsing-context">top-level browsing context</a>.</p></section>



  <section><h4 id="browser-interface-elements">6.2.7 Browser interface elements</h4>

  <p>To allow Web pages to integrate with Web browsers, certain Web browser interface elements are
  exposed in a limited way to scripts in Web pages.</p>

  <p>Each interface element is represented by a <code id="browser-interface-elements:barprop"><a href="/breakup/specs/browser-dom/#barprop">BarProp</a></code> object:</p>

  <pre class="idl">interface <dfn id="barprop">BarProp</dfn> {
  attribute boolean <a href="/breakup/specs/browser-dom/#dom-barprop-visible" id="browser-interface-elements:dom-barprop-visible">visible</a>;
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="browser-interface-elements:dom-window-locationbar"><a href="/breakup/specs/browser-dom/#dom-window-locationbar">locationbar</a></code> . <code id="browser-interface-elements:dom-barprop-visible-2"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the location bar is visible; otherwise, returns false.</p>
   </dd><dt><var>window</var> . <code id="browser-interface-elements:dom-window-menubar"><a href="/breakup/specs/browser-dom/#dom-window-menubar">menubar</a></code> . <code id="browser-interface-elements:dom-barprop-visible-3"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the menu bar is visible; otherwise, returns false.</p>
   </dd><dt><var>window</var> . <code id="browser-interface-elements:dom-window-personalbar"><a href="/breakup/specs/browser-dom/#dom-window-personalbar">personalbar</a></code> . <code id="browser-interface-elements:dom-barprop-visible-4"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the personal bar is visible; otherwise, returns false.</p>
   </dd><dt><var>window</var> . <code id="browser-interface-elements:dom-window-scrollbars"><a href="/breakup/specs/browser-dom/#dom-window-scrollbars">scrollbars</a></code> . <code id="browser-interface-elements:dom-barprop-visible-5"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the scroll bars are visible; otherwise, returns false.</p>
   </dd><dt><var>window</var> . <code id="browser-interface-elements:dom-window-statusbar"><a href="/breakup/specs/browser-dom/#dom-window-statusbar">statusbar</a></code> . <code id="browser-interface-elements:dom-barprop-visible-6"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the status bar is visible; otherwise, returns false.</p>
   </dd><dt><var>window</var> . <code id="browser-interface-elements:dom-window-toolbar"><a href="/breakup/specs/browser-dom/#dom-window-toolbar">toolbar</a></code> . <code id="browser-interface-elements:dom-barprop-visible-7"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code></dt><dd>
    <p>Returns true if the toolbar is visible; otherwise, returns false.</p>
   </dd></dl>

  

  <p>The <dfn id="dom-barprop-visible">visible</dfn> attribute, on getting, must return either
  true or a value determined by the user agent to most accurately represent the visibility state of
  the user interface element that the object represents, as described below. On setting, the new
  value must be discarded.</p>

  <p>The following <code id="browser-interface-elements:barprop-2"><a href="/breakup/specs/browser-dom/#barprop">BarProp</a></code> objects exist for each <code id="browser-interface-elements:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object in a
  <a href="/breakup/specs/browser-dom/#browsing-context" id="browser-interface-elements:browsing-context">browsing context</a>. Some of the user interface elements represented by these objects
  might have no equivalent in some user agents; for those user agents, except when otherwise
  specified, the object must act as if it was present and visible (i.e. its <code id="browser-interface-elements:dom-barprop-visible-8"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code> attribute must return true).</p>

  <dl><dt><dfn id="the-location-bar-barprop-object">The location bar <code>BarProp</code> object</dfn></dt><dd>Represents the user interface element that contains a control that displays the
   <a href="/breakup/specs/core-algorithms/#url" id="browser-interface-elements:url">URL</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="browser-interface-elements:active-document">active document</a>, or some similar interface concept.</dd><dt><dfn id="the-menu-bar-barprop-object">The menu bar <code>BarProp</code> object</dfn></dt><dd>Represents the user interface element that contains a list of commands in menu form, or some
   similar interface concept.</dd><dt><dfn id="the-personal-bar-barprop-object">The personal bar <code>BarProp</code> object</dfn></dt><dd>Represents the user interface element that contains links to the user's favorite pages, or
   some similar interface concept.</dd><dt><dfn id="the-scrollbar-barprop-object">The scrollbar <code>BarProp</code> object</dfn></dt><dd>Represents the user interface element that contains a scrolling mechanism, or some similar
   interface concept.</dd><dt><dfn id="the-status-bar-barprop-object">The status bar <code>BarProp</code> object</dfn></dt><dd>Represents a user interface element found immediately below or after the document, as
   appropriate for the user's media, which typically provides information about ongoing network
   activity or information about elements that the user's pointing device is current indicating. If
   the user agent has no such user interface element, then the object may act as if the
   corresponding user interface element was absent (i.e. its <code id="browser-interface-elements:dom-barprop-visible-9"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code> attribute may return false).</dd><dt><dfn id="the-toolbar-barprop-object">The toolbar <code>BarProp</code> object</dfn></dt><dd>Represents the user interface element found immediately above or before the document, as
   appropriate for the user's media, which typically provides <a href="/breakup/specs/browser-dom/#session-history" id="browser-interface-elements:session-history">session history</a> traversal
   controls (back and forward buttons, reload buttons, etc). If the user agent has no such user
   interface element, then the object may act as if the corresponding user interface element was
   absent (i.e. its <code id="browser-interface-elements:dom-barprop-visible-10"><a href="/breakup/specs/browser-dom/#dom-barprop-visible">visible</a></code> attribute may return
   false).</dd></dl>

  <p>The <dfn id="dom-window-locationbar"><code>locationbar</code></dfn> attribute must return
  <a href="/breakup/specs/browser-dom/#the-location-bar-barprop-object" id="browser-interface-elements:the-location-bar-barprop-object">the location bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id="dom-window-menubar"><code>menubar</code></dfn> attribute must return <a href="/breakup/specs/browser-dom/#the-menu-bar-barprop-object" id="browser-interface-elements:the-menu-bar-barprop-object">the
  menu bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id="dom-window-personalbar"><code>personalbar</code></dfn> attribute must return
  <a href="/breakup/specs/browser-dom/#the-personal-bar-barprop-object" id="browser-interface-elements:the-personal-bar-barprop-object">the personal bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id="dom-window-scrollbars"><code>scrollbars</code></dfn> attribute must return
  <a href="/breakup/specs/browser-dom/#the-scrollbar-barprop-object" id="browser-interface-elements:the-scrollbar-barprop-object">the scrollbar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id="dom-window-statusbar"><code>statusbar</code></dfn> attribute must return
  <a href="/breakup/specs/browser-dom/#the-status-bar-barprop-object" id="browser-interface-elements:the-status-bar-barprop-object">the status bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id="dom-window-toolbar"><code>toolbar</code></dfn> attribute must return <a href="/breakup/specs/browser-dom/#the-toolbar-barprop-object" id="browser-interface-elements:the-toolbar-barprop-object">the
  toolbar <code>BarProp</code> object</a>.</p>



  <hr>

  <p>For historical reasons, the <dfn id="dom-window-status"><code>status</code></dfn> attribute
  on the <code id="browser-interface-elements:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object must, on getting, return the last string it was set to, and on
  setting, must set itself to the new value. When the <code id="browser-interface-elements:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object is created, the
  attribute must be set to the empty string. It does not do anything else.</p></section>

  


  

  <section><h4 id="the-windowproxy-object">6.2.8 The <code id="the-windowproxy-object:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object</h4>

  <p>As mentioned earlier, each <a href="/breakup/specs/browser-dom/#browsing-context" id="the-windowproxy-object:browsing-context">browsing context</a> has a
  <dfn id="windowproxy"><code>WindowProxy</code></dfn> object. This object is unusual in that all operations that
  would be performed on it must be performed on the <code id="the-windowproxy-object:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-windowproxy-object:browsing-context-2">browsing
  context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-windowproxy-object:active-document">active document</a> instead. It is thus indistinguishable from that
  <code id="the-windowproxy-object:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object in every way until the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-windowproxy-object:browsing-context-3">browsing context</a> is navigated.</p>

  <p>There is no <code id="the-windowproxy-object:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> interface object.</p>

  <p class="note">The <code id="the-windowproxy-object:windowproxy-3"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object allows scripts to act as if each
  <a href="/breakup/specs/browser-dom/#browsing-context" id="the-windowproxy-object:browsing-context-4">browsing context</a> had a single <code id="the-windowproxy-object:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, while still keeping
  separate <code id="the-windowproxy-object:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects for each <code id="the-windowproxy-object:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  <div class="example">

   <p>In the following example, the variable <var>x</var> is set to the
   <code id="the-windowproxy-object:windowproxy-4"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object returned by the <code id="the-windowproxy-object:dom-window"><a href="/breakup/specs/browser-dom/#dom-window">window</a></code> accessor
   on the global object. All of the expressions following the assignment return true, because in
   every respect, the <code id="the-windowproxy-object:windowproxy-5"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object acts like the underlying <code id="the-windowproxy-object:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
   object.</p>

   <pre>var x = window;
x instanceof Window; // true
x === this; // true</pre>

  </div></section></section><section><h3 id="origin">6.3 Origin</h3>
  

  <p>Origins are the fundamental currency of the Web's security model. Two actors in the Web
  platform that share an origin are assumed to trust each other and to have the same authority.
  Actors with differing origins are considered potentially hostile versus each other, and are
  isolated from each other to varying degrees.</p>

  <p class="example">For example, if Example Bank's Web site, hosted at <code>bank.example.com</code>, tries to examine the DOM of Example Charity's Web site, hosted
  at <code>charity.example.org</code>, a <code id="origin:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception will be
  raised.</p>

  <hr>

  <p>The <dfn id="origin-2">origin</dfn> of a resource and the <dfn id="effective-script-origin">effective script origin</dfn> of a resource
  are each one of the following:</p>

  <dl><dt>Opaque identifiers

   </dt><dd>

    <p>Internal values, with no serialisation, for which the only meaningful operation is testing
    for equality.</p>


   </dd><dt>Tuples

   </dt><dd>

    <p>Tuples consisting of a scheme component, a host component, a port component, and optionally
    extra data.</p>

    <p class="note">The extra data could include the certificate of the site when using encrypted
    connections, to ensure that if the site's secure certificate changes, the origin is considered to
    change as well.</p>


   </dd><dt>Aliases

   </dt><dd>

    <p>A reference to another <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2">origin</a> or <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin">effective script origin</a>.</p>


  </dd></dl>

  

  <p>An <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-2">origin</a> or <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-2">effective script origin</a> can be defined as an <dfn id="concept-origin-alias">alias</dfn> to another <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-3">origin</a> or <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-3">effective script
  origin</a>. The value of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-4">origin</a> or <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-4">effective script origin</a> is
  then the value of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-5">origin</a> or <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-5">effective script origin</a> to which it is
  an alias.</p>

  <p>These characteristics are defined as follows:</p>

  <dl><dt>For URLs</dt><dd>

    <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-6">origin</a> and <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-6">effective script origin</a> of the <a href="/breakup/specs/core-algorithms/#url" id="origin:url">URL</a> are
    the <a href="https://url.spec.whatwg.org/#concept-url-origin" id="origin:concept-url-origin" data-x-internal="concept-url-origin">URL origin</a> defined in the WHATWG URL standard. <a href="#refsURL">[URL]</a></p>

   </dd><dt>For <code id="origin:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects</dt><dd>

    <dl class="switch"><dt id="sandboxOrigin">If a <code id="origin:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="origin:active-sandboxing-flag-set">active sandboxing flag set</a> has
     its <a href="/breakup/specs/browser-dom/#sandboxed-origin-browsing-context-flag" id="origin:sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a> set</dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-7">origin</a> is a globally unique identifier assigned when the
      <code id="origin:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created.</p>

      <p>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-7">effective script origin</a> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-8">origin</a> of the
      <code id="origin:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

     </dd><dt>If a <code id="origin:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> was served over the network and has an address that uses a URL
     scheme with a server-based naming authority</dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-9">origin</a> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-2">alias</a> to the
      <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-10">origin</a> of <a id="origin:the-document's-address" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the <code>Document</code>'s address</a>.</p>

      <p>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-8">effective script origin</a> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-3">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-11">origin</a> of the
      <code id="origin:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

     </dd><dt>If a <code id="origin:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> was generated from a <a href="http://tools.ietf.org/html/rfc2397#section-2" id="origin:data-protocol" data-x-internal="data-protocol"><code>data:</code> URL</a> found in another <code id="origin:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> or in a
     script</dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-12">origin</a> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-4">alias</a> to the
      <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-13">origin</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="origin:incumbent-settings-object">incumbent settings object</a> when the <a href="#navigate" id="origin:navigate">navigate</a>
      algorithm was invoked, or, if no <a href="/breakup/specs/browser-dom/#concept-script" id="origin:concept-script">script</a> was involved, of
      the <a id="origin:node-document" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a> of the element that initiated the <a href="#navigate" id="origin:navigate-2">navigation</a> to that <a href="/breakup/specs/core-algorithms/#url" id="origin:url-2">URL</a>.</p>

      <p>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-9">effective script origin</a> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-5">alias</a> to the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-10">effective script origin</a> of that
      same <a href="/breakup/specs/browser-dom/#environment-settings-object" id="origin:environment-settings-object">environment settings object</a> or <code id="origin:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

     </dd><dt>If a <code id="origin:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is the initial "<code id="origin:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code>" document</dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-14">origin</a> and <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-11">effective script origin</a> of the
      <code id="origin:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> are <a href="/breakup/specs/browser-dom/#about-blank-origin">those it was assigned when its
      browsing context was created</a>.</p>

     </dd><dt>If a <code id="origin:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> was created as part of the processing for <a href="#javascript-protocol" id="origin:javascript-protocol"><code>javascript:</code> URLs</a></dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-15">origin</a> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-6">alias</a> to the
      <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-16">origin</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="origin:active-document">active document</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="origin:browsing-context">browsing context</a>
      being navigated when the <a href="#navigate" id="origin:navigate-3">navigate</a> algorithm was invoked.</p>

      <p>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-12">effective script origin</a> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-7">alias</a> to the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-13">effective script origin</a> of that
      same <code id="origin:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

     </dd><dt>If a <code id="origin:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is <a href="#an-iframe-srcdoc-document" id="origin:an-iframe-srcdoc-document">an <code>iframe</code> <code>srcdoc</code> document</a></dt><dd>

      <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-17">origin</a> of the <code id="origin:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-8">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-18">origin</a> of the
      <code id="origin:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="origin:browsing-context-2">browsing context</a>'s <a href="/breakup/specs/browser-dom/#browsing-context-container" id="origin:browsing-context-container">browsing context
      container</a>'s <a id="origin:node-document-2" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</p>

      <p>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-14">effective script origin</a> is initially an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-9">alias</a> to the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-15">effective script origin</a> of the
      <code id="origin:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="origin:browsing-context-3">browsing context</a>'s <a href="/breakup/specs/browser-dom/#browsing-context-container" id="origin:browsing-context-container-2">browsing context
      container</a>'s <a id="origin:node-document-3" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</p>

     </dd><dt>If a <code id="origin:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code> was obtained in some other manner (e.g. a <a href="http://tools.ietf.org/html/rfc2397#section-2" id="origin:data-protocol-2" data-x-internal="data-protocol"><code>data:</code> URL</a> typed in by the user or that was returned as the
     location of an HTTP redirect (<a href="/breakup/specs/core-algorithms/#concept-http-equivalent-codes" id="origin:concept-http-equivalent-codes">or equivalent</a>
     in other protocols), a <code id="origin:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> created using the <code id="origin:dom-domimplementation-createdocument"><a href="/breakup/specs/core-algorithms/#dom-domimplementation-createdocument">createDocument()</a></code> API, etc)</dt><dd>

      <p>The default behaviour as defined in the DOM standard applies. <a href="#refsDOM">[DOM]</a>.</p>

      <p class="note">The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-19">origin</a> is a globally unique identifier assigned when the
      <code id="origin:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, and the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-16">effective script origin</a> is initially an
      <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-10">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-20">origin</a> of the
      <code id="origin:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

     </dd></dl>

    <p class="note">The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-17">effective script origin</a> of a <code id="origin:document-22"><a href="/breakup/specs/browser-dom/#document">Document</a></code> can be
    manipulated using the <code id="origin:dom-document-domain"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code> IDL
    attribute.</p>

   </dd><dt>For images of <code id="origin:the-img-element"><a href="#the-img-element">img</a></code> elements</dt><dd>

    <dl class="switch"><dt>If the image data is <a href="/breakup/specs/core-algorithms/#cors-cross-origin" id="origin:cors-cross-origin">CORS-cross-origin</a></dt><dd>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-21">origin</a> is a globally unique identifier assigned when the image is
     created.</dd><dt>If the image data is <a href="/breakup/specs/core-algorithms/#cors-same-origin" id="origin:cors-same-origin">CORS-same-origin</a></dt><dd>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-22">origin</a> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-11">alias</a> to the
     <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-23">origin</a> of the <code id="origin:the-img-element-2"><a href="#the-img-element">img</a></code> element's <a id="origin:node-document-4" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</dd></dl>

    <p>Images do not have an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-18">effective script origin</a>.</p>

   </dd><dt>For <code id="origin:the-audio-element"><a href="#the-audio-element">audio</a></code> and <code id="origin:the-video-element"><a href="#the-video-element">video</a></code> elements</dt><dd>

    <dl class="switch"><dt>If the <a href="#media-data" id="origin:media-data">media data</a> is <a href="/breakup/specs/core-algorithms/#cors-cross-origin" id="origin:cors-cross-origin-2">CORS-cross-origin</a></dt><dd>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-24">origin</a> is a globally unique identifier assigned when the <a href="#media-data" id="origin:media-data-2">media
     data</a> is <a href="/breakup/specs/core-algorithms/#fetch" id="origin:fetch">fetched</a>.</dd><dt>If the <a href="#media-data" id="origin:media-data-3">media data</a> is <a href="/breakup/specs/core-algorithms/#cors-same-origin" id="origin:cors-same-origin-2">CORS-same-origin</a></dt><dd>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-25">origin</a> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-12">alias</a> to the
     <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-26">origin</a> of the <a href="#media-element" id="origin:media-element">media element</a>'s <a id="origin:node-document-5" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</dd></dl>

    <p><a href="#media-element" id="origin:media-element-2">Media elements</a> do not have an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-19">effective script
    origin</a>.</p>

   </dd><dt>For fonts</dt><dd>

    <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-27">origin</a> of a downloadable Web font is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-13">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-28">origin</a> of the <a href="/breakup/specs/core-algorithms/#absolute-url" id="origin:absolute-url">absolute
    URL</a> used to obtain the font (after any redirects). <a href="#refsCSSFONTS">[CSSFONTS]</a>
    <a href="#refsCSSFONTLOAD">[CSSFONTLOAD]</a></p> 

    <p>The <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-29">origin</a> of a locally installed system font is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="origin:concept-origin-alias-14">alias</a> to the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-30">origin</a> of the
    <code id="origin:document-23"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in which that font is being used.</p>

    <p>Fonts do not have an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="origin:effective-script-origin-20">effective script origin</a>.</p>

   </dd></dl>

  <p>Other specifications can override the above definitions by themselves specifying the origin of
  a particular <a href="/breakup/specs/core-algorithms/#url" id="origin:url-3">URL</a>, <code id="origin:document-24"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, image, <a href="#media-element" id="origin:media-element-3">media element</a>, or
  font.</p>

  

  <hr>

  <p>The <dfn id="unicode-serialisation-of-an-origin">Unicode serialisation of an origin</dfn> is the string obtained by applying the
  following algorithm to the given <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-31">origin</a>:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-32">origin</a> in question is not a scheme/host/port tuple, then return the
   literal string "<code>null</code>" and abort these steps.</p></li><li><p>Otherwise, let <var>result</var> be the scheme part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-33">origin</a>
   tuple.</p></li><li><p>Append the string "<code>://</code>" to <var>result</var>.</p></li><li><p>Apply the <a href="/breakup/specs/core-algorithms/#domain-to-unicode" id="origin:domain-to-unicode">domain to Unicode</a> algorithm to each component of the host
   part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-34">origin</a> tuple, and append the results  each component, in the same
   order, separated by U+002E FULL STOP characters (.)  to <var>result</var>. <a href="#refsURL">[URL]</a></p></li><li><p>If the port part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-35">origin</a> tuple gives a port that is different from the
   default port for the protocol given by the scheme part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-36">origin</a> tuple, then
   append a U+003A COLON character (:) and the given port, in base ten, to <var>result</var>.</p></li><li><p>Return <var>result</var>.</p></li></ol>


  <p>The <dfn id="ascii-serialisation-of-an-origin">ASCII serialisation of an origin</dfn> is the string obtained by applying the
  following algorithm to the given <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-37">origin</a>:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-38">origin</a> in question is not a scheme/host/port tuple, then return the
   literal string "<code>null</code>" and abort these steps.</p></li><li><p>Otherwise, let <var>result</var> be the scheme part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-39">origin</a>
   tuple.</p></li><li><p>Append the string "<code>://</code>" to <var>result</var>.</p></li><li>

    <p>Apply the <a href="/breakup/specs/core-algorithms/#domain-to-ascii" id="origin:domain-to-ascii">domain to ASCII</a> algorithm to each component of the host part of
    the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-40">origin</a> tuple, and append the results  each component, in the same order,
    separated by U+002E FULL STOP characters (.)  to <var>result</var>. <a href="#refsURL">[URL]</a></p>

    <p>If the <a href="/breakup/specs/core-algorithms/#domain-to-ascii" id="origin:domain-to-ascii-2">domain to ASCII</a> algorithm returns failure, e.g. because a component is too long or because it contains
    invalid characters, then throw a <code id="origin:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p>

   </li><li><p>If the port part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-41">origin</a> tuple gives a port that is different from the
   default port for the protocol given by the scheme part of the <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-42">origin</a> tuple, then
   append a U+003A COLON character (:) and the given port, in base ten, to <var>result</var>.</p></li><li><p>Return <var>result</var>.</p></li></ol>


  <p>Two <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-43">origins</a> are said to be the <dfn id="same-origin">same origin</dfn> if the
  following algorithm returns true:</p>

  <ol><li><p>Let <var>A</var> be the first <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-44">origin</a> being compared, and <var>B</var> be the second <a href="/breakup/specs/browser-dom/#origin-2" id="origin:origin-2-45">origin</a> being compared.</p></li><li><p>If <var>A</var> and <var>B</var> are both opaque identifiers, and their
   value is equal, then return true.</p></li><li><p>Otherwise, if either <var>A</var> or <var>B</var> or both are opaque
   identifiers, return false.</p></li><li><p>If <var>A</var> and <var>B</var> have scheme components that are not
   identical, return false.</p></li><li><p>If <var>A</var> and <var>B</var> have host components that are not
   identical, return false.</p></li><li><p>If <var>A</var> and <var>B</var> have port components that are not
   identical, return false.</p></li><li><p>If either <var>A</var> or <var>B</var> have additional data, but that
   data is not identical for both, return false.</p></li><li><p>Return true.</p></li></ol>

  


  <section><h4 id="relaxing-the-same-origin-restriction">6.3.1 Relaxing the same-origin restriction</h4>

  <dl class="domintro"><dt><var>document</var> . <code id="relaxing-the-same-origin-restriction:dom-document-domain"><a href="/breakup/specs/browser-dom/#dom-document-domain">domain</a></code> [ = <var>domain</var> ]</dt><dd>

    <p>Returns the current domain used for security checks.</p>

    <p>Can be set to a value that removes subdomains, to change the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin">effective script
    origin</a> to allow pages on other subdomains of the same domain (if they do the same thing)
    to access each other. (Can't be set in sandboxed <code id="relaxing-the-same-origin-restriction:the-iframe-element"><a href="#the-iframe-element">iframe</a></code>s.)</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-domain"><code>domain</code></dfn> attribute on
  <code id="relaxing-the-same-origin-restriction:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects must be initialised to <a href="/breakup/specs/browser-dom/#the-document's-domain" id="relaxing-the-same-origin-restriction:the-document's-domain">the document's domain</a>, if it has
  one, and the empty string otherwise. If <a href="/breakup/specs/browser-dom/#the-document's-domain" id="relaxing-the-same-origin-restriction:the-document's-domain-2">the document's domain</a> starts with a U+005B
  LEFT SQUARE BRACKET character ([) and ends with a U+005D RIGHT SQUARE BRACKET character (]), it is
  an IPv6 address; these square brackets must be omitted when initialising the attribute's
  value.</p>

  <p>On getting, the attribute must return its current value, unless the <code id="relaxing-the-same-origin-restriction:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has
  no <a href="/breakup/specs/browser-dom/#browsing-context" id="relaxing-the-same-origin-restriction:browsing-context">browsing context</a>, in which case it must return the empty string.</p>

  <p>On setting, the user agent must run the following algorithm:</p>

  <ol><li>

    <p>If the <code id="relaxing-the-same-origin-restriction:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has no <a href="/breakup/specs/browser-dom/#browsing-context" id="relaxing-the-same-origin-restriction:browsing-context-2">browsing context</a>, throw a
    <code id="relaxing-the-same-origin-restriction:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p>

   </li><li>

    <p>If the <code id="relaxing-the-same-origin-restriction:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="relaxing-the-same-origin-restriction:active-sandboxing-flag-set">active sandboxing flag set</a> has its
    <a href="/breakup/specs/browser-dom/#sandboxed-document.domain-browsing-context-flag" id="relaxing-the-same-origin-restriction:sandboxed-document.domain-browsing-context-flag">sandboxed <code>document.domain</code> browsing context
    flag</a> set, throw a <code id="relaxing-the-same-origin-restriction:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p>

   </li><li>

    <p>If the new value is an IPv4 or IPv6 address, let <var>new value</var> be the new
    value.</p>

    <p>Otherwise, <a href="/breakup/specs/core-algorithms/#strictly-split-a-string" id="relaxing-the-same-origin-restriction:strictly-split-a-string">strictly split</a> the new value on
    U+002E FULL STOP characters (.), apply the <a href="/breakup/specs/core-algorithms/#domain-to-ascii" id="relaxing-the-same-origin-restriction:domain-to-ascii">domain to ASCII</a> algorithm to each
    returned token, and let <var>new value</var> be the result of concatenating the
    results of applying that algorithm to each token, in the same order, separated by U+002E FULL
    STOP characters (.). <a href="#refsURL">[URL]</a></p>

    <p>If the <a href="/breakup/specs/core-algorithms/#domain-to-ascii" id="relaxing-the-same-origin-restriction:domain-to-ascii-2">domain to ASCII</a> algorithm returns failure, e.g. because a component is too long or because it contains
    invalid characters, then throw a <code id="relaxing-the-same-origin-restriction:securityerror-3"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p>

   </li><li>

    <p>If <var>new value</var> is not exactly equal to the current value of the <code id="relaxing-the-same-origin-restriction:dom-document-domain-2"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code> attribute, then run these substeps:</p>

    <ol><li>

      <p>If the current value is an IPv4 or IPv6 address, throw a <code id="relaxing-the-same-origin-restriction:securityerror-4"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code>
      exception and abort these steps.</p>

     </li><li>

      <p>If <var>new value</var>, prefixed by a U+002E FULL STOP (.), does not exactly
      match the end of the current value, throw a <code id="relaxing-the-same-origin-restriction:securityerror-5"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort
      these steps.</p>

      <p class="note">If the <var>new value</var> is an IPv4 or IPv6 address, it cannot
      match the <var>new value</var> in this way and thus an exception will be thrown
      here.</p>

      

     </li><li>

      <p>If <var>new value</var> matches a suffix in the Public Suffix List, or, if <var>new value</var>, prefixed by a U+002E FULL STOP (.), matches the end of a suffix in
      the Public Suffix List, then throw a <code id="relaxing-the-same-origin-restriction:securityerror-6"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these
      steps. <a href="#refsPSL">[PSL]</a></p>

      <p>Suffixes must be compared in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="relaxing-the-same-origin-restriction:ascii-case-insensitive">ASCII case-insensitive</a> manner, after applying
      the <a href="/breakup/specs/core-algorithms/#domain-to-ascii" id="relaxing-the-same-origin-restriction:domain-to-ascii-3">domain to ASCII</a> algorithm to their individual components, . <a href="#refsURL">[URL]</a></p>

     </li></ol>

   </li><li><p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="relaxing-the-same-origin-restriction:storage-mutex">storage mutex</a>.</p></li><li>

    <p>Set the attribute's value to <var>new value</var>.</p>

   </li><li>

    <p>If the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin-2">effective script origin</a> of the <code id="relaxing-the-same-origin-restriction:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is an <a href="/breakup/specs/browser-dom/#concept-origin-alias" id="relaxing-the-same-origin-restriction:concept-origin-alias">alias</a>, set it to the value of the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin-3">effective script
    origin</a> (essentially de-aliasing the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin-4">effective script origin</a>).</p>

   </li><li>

    <p>If <var>new value</var> is not the empty string, then run these substeps:</p>

    <ol><li>

      <p>Set the host part of the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin-5">effective script origin</a> tuple of the
      <code id="relaxing-the-same-origin-restriction:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> to <var>new value</var>.</p>

     </li><li>

      <p>Set the port part of the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="relaxing-the-same-origin-restriction:effective-script-origin-6">effective script origin</a> tuple of the
      <code id="relaxing-the-same-origin-restriction:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> to "manual override" (a value that, for the purposes of <a href="/breakup/specs/browser-dom/#same-origin" id="relaxing-the-same-origin-restriction:same-origin">comparing origins</a>, is identical to "manual override" but not
      identical to any other value).</p>

     </li></ol>

   </li></ol>

  <p>The <dfn id="the-document's-domain">domain</dfn> of a <code id="relaxing-the-same-origin-restriction:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is the host part
  of the document's <a href="/breakup/specs/browser-dom/#origin-2" id="relaxing-the-same-origin-restriction:origin-2">origin</a>, if the value of that <a href="/breakup/specs/browser-dom/#origin-2" id="relaxing-the-same-origin-restriction:origin-2-2">origin</a> is a
  scheme/host/port tuple. If it isn't, then the document does not have a domain.</p>

  

  <p class="note">The <code id="relaxing-the-same-origin-restriction:dom-document-domain-3"><a href="/breakup/specs/browser-dom/#dom-document-domain">domain</a></code> attribute is used to enable
  pages on different hosts of a domain to access each others' DOMs.</p>

  <p class="warning">Do not use the <code id="relaxing-the-same-origin-restriction:dom-document-domain-4"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code>
  attribute when using shared hosting. If an untrusted third party is able to host an HTTP server at
  the same IP address but on a different port, then the same-origin protection that normally
  protects two different sites on the same host will fail, as the ports are ignored when comparing
  origins after the <code id="relaxing-the-same-origin-restriction:dom-document-domain-5"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code> attribute has been
  used.</p></section></section><section><h3 id="sandboxing">6.4 Sandboxing</h3>

  <p>A <dfn id="sandboxing-flag-set">sandboxing flag set</dfn> is a set of zero or more of the following flags, which are
  used to restrict the abilities that potentially untrusted resources have:</p>

  <dl><dt>The <dfn id="sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</dfn></dt><dd>

    <p>This flag <a href="#sandboxLinks">prevents content from navigating browsing contexts other
    than the sandboxed browsing context itself</a> (or browsing contexts further nested inside it),
    <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="sandboxing:auxiliary-browsing-context">auxiliary browsing contexts</a> (which are protected
    by the <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</a> defined next), and the
    <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="sandboxing:top-level-browsing-context">top-level browsing context</a> (which is protected by the <a href="/breakup/specs/browser-dom/#sandboxed-top-level-navigation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-browsing-context-flag">sandboxed top-level
    navigation browsing context flag</a> defined below).</p>

    <p>If the <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-2">sandboxed auxiliary navigation browsing context flag</a> is not set, then in
    certain cases the restrictions nonetheless allow popups (new <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="sandboxing:top-level-browsing-context-2">top-level browsing contexts</a>) to be opened. These <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context">browsing contexts</a> always have <dfn id="one-permitted-sandboxed-navigator">one permitted sandboxed navigator</dfn>, set
    when the browsing context is created, which allows the <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-2">browsing context</a> that
    created them to actually navigate them. (Otherwise, the <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing
    context flag</a> would prevent them from being navigated even if they were opened.)</p>

   </dd><dt>The <dfn id="sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</dfn></dt><dd>

    <p>This flag <a href="/breakup/specs/browser-dom/#sandboxWindowOpen">prevents content from creating new auxiliary browsing
    contexts</a>, e.g. using the <code id="sandboxing:attr-hyperlink-target"><a href="#attr-hyperlink-target">target</a></code> attribute, the
    <code id="sandboxing:dom-open"><a href="/breakup/specs/browser-dom/#dom-open">window.open()</a></code> method, or the <code id="sandboxing:dom-showmodaldialog"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method.</p>

   </dd><dt>The <dfn id="sandboxed-top-level-navigation-browsing-context-flag">sandboxed top-level navigation browsing context flag</dfn></dt><dd>

    <p>This flag <a href="#sandboxLinks">prevents content from navigating their <span>top-level
    browsing context</span></a> and <a href="/breakup/specs/browser-dom/#sandboxClose">prevents content from closing their
    <span>top-level browsing context</span></a>.</p>

    <p>When the <a href="/breakup/specs/browser-dom/#sandboxed-top-level-navigation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-browsing-context-flag-2">sandboxed top-level navigation browsing context flag</a> is <em>not</em>
    set, content can navigate its <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="sandboxing:top-level-browsing-context-3">top-level browsing context</a>, but other <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-3">browsing contexts</a> are still protected by the <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag-2">sandboxed
    navigation browsing context flag</a> and possibly the <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-3">sandboxed auxiliary navigation
    browsing context flag</a>.</p>

   </dd><dt>The <dfn id="sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context flag</dfn></dt><dd>

    <p>This flag prevents content from instantiating <a href="/breakup/specs/core-algorithms/#plugin" id="sandboxing:plugin">plugins</a>, whether
    using <a href="#sandboxPluginEmbed">the <code>embed</code> element</a>, <a href="#sandboxPluginObject">the <code>object</code> element</a>, <a href="#sandboxPluginApplet">the <code>applet</code> element</a>, or through <a href="#sandboxPluginNavigate">navigation</a> of a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="sandboxing:nested-browsing-context">nested browsing context</a>, unless
    those <a href="/breakup/specs/core-algorithms/#plugin" id="sandboxing:plugin-2">plugins</a> can be <a href="/breakup/specs/core-algorithms/#concept-plugin-secure" id="sandboxing:concept-plugin-secure">secured</a>.</p>

   </dd><dt>The <dfn id="sandboxed-seamless-iframes-flag">sandboxed seamless iframes flag</dfn></dt><dd>

    <p>This flag prevents content from using the <code id="sandboxing:attr-iframe-seamless"><a href="#attr-iframe-seamless">seamless</a></code>
    attribute on descendant <code id="sandboxing:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> elements.</p>

    <p class="note">This prevents a page inserted using the <code id="sandboxing:attr-iframe-sandbox-allow-same-origin"><a href="/breakup/specs/browser-dom/#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code> keyword from using a
    CSS-selector-based method of probing the DOM of other pages on the same site (in particular,
    pages that contain user-sensitive information).</p>

    

   </dd><dt>The <dfn id="sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</dfn></dt><dd>

    <p>This flag <a href="/breakup/specs/browser-dom/#sandboxOrigin">forces content into a unique origin</a>, thus preventing
    it from accessing other content from the same <a href="/breakup/specs/browser-dom/#origin-2" id="sandboxing:origin-2">origin</a>.</p>

    <p>This flag also <a href="/breakup/specs/browser-dom/#sandboxCookies">prevents script from reading from or writing to the
    <code>document.cookie</code> IDL attribute</a>, and blocks access to
    <code id="sandboxing:dom-localstorage"><a href="http://www.w3.org/TR/webstorage/#dom-localstorage">localStorage</a></code>.</p>

   </dd><dt>The <dfn id="sandboxed-forms-browsing-context-flag">sandboxed forms browsing context flag</dfn></dt><dd>

    <p>This flag <a href="#sandboxSubmitBlocked">blocks form submission</a>.</p>

   </dd><dt>The <dfn id="sandboxed-pointer-lock-browsing-context-flag">sandboxed pointer lock browsing context flag</dfn></dt><dd>

    <p>This flag disables the Pointer Lock API. <a href="#refsPOINTERLOCK">[POINTERLOCK]</a></p>

   </dd><dt>The <dfn id="sandboxed-scripts-browsing-context-flag">sandboxed scripts browsing context flag</dfn></dt><dd>

    <p>This flag <a href="/breakup/specs/browser-dom/#sandboxScriptBlocked">blocks script execution</a>.</p>

   </dd><dt>The <dfn id="sandboxed-automatic-features-browsing-context-flag">sandboxed automatic features browsing context flag</dfn></dt><dd>

    <p>This flag blocks features that trigger automatically, such as <a href="#attr-media-autoplay" id="sandboxing:attr-media-autoplay">automatically playing a video</a> or <a href="#attr-fe-autofocus" id="sandboxing:attr-fe-autofocus">automatically focusing a form control</a>.</p>

   </dd><dt>The <dfn id="sandboxed-storage-area-urls-flag">sandboxed storage area URLs flag</dfn></dt><dd>

    <p>This flag prevents URL schemes that use storage areas from being able to access the origin's
    data.</p>

   </dd><dt>The <dfn id="sandboxed-fullscreen-browsing-context-flag">sandboxed fullscreen browsing context flag</dfn></dt><dd>

    <p>This flag prevents content from using the <code id="sandboxing:dom-element-requestfullscreen"><a href="/breakup/specs/core-algorithms/#dom-element-requestfullscreen">requestFullscreen()</a></code> method.</p>

   </dd><dt>The <dfn id="sandboxed-document.domain-browsing-context-flag">sandboxed <code>document.domain</code> browsing context flag</dfn></dt><dd>

    <p>This flag prevents content from using the <code id="sandboxing:dom-document-domain"><a href="/breakup/specs/browser-dom/#dom-document-domain">document.domain</a></code> feature to change the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="sandboxing:effective-script-origin">effective script
    origin</a>.</p>

   </dd></dl>

  <p>When the user agent is to <dfn id="parse-a-sandboxing-directive">parse a sandboxing directive</dfn>, given a string <var>input</var>, a <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set">sandboxing flag set</a> <var>output</var>, and
  optionally an <var>allow fullscreen flag</var>, it must run the following steps:</p>

  <ol><li><p><a href="/breakup/specs/core-algorithms/#split-a-string-on-spaces" id="sandboxing:split-a-string-on-spaces">Split <var>input</var> on spaces</a>,
   to obtain <var>tokens</var>.</p></li><li><p>Let <var>output</var> be empty.</p></li><li>

    <p>Add the following flags to <var>output</var>:</p>

    <ul><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag-3">sandboxed navigation browsing context flag</a>.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-4">sandboxed auxiliary navigation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-popups"><code>allow-popups</code></dfn> keyword.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-top-level-navigation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-browsing-context-flag-3">sandboxed top-level navigation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-top-navigation"><code>allow-top-navigation</code></dfn>
     keyword.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-plugins-browsing-context-flag" id="sandboxing:sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context flag</a>.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-seamless-iframes-flag" id="sandboxing:sandboxed-seamless-iframes-flag">sandboxed seamless iframes flag</a>.</p></li><li>

      <p>The <a href="/breakup/specs/browser-dom/#sandboxed-origin-browsing-context-flag" id="sandboxing:sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a>, unless the <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-same-origin"><code>allow-same-origin</code></dfn>
      keyword.</p>

      <div class="note">

       <p>The <code id="sandboxing:attr-iframe-sandbox-allow-same-origin-2"><a href="/breakup/specs/browser-dom/#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code> keyword
       is intended for two cases.</p>

       <p>First, it can be used to allow content from the same site to be sandboxed to disable
       scripting, while still allowing access to the DOM of the sandboxed content.</p>

       <p>Second, it can be used to embed content from a third-party site, sandboxed to prevent that
       site from opening pop-up windows, etc, without preventing the embedded page from
       communicating back to its originating site, using the database APIs to store data, etc.</p>

      </div>

     </li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-forms-browsing-context-flag" id="sandboxing:sandboxed-forms-browsing-context-flag">sandboxed forms browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-forms"><code>allow-forms</code></dfn> keyword.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-pointer-lock-browsing-context-flag" id="sandboxing:sandboxed-pointer-lock-browsing-context-flag">sandboxed pointer lock browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-pointer-lock"><code>allow-pointer-lock</code></dfn>
     keyword.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-scripts-browsing-context-flag" id="sandboxing:sandboxed-scripts-browsing-context-flag">sandboxed scripts browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-scripts"><code>allow-scripts</code></dfn> keyword.</p></li><li>

      <p>The <a href="/breakup/specs/browser-dom/#sandboxed-automatic-features-browsing-context-flag" id="sandboxing:sandboxed-automatic-features-browsing-context-flag">sandboxed automatic features browsing context flag</a>, unless <var>tokens</var> contains the <code id="sandboxing:attr-iframe-sandbox-allow-scripts"><a href="/breakup/specs/browser-dom/#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code> keyword (defined above).</p>

      <p class="note">This flag is relaxed by the same keyword as scripts, because when scripts are
      enabled these features are trivially possible anyway, and it would be unfortunate to force
      authors to use script to do them when sandboxed rather than allowing them to use the
      declarative features.</p>

     </li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-storage-area-urls-flag" id="sandboxing:sandboxed-storage-area-urls-flag">sandboxed storage area URLs flag</a>.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-fullscreen-browsing-context-flag" id="sandboxing:sandboxed-fullscreen-browsing-context-flag">sandboxed fullscreen browsing context flag</a>, unless the <var>allow fullscreen flag</var> was passed to the <a href="/breakup/specs/browser-dom/#parse-a-sandboxing-directive" id="sandboxing:parse-a-sandboxing-directive">parse a sandboxing
     directive</a> flag.</p></li><li><p>The <a href="/breakup/specs/browser-dom/#sandboxed-document.domain-browsing-context-flag" id="sandboxing:sandboxed-document.domain-browsing-context-flag">sandboxed <code>document.domain</code> browsing
     context flag</a>.</p></li></ul>

   </li></ol>

  <hr>

  <p>Every <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="sandboxing:top-level-browsing-context-4">top-level browsing context</a> has a <dfn id="popup-sandboxing-flag-set">popup sandboxing flag set</dfn>, which
  is a <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-2">sandboxing flag set</a>. When a <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-4">browsing context</a> is created, its
  <a href="/breakup/specs/browser-dom/#popup-sandboxing-flag-set" id="sandboxing:popup-sandboxing-flag-set">popup sandboxing flag set</a> must be empty. It is populated by <a href="/breakup/specs/browser-dom/#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" id="sandboxing:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">the rules for
  choosing a browsing context given a browsing context name</a>.</p>

  <p>Every <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="sandboxing:nested-browsing-context-2">nested browsing context</a> has an <dfn id="iframe-sandboxing-flag-set"><code>iframe</code> sandboxing flag
  set</dfn>, which is a <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-3">sandboxing flag set</a>. Which flags in a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="sandboxing:nested-browsing-context-3">nested browsing
  context</a>'s <a href="/breakup/specs/browser-dom/#iframe-sandboxing-flag-set" id="sandboxing:iframe-sandboxing-flag-set"><code>iframe</code> sandboxing flag set</a> are set at any particular
  time is determined by the <code id="sandboxing:the-iframe-element-2"><a href="#the-iframe-element">iframe</a></code> element's <code id="sandboxing:attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute.</p>

  <p>Every <code id="sandboxing:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has an <dfn id="active-sandboxing-flag-set">active sandboxing flag set</dfn>, which is a
  <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-4">sandboxing flag set</a>. When the <code id="sandboxing:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, its <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set">active
  sandboxing flag set</a> must be empty. It is populated by the <a href="#navigate" id="sandboxing:navigate">navigation
  algorithm</a>.</p>

  <p>Every resource that is obtained by the <a href="#navigate" id="sandboxing:navigate-2">navigation algorithm</a> has a
  <dfn id="forced-sandboxing-flag-set">forced sandboxing flag set</dfn>, which is a <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-5">sandboxing flag set</a>. A resource by
  default has no flags set in its <a href="/breakup/specs/browser-dom/#forced-sandboxing-flag-set" id="sandboxing:forced-sandboxing-flag-set">forced sandboxing flag set</a>, but other specifications
  can define that certain flags are set.</p>

  <p class="note">In particular, the <a href="/breakup/specs/browser-dom/#forced-sandboxing-flag-set" id="sandboxing:forced-sandboxing-flag-set-2">forced sandboxing flag set</a> is used by the Content
  Security Policy specification. <a href="#refsCSP">[CSP]</a></p>

  <hr>

  <p>When a user agent is to <dfn id="implement-the-sandboxing">implement the sandboxing</dfn> for a <code id="sandboxing:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, it
  must populate <code id="sandboxing:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set-2">active sandboxing flag set</a> with the union of
  the flags that are present in the following <a href="/breakup/specs/browser-dom/#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-6">sandboxing flag
  sets</a> at the time the <code id="sandboxing:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is created:</p>

  <ul><li><p>If the <code id="sandboxing:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-5">browsing context</a> is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="sandboxing:top-level-browsing-context-5">top-level browsing
   context</a>, then: the flags set on the <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-6">browsing context</a>'s <a href="/breakup/specs/browser-dom/#popup-sandboxing-flag-set" id="sandboxing:popup-sandboxing-flag-set-2">popup sandboxing
   flag set</a>.</p></li><li><p>If the <code id="sandboxing:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-7">browsing context</a> is a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="sandboxing:nested-browsing-context-4">nested browsing
   context</a>, then: the flags set on the <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-8">browsing context</a>'s
   <a href="/breakup/specs/browser-dom/#iframe-sandboxing-flag-set" id="sandboxing:iframe-sandboxing-flag-set-2"><code>iframe</code> sandboxing flag set</a>.</p></li><li><p>If the <code id="sandboxing:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-9">browsing context</a> is a <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="sandboxing:nested-browsing-context-5">nested browsing
   context</a>, then: the flags set on the <a href="/breakup/specs/browser-dom/#browsing-context" id="sandboxing:browsing-context-10">browsing context</a>'s <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="sandboxing:parent-browsing-context">parent browsing
   context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="sandboxing:active-document">active document</a>'s <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set-3">active sandboxing flag set</a>.</p></li><li><p>The flags set on the <code id="sandboxing:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s resource's <a href="/breakup/specs/browser-dom/#forced-sandboxing-flag-set" id="sandboxing:forced-sandboxing-flag-set-3">forced sandboxing flag
   set</a>, if it has one.</p></li></ul></section><section><h3 id="history">6.5 Session history and navigation</h3>

  <section><h4 id="the-session-history-of-browsing-contexts">6.5.1 The session history of browsing contexts</h4>

  <p>The sequence of <code id="the-session-history-of-browsing-contexts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context">browsing context</a> is its <dfn id="session-history">session
  history</dfn>. Each <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-2">browsing context</a>, including <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="the-session-history-of-browsing-contexts:nested-browsing-context">nested browsing contexts</a>, has a distinct session history. A <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-3">browsing
  context</a>'s session history consists of a flat list of <a href="/breakup/specs/browser-dom/#session-history-entry" id="the-session-history-of-browsing-contexts:session-history-entry">session history entries</a>. Each <dfn id="session-history-entry">session history entry</dfn> consists, at a
  minimum, of a <a href="/breakup/specs/core-algorithms/#url" id="the-session-history-of-browsing-contexts:url">URL</a>, and each entry may in addition have a <a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object">state object</a>, a
  title, a <code id="the-session-history-of-browsing-contexts:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, form data, a scroll position, and other information
  associated with it.</p>

  <p class="note">Each entry, when first created, has a <code id="the-session-history-of-browsing-contexts:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>. However, when a
  <code id="the-session-history-of-browsing-contexts:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is not <a href="/breakup/specs/browser-dom/#fully-active" id="the-session-history-of-browsing-contexts:fully-active">active</a>, it's possible for it to be
  <a href="/breakup/specs/browser-dom/#discard-a-document" id="the-session-history-of-browsing-contexts:discard-a-document">discarded</a> to free resources. The <a href="/breakup/specs/core-algorithms/#url" id="the-session-history-of-browsing-contexts:url-2">URL</a> and
  other data in a <a href="/breakup/specs/browser-dom/#session-history-entry" id="the-session-history-of-browsing-contexts:session-history-entry-2">session history entry</a> is then used to bring a new
  <code id="the-session-history-of-browsing-contexts:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> into being to take the place of the original, should the user agent find
  itself having to reactivate that <code id="the-session-history-of-browsing-contexts:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  <p class="note">Titles associated with <a href="/breakup/specs/browser-dom/#session-history-entry" id="the-session-history-of-browsing-contexts:session-history-entry-3">session history
  entries</a> need not have any relation with the current <code id="the-session-history-of-browsing-contexts:the-title-element"><a href="#the-title-element">title</a></code> of the
  <code id="the-session-history-of-browsing-contexts:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code>. The title of a <a href="/breakup/specs/browser-dom/#session-history-entry" id="the-session-history-of-browsing-contexts:session-history-entry-4">session history entry</a> is intended to explain
  the state of the document at that point, so that the user can navigate the document's history.</p>

  <p>URLs without associated <a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object-2">state objects</a> are added to the
  session history as the user (or script) navigates from page to page.</p>

  <hr>

  <p>Each <code id="the-session-history-of-browsing-contexts:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-4">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="the-session-history-of-browsing-contexts:session-history">session
  history</a> is associated with a unique <code id="the-session-history-of-browsing-contexts:history-3"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> object which must all model the
  same underlying <a href="/breakup/specs/browser-dom/#session-history" id="the-session-history-of-browsing-contexts:session-history-2">session history</a>.</p>

  

  <p>The <dfn id="dom-history"><code>history</code></dfn> attribute of the <code id="the-session-history-of-browsing-contexts:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  interface must return the object implementing the <code id="the-session-history-of-browsing-contexts:history-3-2"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface for that <a href="/breakup/specs/browser-dom/#concept-document-window" id="the-session-history-of-browsing-contexts:concept-document-window"><code>Window</code> object's newest
  <code>Document</code></a>.</p>

  

  <hr>

  <p>A <dfn id="state-object">state object</dfn> is an object representing a user interface state.</p>

  <p>Pages can <a href="/breakup/specs/browser-dom/#dom-history-pushstate" id="the-session-history-of-browsing-contexts:dom-history-pushstate">add</a> <a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object-3">state
  objects</a> to the session history. These are then <a href="/breakup/specs/html/#event-popstate" id="the-session-history-of-browsing-contexts:event-popstate">returned to the
  script</a> when the user (or script) goes back in the history, thus enabling authors to use the
  "navigation" metaphor even in one-page applications.</p>

  <div class="note">

   <p><a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object-4">State objects</a> are intended to be used for two main purposes:
   first, storing a preparsed description of the state in the <a href="/breakup/specs/core-algorithms/#url" id="the-session-history-of-browsing-contexts:url-3">URL</a> so that in the simple
   case an author doesn't have to do the parsing (though one would still need the parsing for
   handling <a href="/breakup/specs/core-algorithms/#url" id="the-session-history-of-browsing-contexts:url-4">URLs</a> passed around by users, so it's only a minor
   optimization), and second, so that the author can store state that one wouldn't store in the URL
   because it only applies to the current <code id="the-session-history-of-browsing-contexts:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> instance and it would have to be
   reconstructed if a new <code id="the-session-history-of-browsing-contexts:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code> were opened.</p>

   <p>An example of the latter would be something like keeping track of the precise coordinate from
   which a pop-up <code id="the-session-history-of-browsing-contexts:the-div-element"><a href="#the-div-element">div</a></code> was made to animate, so that if the user goes back, it can be
   made to animate to the same location. Or alternatively, it could be used to keep a pointer into a
   cache of data that would be fetched from the server based on the information in the
   <a href="/breakup/specs/core-algorithms/#url" id="the-session-history-of-browsing-contexts:url-5">URL</a>, so that when going back and forward, the information doesn't have to be fetched
   again.</p>

  </div>

  <hr>

  <p>At any point, one of the entries in the session history is the <dfn id="current-entry">current entry</dfn>. This
  is the entry representing the <a href="/breakup/specs/browser-dom/#active-document" id="the-session-history-of-browsing-contexts:active-document">active document</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-5">browsing context</a>.
  Which entry is the <a href="/breakup/specs/browser-dom/#current-entry" id="the-session-history-of-browsing-contexts:current-entry">current entry</a> is changed by the algorithms defined in this
  specification, e.g. during <a href="#traverse-the-history" id="the-session-history-of-browsing-contexts:traverse-the-history">session history
  traversal</a>.</p>

  <p class="note">The <a href="/breakup/specs/browser-dom/#current-entry" id="the-session-history-of-browsing-contexts:current-entry-2">current entry</a> is usually an entry for the <a href="https://dom.spec.whatwg.org/#concept-document-url" id="the-session-history-of-browsing-contexts:the-document's-address" data-x-internal="the-document's-address">address</a> of the <code id="the-session-history-of-browsing-contexts:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code>. However, it can also be one of
  the entries for <a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object-5">state objects</a> added to the history by that
  document.</p>

  <p><dfn id="an-entry-with-persisted-user-state">An entry with persisted user state</dfn> is one that also has user-agent defined state.
  This specification does not specify what kind of state can be stored.</p>

  <p class="example">For example, some user agents might want to persist the scroll position, or the
  values of form controls.</p>

  <p class="note">User agents that persist the value of form controls are encouraged to also persist
  their directionality (the value of the element's <code id="the-session-history-of-browsing-contexts:the-dir-attribute"><a href="#the-dir-attribute">dir</a></code> attribute).
  This prevents values from being displayed incorrectly after a history traversal when the user had
  originally entered the values with an explicit, non-default directionality.</p>

  <p>Entries that consist of <a href="/breakup/specs/browser-dom/#state-object" id="the-session-history-of-browsing-contexts:state-object-6">state objects</a> share the same
  <code id="the-session-history-of-browsing-contexts:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> as the entry for the page that was active when they were added.</p>

  <p>Contiguous entries that differ just by fragment identifier also share the same
  <code id="the-session-history-of-browsing-contexts:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  <p class="note">All entries that share the same <code id="the-session-history-of-browsing-contexts:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> (and that are therefore
  merely different states of one particular document) are contiguous by definition.</p>

  <p>Each <code id="the-session-history-of-browsing-contexts:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-6">browsing context</a> can also have a <dfn id="latest-entry">latest
  entry</dfn>. This is the entry for that <code id="the-session-history-of-browsing-contexts:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code> to which the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-session-history-of-browsing-contexts:browsing-context-7">browsing
  context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="the-session-history-of-browsing-contexts:session-history-3">session history</a> was most recently traversed. When a
  <code id="the-session-history-of-browsing-contexts:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is created, it initially has no <a href="/breakup/specs/browser-dom/#latest-entry" id="the-session-history-of-browsing-contexts:latest-entry">latest entry</a>.</p>

  

  <p>User agents may <a href="/breakup/specs/browser-dom/#discard-a-document" id="the-session-history-of-browsing-contexts:discard-a-document-2">discard</a> the <code id="the-session-history-of-browsing-contexts:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
  objects of entries other than the <a href="/breakup/specs/browser-dom/#current-entry" id="the-session-history-of-browsing-contexts:current-entry-3">current entry</a> that are not referenced from any
  script, reloading the pages afresh when the user or script navigates back to such pages. This
  specification does not specify when user agents should discard <code id="the-session-history-of-browsing-contexts:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects and
  when they should cache them.</p>

  <p>Entries that have had their <code id="the-session-history-of-browsing-contexts:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects discarded must, for the purposes of
  the algorithms given below, act as if they had not. When the user or script navigates back or
  forwards to a page which has no in-memory DOM objects, any other entries that shared the same
  <code id="the-session-history-of-browsing-contexts:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object with it must share the new object as well.</p></section>

  




  <section><h4 id="the-history-interface">6.5.2 The <code id="the-history-interface:history-3"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface</h4>

  <pre class="idl">interface <dfn id="history-3">History</dfn> {
  readonly attribute long <a href="/breakup/specs/browser-dom/#dom-history-length" id="the-history-interface:dom-history-length">length</a>;
  readonly attribute any <a href="/breakup/specs/browser-dom/#dom-history-state" id="the-history-interface:dom-history-state">state</a>;
  void <a href="/breakup/specs/browser-dom/#dom-history-go" id="the-history-interface:dom-history-go">go</a>(optional long delta);
  void <a href="/breakup/specs/browser-dom/#dom-history-back" id="the-history-interface:dom-history-back">back</a>();
  void <a href="/breakup/specs/browser-dom/#dom-history-forward" id="the-history-interface:dom-history-forward">forward</a>();
  void <a href="/breakup/specs/browser-dom/#dom-history-pushstate" id="the-history-interface:dom-history-pushstate">pushState</a>(any data, DOMString title, optional DOMString? url = null);
  void <a href="/breakup/specs/browser-dom/#dom-history-replacestate" id="the-history-interface:dom-history-replacestate">replaceState</a>(any data, DOMString title, optional DOMString? url = null);
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="the-history-interface:dom-history"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-length-2"><a href="/breakup/specs/browser-dom/#dom-history-length">length</a></code></dt><dd>

    <p>Returns the number of entries in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history">joint session history</a>.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-2"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-state-2"><a href="/breakup/specs/browser-dom/#dom-history-state">state</a></code></dt><dd>

    <p>Returns the current <a href="/breakup/specs/browser-dom/#state-object" id="the-history-interface:state-object">state object</a>.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-3"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-go-2"><a href="/breakup/specs/browser-dom/#dom-history-go">go</a></code>( [ <var>delta</var> ] )</dt><dd>

    <p>Goes back or forward the specified number of steps in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-2">joint session history</a>.</p>

    <p>A zero delta will reload the current page.</p>

    <p>If the delta is out of range, does nothing.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-4"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-back-2"><a href="/breakup/specs/browser-dom/#dom-history-back">back</a></code>()</dt><dd>

    <p>Goes back one step in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-3">joint session history</a>.</p>

    <p>If there is no previous page, does nothing.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-5"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-forward-2"><a href="/breakup/specs/browser-dom/#dom-history-forward">forward</a></code>()</dt><dd>

    <p>Goes forward one step in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-4">joint session history</a>.</p>

    <p>If there is no next page, does nothing.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-6"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-pushstate-2"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState</a></code>(<var>data</var>, <var>title</var> [, <var>url</var> ] )</dt><dd>

    <p>Pushes the given data onto the session history, with the given title, and, if provided and
    not null, the given URL.</p>

   </dd><dt><var>window</var> . <code id="the-history-interface:dom-history-7"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> . <code id="the-history-interface:dom-history-replacestate-2"><a href="/breakup/specs/browser-dom/#dom-history-replacestate">replaceState</a></code>(<var>data</var>, <var>title</var> [, <var>url</var> ] )</dt><dd>

    <p>Updates the current entry in the session history to have the given data, title, and, if
    provided and not null, URL.</p>

   </dd></dl>



  <p>The <dfn id="joint-session-history">joint session history</dfn> of a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context">top-level browsing context</a> is the union
  of all the <a href="/breakup/specs/browser-dom/#session-history" id="the-history-interface:session-history">session histories</a> of all <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context">browsing contexts</a> of all the <a href="/breakup/specs/browser-dom/#fully-active" id="the-history-interface:fully-active">fully active</a> <code id="the-history-interface:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
  objects that share that <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-2">top-level browsing context</a>, with all the entries that are
  <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry">current entries</a> in their respective <a href="/breakup/specs/browser-dom/#session-history" id="the-history-interface:session-history-2">session histories</a> removed except for the <a href="/breakup/specs/browser-dom/#current-entry-of-the-joint-session-history" id="the-history-interface:current-entry-of-the-joint-session-history">current entry of the joint session
  history</a>.</p>

  <p>The <dfn id="current-entry-of-the-joint-session-history">current entry of the joint session history</dfn> is the entry that most recently
  became a <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-2">current entry</a> in its <a href="/breakup/specs/browser-dom/#session-history" id="the-history-interface:session-history-3">session history</a>.</p>

  <p>Entries in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-5">joint session history</a> are ordered chronologically by the time they
  were added to their respective <a href="/breakup/specs/browser-dom/#session-history" id="the-history-interface:session-history-4">session histories</a>. Each entry
  has an index; the earliest entry has index 0, and the subsequent entries are numbered with
  consecutively increasing integers (1, 2, 3, etc).</p>

  <p class="note">Since each <code id="the-history-interface:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-2">browsing context</a> might have a
  different <a href="/breakup/specs/browser-dom/#event-loop" id="the-history-interface:event-loop">event loop</a>, the actual state of the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-6">joint session history</a> can
  be somewhat nebulous. For example, two sibling <code id="the-history-interface:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> elements could both <a href="#traverse-the-history" id="the-history-interface:traverse-the-history">traverse</a> from one unique origin to another at the same time,
  so their precise order might not be well-defined; similarly, since they might only find out about
  each other later, they might disagree about the length of the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-7">joint session
  history</a>.</p>



  


  <p>All the getters and setters for attributes, and all the methods, defined on the
  <code id="the-history-interface:history-3-2"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface, when invoked on a <code id="the-history-interface:history-3-3"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> object associated with a
  <code id="the-history-interface:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that is not <a href="/breakup/specs/browser-dom/#fully-active" id="the-history-interface:fully-active-2">fully active</a>, must throw a
  <code id="the-history-interface:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception instead of operating as described below.</p>


  <p>The <dfn id="dom-history-length"><code>length</code></dfn> attribute of the
  <code id="the-history-interface:history-3-4"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface must return the number of entries in the <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-3">top-level browsing
  context</a>'s <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-8">joint session history</a>.</p>

  <p>The actual entries are not accessible from script.</p>

  <p>The <dfn id="dom-history-state"><code>state</code></dfn> attribute of the
  <code id="the-history-interface:history-3-5"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface must return the last value it was set to by the user agent.
  Initially, its value must be null.</p>

  <p>When the <dfn id="dom-history-go"><code>go(<var>delta</var>)</code></dfn> method is
  invoked, if the argument to the method was omitted or has the value zero, the user agent must act
  as if the <code id="the-history-interface:dom-location-reload"><a href="/breakup/specs/browser-dom/#dom-location-reload">location.reload()</a></code> method was called instead.
  Otherwise, the user agent must <a href="/breakup/specs/browser-dom/#traverse-the-history-by-a-delta" id="the-history-interface:traverse-the-history-by-a-delta">traverse the history by a delta</a> whose value is the
  value of the method's argument.</p>

  <p>When the <dfn id="dom-history-back"><code>back()</code></dfn> method is invoked, the user
  agent must <a href="/breakup/specs/browser-dom/#traverse-the-history-by-a-delta" id="the-history-interface:traverse-the-history-by-a-delta-2">traverse the history by a delta</a> 1.</p>

  <p>When the <dfn id="dom-history-forward"><code>forward()</code></dfn>method is invoked, the
  user agent must <a href="/breakup/specs/browser-dom/#traverse-the-history-by-a-delta" id="the-history-interface:traverse-the-history-by-a-delta-3">traverse the history by a delta</a> +1.</p>



  <hr>

  <p>Each <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-4">top-level browsing context</a> has a <dfn id="session-history-traversal-queue">session history traversal queue</dfn>,
  initially empty, to which <a href="/breakup/specs/browser-dom/#concept-task" id="the-history-interface:concept-task">tasks</a> can be added.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-5">top-level browsing context</a>, when created, must begin running
  the following algorithm, known as the <dfn id="session-history-event-loop">session history event loop</dfn> for that
  <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-6">top-level browsing context</a>, <a href="/breakup/specs/core-algorithms/#in-parallel" id="the-history-interface:in-parallel">in parallel</a>:</p>

  <ol><li><p>Wait until this <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-7">top-level browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history-traversal-queue" id="the-history-interface:session-history-traversal-queue">session history traversal
   queue</a> is not empty.</p></li><li><p>Pull the first <a href="/breakup/specs/browser-dom/#concept-task" id="the-history-interface:concept-task-2">task</a> from this <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-8">top-level browsing
   context</a>'s <a href="/breakup/specs/browser-dom/#session-history-traversal-queue" id="the-history-interface:session-history-traversal-queue-2">session history traversal queue</a>, and execute it.</p></li><li><p>Return to the first step of this algorithm.</p>

  </li></ol>

  <p>The <a href="/breakup/specs/browser-dom/#session-history-event-loop" id="the-history-interface:session-history-event-loop">session history event loop</a> helps coordinate cross-browsing-context transitions
  of the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-9">joint session history</a>: since each <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-3">browsing context</a> might, at any
  particular time, have a different <a href="/breakup/specs/browser-dom/#event-loop" id="the-history-interface:event-loop-2">event loop</a> (this can happen if the user agent has
  more than one <a href="/breakup/specs/browser-dom/#event-loop" id="the-history-interface:event-loop-3">event loop</a> per <a href="/breakup/specs/browser-dom/#unit-of-related-browsing-contexts" id="the-history-interface:unit-of-related-browsing-contexts">unit of related browsing contexts</a>),
  transitions would otherwise have to involve cross-event-loop synchronisation.</p>

  <hr>

  <p>To <dfn id="traverse-the-history-by-a-delta">traverse the history by a delta</dfn> <var>delta</var>, the user agent must
  append a <a href="/breakup/specs/browser-dom/#concept-task" id="the-history-interface:concept-task-3">task</a> to this <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-9">top-level browsing context</a>'s
  <a href="/breakup/specs/browser-dom/#session-history-traversal-queue" id="the-history-interface:session-history-traversal-queue-3">session history traversal queue</a>, the <a href="/breakup/specs/browser-dom/#concept-task" id="the-history-interface:concept-task-4">task</a>
  consisting of running the following steps:</p>

  <ol><li><p>Let <var>delta</var> be the argument to the method.</p></li><li><p>If the index of the <a href="/breakup/specs/browser-dom/#current-entry-of-the-joint-session-history" id="the-history-interface:current-entry-of-the-joint-session-history-2">current entry of the joint session history</a> plus <var>delta</var> is less than zero or greater than or equal to the number of items in the
   <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-10">joint session history</a>, then abort these steps.</p>

   </li><li><p>Let <var>specified entry</var> be the entry in the <a href="/breakup/specs/browser-dom/#joint-session-history" id="the-history-interface:joint-session-history-11">joint session
   history</a> whose index is the sum of <var>delta</var> and the index of the
   <a href="/breakup/specs/browser-dom/#current-entry-of-the-joint-session-history" id="the-history-interface:current-entry-of-the-joint-session-history-3">current entry of the joint session history</a>.</p></li><li><p>Let <var>specified browsing context</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-4">browsing context</a> of
   the <var>specified entry</var>.</p></li><li><p>If the <var>specified browsing context</var>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document">active document</a>'s
   <a href="#unload-a-document" id="the-history-interface:unload-a-document">unload a document</a> algorithm is currently running, abort these steps.</p></li><li>

    <p><a href="/breakup/specs/browser-dom/#queue-a-task" id="the-history-interface:queue-a-task">Queue a task</a> that consists of running the following substeps. The relevant
    <a href="/breakup/specs/browser-dom/#event-loop" id="the-history-interface:event-loop-4">event loop</a> is that of the <var>specified browsing context</var>'s
    <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document-2">active document</a>. The <a href="/breakup/specs/browser-dom/#task-source" id="the-history-interface:task-source">task source</a> for the queued task is the
    <a href="/breakup/specs/browser-dom/#history-traversal-task-source" id="the-history-interface:history-traversal-task-source">history traversal task source</a>.</p>

    <ol><li><p>If there is an ongoing attempt to navigate <var>specified browsing context</var>
     that has not yet <a href="#concept-navigate-mature" id="the-history-interface:concept-navigate-mature">matured</a> (i.e. it has not passed the
     point of making its <code id="the-history-interface:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> the <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document-3">active document</a>), then cancel that
     attempt to navigate the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-5">browsing context</a>.</p></li><li>

      <p>If the <var>specified browsing context</var>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document-4">active document</a> is not
      the same <code id="the-history-interface:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> as the <code id="the-history-interface:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> of the <var>specified
      entry</var>, then run these substeps:</p>

      <ol><li><p><a href="/breakup/specs/core-algorithms/#fully-exit-fullscreen" id="the-history-interface:fully-exit-fullscreen">Fully exit fullscreen</a>.</p></li><li><p><a href="#prompt-to-unload-a-document" id="the-history-interface:prompt-to-unload-a-document">Prompt to unload</a> the <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document-5">active
       document</a> of the <var>specified browsing context</var>. If the user
       <a href="#refused-to-allow-the-document-to-be-unloaded" id="the-history-interface:refused-to-allow-the-document-to-be-unloaded">refused to allow the document to be unloaded</a>, then abort these steps.</p></li><li><p><a href="#unload-a-document" id="the-history-interface:unload-a-document-2">Unload</a> the <a href="/breakup/specs/browser-dom/#active-document" id="the-history-interface:active-document-6">active document</a> of the
       <var>specified browsing context</var> with the <var>recycle</var> parameter
       set to false.</p></li></ol>

     </li><li><p><a href="#traverse-the-history" id="the-history-interface:traverse-the-history-2">Traverse the history</a> of the <var>specified browsing context</var> to
     the <var>specified entry</var>.</p>

    </li></ol>

   </li></ol>

  <p>When the user navigates through a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-6">browsing context</a>, e.g. using a browser's back
  and forward buttons, the user agent must <a href="/breakup/specs/browser-dom/#traverse-the-history-by-a-delta" id="the-history-interface:traverse-the-history-by-a-delta-4">traverse the history by a delta</a> equivalent
  to the action specified by the user.</p>

  <hr id="history-1"> 

  <p>The <dfn id="dom-history-pushstate"><code>pushState(<var>data</var>, <var>title</var>, <var>url</var>)</code></dfn> method adds a state object entry to
  the history.</p>

  <p>The <dfn id="dom-history-replacestate"><code>replaceState(<var>data</var>, <var>title</var>, <var>url</var>)</code></dfn> method updates the state object,
  title, and optionally the <a href="/breakup/specs/core-algorithms/#url" id="the-history-interface:url">URL</a> of the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-3">current entry</a> in the history.</p>

  <p>When either of these methods is invoked, the user agent must run the following steps:</p>

  <ol><li><p>Let <var>cloned data</var> be a <a href="/breakup/specs/core-algorithms/#structured-clone" id="the-history-interface:structured-clone">structured clone</a> of the specified
   <var>data</var>. If this throws an exception, then rethrow that exception and abort
   these steps.</p></li><li>

    <p>If the third argument is not null, run these substeps:</p>

    <ol><li><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-history-interface:resolve-a-url">Resolve</a> the value of the third argument, relative to
     the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-history-interface:api-base-url">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-history-interface:entry-settings-object">entry settings object</a>.</li><li>If that fails, throw a <code id="the-history-interface:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</li><li>Compare the resulting <a href="/breakup/specs/core-algorithms/#parsed-url" id="the-history-interface:parsed-url">parsed URL</a> to the result of applying the <a href="/breakup/specs/core-algorithms/#url-parser" id="the-history-interface:url-parser">URL
     parser</a> algorithm to <a id="the-history-interface:the-document's-address" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a>. If any component of these two
     <a href="/breakup/specs/core-algorithms/#url" id="the-history-interface:url-2">URLs</a> differ other than the <a href="/breakup/specs/core-algorithms/#concept-url-path" id="the-history-interface:concept-url-path">path</a>, <a href="/breakup/specs/core-algorithms/#concept-url-query" id="the-history-interface:concept-url-query">query</a>, and <a href="/breakup/specs/core-algorithms/#concept-url-fragment" id="the-history-interface:concept-url-fragment">fragment</a> components, then throw a
     <code id="the-history-interface:securityerror-3"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</li><li>If the <a href="/breakup/specs/browser-dom/#origin-2" id="the-history-interface:origin-2">origin</a> of the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="the-history-interface:absolute-url">absolute URL</a> is not the same as
     the <a href="/breakup/specs/browser-dom/#origin-2" id="the-history-interface:origin-2-2">origin</a> of the <a href="/breakup/specs/browser-dom/#responsible-document" id="the-history-interface:responsible-document">responsible document</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-history-interface:entry-settings-object-2">entry
     settings object</a>, and either the <a href="/breakup/specs/core-algorithms/#concept-url-path" id="the-history-interface:concept-url-path-2">path</a> or <a href="/breakup/specs/core-algorithms/#concept-url-query" id="the-history-interface:concept-url-query-2">query</a> components of the two <a href="/breakup/specs/core-algorithms/#parsed-url" id="the-history-interface:parsed-url-2">parsed
     URLs</a> compared in the previous step differ, throw a <code id="the-history-interface:securityerror-4"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception
     and abort these steps. (This prevents sandboxed content from spoofing other pages on the same
     origin.)</li><li><p>Let <var>new URL</var> be the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="the-history-interface:absolute-url-2">absolute URL</a>.</p></li></ol>

    <p>For the purposes of the comparisons in the above substeps, the <a href="/breakup/specs/core-algorithms/#concept-url-path" id="the-history-interface:concept-url-path-3">path</a> and <a href="/breakup/specs/core-algorithms/#concept-url-query" id="the-history-interface:concept-url-query-3">query</a> components
    can only be the same if the <a href="/breakup/specs/core-algorithms/#concept-url-scheme" id="the-history-interface:concept-url-scheme">scheme</a> component of both
    <a href="/breakup/specs/core-algorithms/#parsed-url" id="the-history-interface:parsed-url-3">parsed URLs</a> are <a href="/breakup/specs/core-algorithms/#concept-url-scheme-relative" id="the-history-interface:concept-url-scheme-relative">relative schemes</a>.</p>

   </li><li>

    <p>If the third argument is null, then let <var>new URL</var> be the <a href="/breakup/specs/core-algorithms/#url" id="the-history-interface:url-3">URL</a>
    of the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-4">current entry</a>.</p>

   </li><li>

    <p>If the method invoked was the <code id="the-history-interface:dom-history-pushstate-3"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState()</a></code>
    method:</p>

    <ol><li>

      <p>Remove all the entries in the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-7">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="the-history-interface:session-history-5">session history</a>
      after the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-5">current entry</a>. If the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-6">current entry</a> is the last entry in
      the session history, then no entries are removed.</p>

      <p class="note">This <a href="/breakup/specs/browser-dom/#history-notes">doesn't necessarily have to affect</a> the user
      agent's user interface.</p>

     </li><li><p>Remove any <a href="/breakup/specs/browser-dom/#concept-task" id="the-history-interface:concept-task-5">tasks</a> queued by the <a href="/breakup/specs/browser-dom/#history-traversal-task-source" id="the-history-interface:history-traversal-task-source-2">history traversal
     task source</a> that are associated with any <code id="the-history-interface:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects in the
     <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-history-interface:top-level-browsing-context-10">top-level browsing context</a>'s <a href="/breakup/specs/browser-dom/#document-family" id="the-history-interface:document-family">document family</a>.</p></li><li><p>If appropriate, update the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-7">current entry</a> to reflect any state that the user
     agent wishes to persist. The entry is then said to be <a href="/breakup/specs/browser-dom/#an-entry-with-persisted-user-state" id="the-history-interface:an-entry-with-persisted-user-state">an entry with persisted user
     state</a>.</p></li><li><p>Add a <a href="/breakup/specs/browser-dom/#state-object" id="the-history-interface:state-object-2">state object</a> entry to the session history, after the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-8">current
     entry</a>, with <var>cloned data</var> as the <a href="/breakup/specs/browser-dom/#state-object" id="the-history-interface:state-object-3">state object</a>, the given
     <var>title</var> as the title, and <var>new URL</var> as the <a href="/breakup/specs/core-algorithms/#url" id="the-history-interface:url-4">URL</a>
     of the entry.</p></li><li><p>Update the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-9">current entry</a> to be this newly added entry.</p></li></ol>

    <p>Otherwise, if the method invoked was the <code id="the-history-interface:dom-history-replacestate-3"><a href="/breakup/specs/browser-dom/#dom-history-replacestate">replaceState()</a></code> method:</p>

    <ol><li><p>Update the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-10">current entry</a> in the session history so that <var>cloned data</var> is the entry's new state object, the given <var>title</var>
     is the new title, and <var>new URL</var> is the entry's new <a href="/breakup/specs/core-algorithms/#url" id="the-history-interface:url-5">URL</a>.</p></li></ol>

   </li><li><p>If the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-11">current entry</a> in the session history represents a non-GET request
   (e.g. it was the result of a POST submission) then update it to instead represent a GET request
   (<a href="/breakup/specs/core-algorithms/#concept-http-equivalent-get" id="the-history-interface:concept-http-equivalent-get">or equivalent</a>).</p></li><li>

    <p>Set <a id="the-history-interface:the-document's-address-2" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a> to <var>new URL</var>.</p>

    <p class="note">Since this is neither a <a href="#navigate" id="the-history-interface:navigate">navigation</a> of the
    <a href="/breakup/specs/browser-dom/#browsing-context" id="the-history-interface:browsing-context-8">browsing context</a> nor a <a href="#traverse-the-history" id="the-history-interface:traverse-the-history-3">history traversal</a>,
    it does not cause a <code id="the-history-interface:event-hashchange"><a href="/breakup/specs/html/#event-hashchange">hashchange</a></code> event to be fired.</p>

   </li><li>

    <p>Set <code id="the-history-interface:dom-history-state-3"><a href="/breakup/specs/browser-dom/#dom-history-state">history.state</a></code> to a <a href="/breakup/specs/core-algorithms/#structured-clone" id="the-history-interface:structured-clone-2">structured clone</a>
    of <var>cloned data</var>.</p> 

   </li><li>

    <p>Let the <a href="/breakup/specs/browser-dom/#latest-entry" id="the-history-interface:latest-entry">latest entry</a> of the <code id="the-history-interface:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> of the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-12">current
    entry</a> be the <a href="/breakup/specs/browser-dom/#current-entry" id="the-history-interface:current-entry-13">current entry</a>.</p>

   </li></ol>

  <p class="note">The <var>title</var> is purely advisory. User agents might use the title
  in the user interface.</p>

  <p>User agents may limit the number of state objects added to the session history per page. If a
  page hits the UA-defined limit, user agents must remove the entry immediately after the first
  entry for that <code id="the-history-interface:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object in the session history after having added the new
  entry. (Thus the state history acts as a FIFO buffer for eviction, but as a LIFO buffer for
  navigation.)</p>

  

  <div class="example">

   <p>Consider a game where the user can navigate along a line, such that the user is always at some
   coordinate, and such that the user can bookmark the page corresponding to a particular
   coordinate, to return to it later.</p>

   <p>A static page implementing the x=5 position in such a game could look like the following:</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;!-- this is http://example.com/line?x=5 --&gt;
&lt;title&gt;Line Game - 5&lt;/title&gt;
&lt;p&gt;You are at coordinate 5 on the line.&lt;/p&gt;
&lt;p&gt;
 &lt;a href="?x=6"&gt;Advance to 6&lt;/a&gt; or
 &lt;a href="?x=4"&gt;retreat to 4&lt;/a&gt;?
&lt;/p&gt;</pre>

   <p>The problem with such a system is that each time the user clicks, the whole page has to be
   reloaded. Here instead is another way of doing it, using script:</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;!-- this starts off as http://example.com/line?x=5 --&gt;
&lt;title&gt;Line Game - 5&lt;/title&gt;
&lt;p&gt;You are at coordinate &lt;span id="coord"&gt;5&lt;/span&gt; on the line.&lt;/p&gt;
&lt;p&gt;
 &lt;a href="?x=6" onclick="go(1); return false;"&gt;Advance to 6&lt;/a&gt; or
 &lt;a href="?x=4" onclick="go(-1); return false;"&gt;retreat to 4&lt;/a&gt;?
&lt;/p&gt;
&lt;script&gt;
 var currentPage = 5; // prefilled by server
 function go(d) {
   setupPage(currentPage + d);
   history.pushState(currentPage, document.title, '?x=' + currentPage);
 }
 onpopstate = function(event) {
   setupPage(event.state);
 }
 function setupPage(page) {
   currentPage = page;
   document.title = 'Line Game - ' + currentPage;
   document.getElementById('coord').textContent = currentPage;
   document.links[0].href = '?x=' + (currentPage+1);
   document.links[0].textContent = 'Advance to ' + (currentPage+1);
   document.links[1].href = '?x=' + (currentPage-1);
   document.links[1].textContent = 'retreat to ' + (currentPage-1);
 }
&lt;/script&gt;</pre>

   <p>In systems without script, this still works like the previous example. However, users that
   <em>do</em> have script support can now navigate much faster, since there is no network access
   for the same experience. Furthermore, contrary to the experience the user would have with just a
   nave script-based approach, bookmarking and navigating the session history still work.</p>

   <p>In the example above, the <var>data</var> argument to the <code id="the-history-interface:dom-history-pushstate-4"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState()</a></code> method is the same information as would be sent
   to the server, but in a more convenient form, so that the script doesn't have to parse the URL
   each time the user navigates.</p>

  </div>

  <div class="example">

   <p>Applications might not use the same title for a <a href="/breakup/specs/browser-dom/#session-history-entry" id="the-history-interface:session-history-entry">session history entry</a> as the
   value of the document's <code id="the-history-interface:the-title-element"><a href="#the-title-element">title</a></code> element at that time. For example, here is a simple
   page that shows a block in the <code id="the-history-interface:the-title-element-2"><a href="#the-title-element">title</a></code> element. Clearly, when navigating backwards to
   a previous state the user does not go back in time, and therefore it would be inappropriate to
   put the time in the session history title.</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;TITLE&gt;Line&lt;/TITLE&gt;
&lt;SCRIPT&gt;
 setInterval(function () { document.title = 'Line - ' + new Date(); }, 1000);
 var i = 1;
 function inc() {
   set(i+1);
   history.pushState(i, 'Line - ' + i);
 }
 function set(newI) {
   i = newI;
   document.forms.F.I.value = newI;
 }
&lt;/SCRIPT&gt;
&lt;BODY ONPOPSTATE="set(event.state)"&gt;
&lt;FORM NAME=F&gt;
State: &lt;OUTPUT NAME=I&gt;1&lt;/OUTPUT&gt; &lt;INPUT VALUE="Increment" TYPE=BUTTON ONCLICK="inc()"&gt;
&lt;/FORM&gt;</pre>

  </div></section>



  <section><h4 id="the-location-interface">6.5.3 The <code id="the-location-interface:location"><a href="/breakup/specs/browser-dom/#location">Location</a></code> interface</h4>

  <p>Each <code id="the-location-interface:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context">browsing context</a>'s session history is
  associated with a unique instance of a <code id="the-location-interface:location-2"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object.</p>

  <dl class="domintro"><dt><var>document</var> . <code id="the-location-interface:dom-document-location"><a href="/breakup/specs/browser-dom/#dom-document-location">location</a></code> [ = <var>value</var> ]</dt><dt><var>window</var> . <code id="the-location-interface:dom-location"><a href="/breakup/specs/browser-dom/#dom-location">location</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns a <code id="the-location-interface:location-3"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object with the current page's location.</p>

    <p>Can be set, to navigate to another page.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-location"><code>location</code></dfn> attribute of the
  <code id="the-location-interface:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> interface must return the <code id="the-location-interface:location-4"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object for that
  <code id="the-location-interface:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, if it is in a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-2">browsing context</a>, and null otherwise.</p>

  <p>The <dfn id="dom-location"><code>location</code></dfn> attribute of the <code id="the-location-interface:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  interface must return the <code id="the-location-interface:location-5"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object for that <code id="the-location-interface:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's
  <code id="the-location-interface:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>

  

  <p><code id="the-location-interface:location-6"><a href="/breakup/specs/browser-dom/#location">Location</a></code> objects provide a representation of <a href="https://dom.spec.whatwg.org/#concept-document-url" id="the-location-interface:the-document's-address" data-x-internal="the-document's-address">the address</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document">active document</a> of their <code id="the-location-interface:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s
  <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-3">browsing context</a>, and allow the <a href="/breakup/specs/browser-dom/#current-entry" id="the-location-interface:current-entry">current entry</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-4">browsing
  context</a>'s session history to be changed, by adding or replacing entries in the <code id="the-location-interface:dom-history"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> object.</p>

  <pre class="idl">[Unforgeable] interface <dfn id="location">Location</dfn> {
  void <a href="/breakup/specs/browser-dom/#dom-location-assign" id="the-location-interface:dom-location-assign">assign</a>(DOMString url);
  void <a href="/breakup/specs/browser-dom/#dom-location-replace" id="the-location-interface:dom-location-replace">replace</a>(DOMString url);
  void <a href="/breakup/specs/browser-dom/#dom-location-reload" id="the-location-interface:dom-location-reload">reload</a>();

  [SameObject] readonly attribute <span>DOMString</span>[] <a href="/breakup/specs/browser-dom/#dom-location-ancestororigins" id="the-location-interface:dom-location-ancestororigins">ancestorOrigins</a>;
};
<a href="/breakup/specs/browser-dom/#location" id="the-location-interface:location-7">Location</a> implements <a href="/breakup/specs/core-algorithms/#urlutils" id="the-location-interface:urlutils">URLUtils</a>;</pre>

  <dl class="domintro"><dt><var>location</var> . <code id="the-location-interface:dom-location-assign-2"><a href="/breakup/specs/browser-dom/#dom-location-assign">assign</a></code>(<var>url</var>)</dt><dd>

    <p>Navigates to the given page.</p>

   </dd><dt><var>location</var> . <code id="the-location-interface:dom-location-replace-2"><a href="/breakup/specs/browser-dom/#dom-location-replace">replace</a></code>(<var>url</var>)</dt><dd>

    <p>Removes the current page from the session history and navigates to the given page.</p>

   </dd><dt><var>location</var> . <code id="the-location-interface:dom-location-reload-2"><a href="/breakup/specs/browser-dom/#dom-location-reload">reload</a></code>()</dt><dd>

    <p>Reloads the current page.</p>

   </dd><dt><var>location</var> . <code id="the-location-interface:dom-location-ancestororigins-2"><a href="/breakup/specs/browser-dom/#dom-location-ancestororigins">ancestorOrigins</a></code></dt><dd>

    <p>Returns an array values are the origins of the ancestor <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-5">browsing contexts</a>, from the <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="the-location-interface:parent-browsing-context">parent browsing context</a> to the
    <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="the-location-interface:top-level-browsing-context">top-level browsing context</a>.</p>

   </dd></dl>

  

  <p>The <i>relevant <code id="the-location-interface:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code></i> is the <code id="the-location-interface:location-8"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's associated
  <code id="the-location-interface:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object's <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-6">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-2">active document</a>.</p>

  <p>When the <dfn id="dom-location-assign"><code>assign(<var>url</var>)</code></dfn>
  method is invoked, the UA must <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-location-interface:resolve-a-url">resolve</a> the argument, relative
  to the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-location-interface:api-base-url">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-location-interface:entry-settings-object">entry settings object</a>, and if that
  is successful, must <a href="#navigate" id="the-location-interface:navigate">navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-7">browsing
  context</a> to the specified <var>url</var>, with <a href="#exceptions-enabled" id="the-location-interface:exceptions-enabled">exceptions enabled</a>. If
  the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-8">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="the-location-interface:session-history">session history</a> contains only one
  <code id="the-location-interface:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, and that was the <code id="the-location-interface:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="the-location-interface:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> created
  when the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-9">browsing context</a> was created, then the navigation must be done with
  <a href="#replacement-enabled" id="the-location-interface:replacement-enabled">replacement enabled</a>.</p> 

  <p>When the <dfn id="dom-location-replace"><code>replace(<var>url</var>)</code></dfn> method is invoked, the UA must <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-location-interface:resolve-a-url-2">resolve</a> the argument, relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-location-interface:api-base-url-2">API base URL</a> specified by the
  <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-location-interface:entry-settings-object-2">entry settings object</a>, and if that is successful, <a href="#navigate" id="the-location-interface:navigate-2">navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-10">browsing context</a> to the specified <var>url</var> with <a href="#replacement-enabled" id="the-location-interface:replacement-enabled-2">replacement enabled</a> and <a href="#exceptions-enabled" id="the-location-interface:exceptions-enabled-2">exceptions enabled</a>.</p>

  <p>Navigation for the <code id="the-location-interface:dom-location-assign-3"><a href="/breakup/specs/browser-dom/#dom-location-assign">assign()</a></code> and <code id="the-location-interface:dom-location-replace-3"><a href="/breakup/specs/browser-dom/#dom-location-replace">replace()</a></code> methods must be done with the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="the-location-interface:responsible-browsing-context">responsible
  browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="the-location-interface:incumbent-settings-object">incumbent settings object</a> as the
  <a href="#source-browsing-context" id="the-location-interface:source-browsing-context">source browsing context</a>.</p>

  <p>If the <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-location-interface:resolve-a-url-3">resolving</a> step of the <code id="the-location-interface:dom-location-assign-4"><a href="/breakup/specs/browser-dom/#dom-location-assign">assign()</a></code> and <code id="the-location-interface:dom-location-replace-4"><a href="/breakup/specs/browser-dom/#dom-location-replace">replace()</a></code> methods is not successful, then the user agent must
  instead throw a <code id="the-location-interface:syntaxerror"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception.</p>

  <p>When the <dfn id="dom-location-reload"><code>reload()</code></dfn> method is invoked, the
  user agent must run the appropriate steps from the following list:</p>

  <dl class="switch"><dt>If the currently executing <a href="/breakup/specs/browser-dom/#concept-task" id="the-location-interface:concept-task">task</a> is the dispatch of a <code id="the-location-interface:event-resize"><a href="/breakup/specs/core-algorithms/#event-resize">resize</a></code> event in response to the user resizing the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-11">browsing
   context</a></dt><dd><p>Repaint the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-12">browsing context</a> and abort these steps.</p></dd><dt>If the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-13">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-3">active document</a> is <a href="#an-iframe-srcdoc-document" id="the-location-interface:an-iframe-srcdoc-document">an
   <code>iframe</code> <code>srcdoc</code> document</a></dt><dd><p><a href="#process-the-iframe-attributes" id="the-location-interface:process-the-iframe-attributes">Reprocess the <code>iframe</code>
   attributes</a> of the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-14">browsing context</a>'s <a href="/breakup/specs/browser-dom/#browsing-context-container" id="the-location-interface:browsing-context-container">browsing context
   container</a>.</p></dd><dt>If the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-15">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-4">active document</a> has its <a href="/breakup/specs/browser-dom/#reload-override-flag" id="the-location-interface:reload-override-flag">reload
   override flag</a> set</dt><dd><p>Perform <a href="/breakup/specs/browser-dom/#an-overridden-reload" id="the-location-interface:an-overridden-reload">an overridden reload</a>, with the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-16">browsing context</a> being
   navigated as the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="the-location-interface:responsible-browsing-context-2">responsible browsing context</a>.</p></dd><dt>Otherwise</dt><dd><p><a href="#navigate" id="the-location-interface:navigate-3">Navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-17">browsing context</a> to
   <a id="the-location-interface:the-document's-address-2" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a> with <a href="#replacement-enabled" id="the-location-interface:replacement-enabled-3">replacement enabled</a> and <a href="#exceptions-enabled" id="the-location-interface:exceptions-enabled-3">exceptions
   enabled</a>. The <a href="#source-browsing-context" id="the-location-interface:source-browsing-context-2">source browsing context</a> must be the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-18">browsing
   context</a> being navigated. This is a <a href="#reload-triggered-navigation" id="the-location-interface:reload-triggered-navigation">reload-triggered navigation</a>.</p></dd></dl>

  <p>When a user requests that the <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-5">active document</a> of a <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-19">browsing context</a>
  be reloaded through a user interface element, the user agent should <a href="#navigate" id="the-location-interface:navigate-4">navigate</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-20">browsing context</a> to the same resource as that
  <code id="the-location-interface:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, with <a href="#replacement-enabled" id="the-location-interface:replacement-enabled-4">replacement enabled</a>. In the case of non-idempotent
  methods (e.g. HTTP POST), the user agent should prompt the user to confirm the operation first,
  since otherwise transactions (e.g. purchases or database modifications) could be repeated. User
  agents may allow the user to explicitly override any caches when reloading. If <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-21">browsing
  context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-6">active document</a>'s <a href="/breakup/specs/browser-dom/#reload-override-flag" id="the-location-interface:reload-override-flag-2">reload override flag</a> is set, then the
  user agent may instead perform <a href="/breakup/specs/browser-dom/#an-overridden-reload" id="the-location-interface:an-overridden-reload-2">an overridden reload</a> rather than the navigation
  described in this paragraph (with the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-22">browsing context</a> being reloaded as the
  <a href="#source-browsing-context" id="the-location-interface:source-browsing-context-3">source browsing context</a>).</p>

  <hr>

  

  

  <p>The <code id="the-location-interface:location-9"><a href="/breakup/specs/browser-dom/#location">Location</a></code> interface also supports the <code id="the-location-interface:urlutils-2"><a href="/breakup/specs/core-algorithms/#urlutils">URLUtils</a></code> interface. <a href="#refsURL">[URL]</a></p>

  

  <p>When the object is created, and whenever the <a href="https://dom.spec.whatwg.org/#concept-document-url" id="the-location-interface:the-document's-address-3" data-x-internal="the-document's-address">the
  address</a> of the <i>relevant <code id="the-location-interface:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code></i> changes, the user agent must invoke
  the object's <code id="the-location-interface:urlutils-3"><a href="/breakup/specs/core-algorithms/#urlutils">URLUtils</a></code> interface's <a href="/breakup/specs/core-algorithms/#concept-uu-set-the-input" id="the-location-interface:concept-uu-set-the-input">set the
  input</a> algorithm with <a href="https://dom.spec.whatwg.org/#concept-document-url" id="the-location-interface:the-document's-address-4" data-x-internal="the-document's-address">the address</a> of the
  <i>relevant <code id="the-location-interface:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code></i> as the given value.</p>

  <p>The object's <code id="the-location-interface:urlutils-4"><a href="/breakup/specs/core-algorithms/#urlutils">URLUtils</a></code> interface's <a href="/breakup/specs/core-algorithms/#concept-uu-get-the-base" id="the-location-interface:concept-uu-get-the-base">get the
  base</a> algorithm must return the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-location-interface:api-base-url-3">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-location-interface:entry-settings-object-3">entry
  settings object</a>, if there is one, or null otherwise.</p>

  <p>The object's <code id="the-location-interface:urlutils-5"><a href="/breakup/specs/core-algorithms/#urlutils">URLUtils</a></code> interface's <a href="/breakup/specs/core-algorithms/#concept-uu-query-encoding" id="the-location-interface:concept-uu-query-encoding">query
  encoding</a> is the <a href="/breakup/specs/core-algorithms/#document's-character-encoding" id="the-location-interface:document's-character-encoding">document's character encoding</a>.</p>

  <p>When the object's <code id="the-location-interface:urlutils-6"><a href="/breakup/specs/core-algorithms/#urlutils">URLUtils</a></code> interface invokes its <a href="/breakup/specs/core-algorithms/#concept-uu-update" id="the-location-interface:concept-uu-update">update steps</a> with the string <var>value</var>, the
  user agent must run the following steps:</p>

  <ol><li>

    <p>If any of the following conditions are met, let <var>mode</var> be <i>normal
    navigation</i>; otherwise, let it be <i>replace navigation</i>:</p>

    <ul class="brief"><li>The <code id="the-location-interface:location-10"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's <i>relevant <code id="the-location-interface:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code></i> has
     <a href="#completely-loaded" id="the-location-interface:completely-loaded">completely loaded</a>, or</li><li>In the <a href="/breakup/specs/browser-dom/#concept-task" id="the-location-interface:concept-task-2">task</a> in which the algorithm is running, an
     <a href="#activation-behaviour" id="the-location-interface:activation-behaviour">activation behaviour</a> is currently being processed whose <code id="the-location-interface:event-click"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> event was <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="the-location-interface:concept-events-trusted">trusted</a>, or</li><li>In the <a href="/breakup/specs/browser-dom/#concept-task" id="the-location-interface:concept-task-3">task</a> in which the algorithm is running, the event
     listener for a <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="the-location-interface:concept-events-trusted-2">trusted</a> <code id="the-location-interface:event-click-2"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> event is being handled.</li></ul>

   </li><li><p>If <var>mode</var> is <i>normal navigation</i>, then act as if the <code id="the-location-interface:dom-location-assign-5"><a href="/breakup/specs/browser-dom/#dom-location-assign">assign()</a></code> method had been called with <var>value</var> as its argument. Otherwise, act as if the <code id="the-location-interface:dom-location-replace-5"><a href="/breakup/specs/browser-dom/#dom-location-replace">replace()</a></code> method had been called with <var>value</var> as its argument.</p></li></ol>

  <hr>

  <p>The <dfn id="dom-location-ancestororigins"><code>ancestorOrigins</code></dfn> attribute, on
  getting, must return a <a href="/breakup/specs/core-algorithms/#dfn-read-only-array" id="the-location-interface:dfn-read-only-array">read only</a> array whose values are
  determined as follows. The same object must be returned each time the attribute's value is
  obtained for any particular <code id="the-location-interface:location-11"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object.</p>

  <ol><li><p>Let <var>output</var> be an empty ordered list of strings.</p>

   </li><li><p>Let <var>current</var> be the <a href="/breakup/specs/browser-dom/#browsing-context" id="the-location-interface:browsing-context-23">browsing context</a> of the <code id="the-location-interface:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
   with which the <code id="the-location-interface:location-12"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object is associated.</p></li><li><p><i>Loop</i>: If <var>current</var> has no <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="the-location-interface:parent-browsing-context-2">parent browsing context</a>, jump to
   the step labeled <i>end</i>.</p></li><li><p>Let <var>current</var> be <var>current</var>'s <a href="/breakup/specs/browser-dom/#parent-browsing-context" id="the-location-interface:parent-browsing-context-3">parent browsing
   context</a>.</p></li><li><p>Append the <a href="/breakup/specs/browser-dom/#unicode-serialisation-of-an-origin" id="the-location-interface:unicode-serialisation-of-an-origin">Unicode serialisation</a>
   of <var>current</var>'s <a href="/breakup/specs/browser-dom/#active-document" id="the-location-interface:active-document-7">active document</a>'s <a href="/breakup/specs/browser-dom/#origin-2" id="the-location-interface:origin-2">origin</a> to <var>output</var>
   as a new value.</p></li><li><p>Return to the step labeled <i>loop</i>.</p></li><li><p><i>End</i>: Let <var>output</var> be the values of the array, in the same order.</p></li></ol>

  




  

  <section><h5 id="security-location">6.5.3.1 Security</h5>

  <p class="critical">This section describes a security model that is underdefined, imperfect, and
  does not match implementations. Work is ongoing to attempt to resolve this, but in the meantime,
  please do not rely on this section for precision. Implementors are urged to send their feedback on
  how cross-origin cross-global access to <code id="security-location:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> and <code id="security-location:location"><a href="/breakup/specs/browser-dom/#location">Location</a></code> objects
  should work. See <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=20701">bug 20701</a>.</p>

  <p id="security-3">User agents must throw a <code id="security-location:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception whenever any
  properties of a <code id="security-location:location-2"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object are accessed when the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="security-location:entry-settings-object">entry settings
  object</a> specifies an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin">effective script origin</a> that is not the <a href="/breakup/specs/browser-dom/#same-origin" id="security-location:same-origin">same</a> as the <code id="security-location:location-3"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's associated <code id="security-location:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s
  <a href="/breakup/specs/browser-dom/#browsing-context" id="security-location:browsing-context">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="security-location:active-document">active document</a>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-2">effective script
  origin</a>, with the following exceptions:</p>

  <ul><li>The <code id="security-location:dom-url-href"><a href="/breakup/specs/core-algorithms/#dom-url-href">href</a></code> setter, if the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="security-location:responsible-browsing-context">responsible browsing
   context</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="security-location:entry-settings-object-2">entry settings object</a> is <a href="/breakup/specs/browser-dom/#familiar-with" id="security-location:familiar-with">familiar with</a>
   the <a href="/breakup/specs/browser-dom/#browsing-context" id="security-location:browsing-context-2">browsing context</a> with which the <code id="security-location:location-4"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object is associated

   </li><li>The <code id="security-location:dom-location-replace"><a href="/breakup/specs/browser-dom/#dom-location-replace">replace()</a></code> method, if the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="security-location:responsible-browsing-context-2">responsible
   browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="security-location:entry-settings-object-3">entry settings object</a> is <a href="/breakup/specs/browser-dom/#familiar-with" id="security-location:familiar-with-2">familiar
   with</a> the <a href="/breakup/specs/browser-dom/#browsing-context" id="security-location:browsing-context-3">browsing context</a> with which the <code id="security-location:location-5"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object is
   associated

   </li><li>Any properties not defined in the IDL for the <code id="security-location:location-6"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object or indirectly via
   one of those properties (e.g. <code>toString()</code>, which is defined via the <code>stringifier</code> keyword), if the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-3">effective script origin</a> specified by
   the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="security-location:entry-settings-object-4">entry settings object</a> is the <a href="/breakup/specs/browser-dom/#same-origin" id="security-location:same-origin-2">same origin</a> as the
   <code id="security-location:location-7"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's associated <code id="security-location:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-4">effective script
   origin</a>

  </li></ul>

  <p>When the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-5">effective script origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="security-location:entry-settings-object-5">entry settings
  object</a> is different than a <code id="security-location:location-8"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's associated
  <code id="security-location:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-6">effective script origin</a>, the user agent must act as if any
  changes to that <code id="security-location:location-9"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's properties, getters, setters, etc, were not
  present, and as if all the properties of that <code id="security-location:location-10"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object had their
  [[Enumerable]] attribute set to false.</p>

  <p>For members that return objects (including function objects), each distinct <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-7">effective
  script origin</a> that is not the <a href="/breakup/specs/browser-dom/#same-origin" id="security-location:same-origin-3">same origin</a> as the <code id="security-location:location-11"><a href="/breakup/specs/browser-dom/#location">Location</a></code>
  object's <code id="security-location:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="security-location:effective-script-origin-8">effective script origin</a> must be provided with a
  separate set of objects. These objects must have the prototype chain appropriate for the script
  for which the objects are created (not those that would be appropriate for scripts whose
  <a href="/breakup/specs/browser-dom/#settings-object" id="security-location:settings-object">settings object</a> specifies a <a href="/breakup/specs/browser-dom/#global-object" id="security-location:global-object">global object</a> that is the
  <code id="security-location:location-12"><a href="/breakup/specs/browser-dom/#location">Location</a></code> object's <code id="security-location:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <code id="security-location:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object).</p></section></section>

  



  

  <section><h4 id="history-notes">6.5.4 Implementation notes for session history</h4>
  

  <p><i>This section is non-normative.</i></p>

  <p>The <code id="history-notes:history-3"><a href="/breakup/specs/browser-dom/#history-3">History</a></code> interface is not meant to place restrictions on how implementations
  represent the session history to the user.</p>

  <p>For example, session history could be implemented in a tree-like manner, with each page having
  multiple "forward" pages. This specification doesn't define how the linear list of pages in the
  <code id="history-notes:dom-history"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> object are derived from the actual session history as
  seen from the user's perspective.</p>

  <p>Similarly, a page containing two <code id="history-notes:the-iframe-element"><a href="#the-iframe-element">iframe</a></code>s has a <code id="history-notes:dom-history-2"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> object distinct from the <code id="history-notes:the-iframe-element-2"><a href="#the-iframe-element">iframe</a></code>s' <code id="history-notes:dom-history-3"><a href="/breakup/specs/browser-dom/#dom-history">history</a></code> objects, despite the fact that typical Web browsers present the
  user with just one "Back" button, with a session history that interleaves the navigation of the
  two inner frames and the outer page.</p>


  <p><strong>Security</strong>: It is suggested that to avoid letting a page "hijack" the history
  navigation facilities of a UA by abusing <code id="history-notes:dom-history-pushstate"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState()</a></code>,
  the UA provide the user with a way to jump back to the previous page (rather than just going back
  to the previous state). For example, the back button could have a drop down showing just the pages
  in the session history, and not showing any of the states. Similarly, an aural browser could have
  two "back" commands, one that goes back to the previous state, and one that jumps straight back to
  the previous page.</p>

  <p>In addition, a user agent could ignore calls to <code id="history-notes:dom-history-pushstate-2"><a href="/breakup/specs/browser-dom/#dom-history-pushstate">pushState()</a></code> that are invoked on a timer, or from event
  listeners that are not triggered in response to a clear user action, or that are invoked in rapid
  succession.</p></section></section><section><h3 id="scripting">7.1 Scripting</h3>

  <section><h4 id="introduction-11">7.1.1 Introduction</h4>

  <p>Various mechanisms can cause author-provided executable code to run in the context of a
  document. These mechanisms include, but are probably not limited to:</p>

  <ul><li>Processing of <code id="introduction-11:the-script-element"><a href="#the-script-element">script</a></code> elements.</li><li>Navigating to <a href="#javascript-protocol" id="introduction-11:javascript-protocol"><code>javascript:</code> URLs</a>.</li><li>Event handlers, whether registered through the DOM using <code>addEventListener()</code>, by explicit <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="introduction-11:event-handler-content-attributes">event handler content attributes</a>, by
   <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="introduction-11:event-handler-idl-attributes">event handler IDL attributes</a>, or otherwise.</li><li>Processing of technologies like SVG that have their own scripting features.</li></ul></section>


  

  <section><h4 id="enabling-and-disabling-scripting">7.1.2 Enabling and disabling scripting</h4>

  <p><dfn id="concept-bc-script">Scripting is enabled</dfn> in a <em><a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context">browsing
  context</a></em> when all of the following conditions are true:</p>

  <ul><li>The user agent supports scripting.</li><li>The user has not disabled scripting for this <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-2">browsing context</a> at this time.
   (User agents may provide users with the option to disable scripting globally, or in a
   finer-grained manner, e.g. on a per-origin basis.)
   <a href="/breakup/specs/html/#fingerprinting-vector" id="enabling-and-disabling-scripting:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
   </li><li id="sandboxScriptBlocked">The <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-3">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="enabling-and-disabling-scripting:active-document">active document</a>'s
   <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="enabling-and-disabling-scripting:active-sandboxing-flag-set">active sandboxing flag set</a> does not have its <a href="/breakup/specs/browser-dom/#sandboxed-scripts-browsing-context-flag" id="enabling-and-disabling-scripting:sandboxed-scripts-browsing-context-flag">sandboxed scripts browsing
   context flag</a> set.</li></ul>

  <p><dfn id="concept-bc-noscript">Scripting is disabled</dfn> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-4">browsing context</a>
  when any of the above conditions are false (i.e. when scripting is not <a href="/breakup/specs/browser-dom/#concept-bc-script" id="enabling-and-disabling-scripting:concept-bc-script">enabled</a>).</p>

  <hr>

  <p><dfn id="concept-n-script">Scripting is enabled</dfn> for a <em>node</em> if the
  <code id="enabling-and-disabling-scripting:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object of the node (the node itself, if it is itself a <code id="enabling-and-disabling-scripting:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
  object) has an associated <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-5">browsing context</a>, and <a href="/breakup/specs/browser-dom/#concept-bc-script" id="enabling-and-disabling-scripting:concept-bc-script-2">scripting is enabled</a> in that <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-6">browsing context</a>.</p>

  <p><dfn id="concept-n-noscript">Scripting is disabled</dfn> for a node if there is no such
  <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-7">browsing context</a>, or if <a href="/breakup/specs/browser-dom/#concept-bc-noscript" id="enabling-and-disabling-scripting:concept-bc-noscript">scripting is
  disabled</a> in that <a href="/breakup/specs/browser-dom/#browsing-context" id="enabling-and-disabling-scripting:browsing-context-8">browsing context</a>.</p></section>

  


  

  
  <section><h4 id="processing-model-8">7.1.3 Processing model</h4>

  <section><h5 id="definitions-2">7.1.3.1 Definitions</h5>

  <p>This specification describes three kinds of <a href="/breakup/specs/core-algorithms/#javascript-global-environment" id="definitions-2:javascript-global-environment">JavaScript global environments</a>: the <dfn id="document-environment">document environment</dfn>, the
  <dfn id="dedicated-worker-environment">dedicated worker environment</dfn>, and the <dfn id="shared-worker-environment">shared worker environment</dfn>. The
  <a href="/breakup/specs/browser-dom/#dedicated-worker-environment" id="definitions-2:dedicated-worker-environment">dedicated worker environment</a> and the <a href="/breakup/specs/browser-dom/#shared-worker-environment" id="definitions-2:shared-worker-environment">shared worker environment</a> are both
  types of <dfn id="worker-environment">worker environments</dfn>.</p>

  <p>Except where otherwise specified, a <a href="/breakup/specs/core-algorithms/#javascript-global-environment" id="definitions-2:javascript-global-environment-2">JavaScript global environment</a> is a
  <a href="/breakup/specs/browser-dom/#document-environment" id="definitions-2:document-environment">document environment</a>.</p> 

  <hr>

  <p>A <dfn id="concept-script">script</dfn> has:</p>

  <dl><dt>A <dfn id="code-entry-point">code entry-point</dfn></dt><dd>

    <p>A code entry-point represents a block of executable code that the script exposes to other
    scripts and to the user agent. Typically, the code corresponding to the code entry-point is
    executed immediately after the script is parsed, but for event handlers, it is called each time
    the handler is invoked.</p>

    <p class="example">In JavaScript <code id="definitions-2:the-script-element"><a href="#the-script-element">script</a></code> blocks, this corresponds to the execution
    context of the global code.</p>

   </dd><dt>Optionally, a <dfn id="muted-errors">muted errors</dfn> flag</dt><dd>

    <p>A flag which, if set, means that error information will not be provided for errors in this
    script (used to mute errors for cross-origin scripts, since that can leak private
    information).</p>

   </dd><dt>A <dfn id="settings-object">settings object</dfn></dt><dd>

    <p>An <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object">environment settings object</a>, various settings that are shared with other scripts in
    the same context.</p>

   </dd></dl>

  <hr>

  <p>An <dfn id="environment-settings-object">environment settings object</dfn> specifies algorithms for obtaining the following:</p>

  <dl><dt>A <dfn id="script-execution-environment">script execution environment</dfn> for each language supported by the user agent</dt><dd>

    <p>The characteristics of the script execution environment depend on the language, and are not
    defined by this specification.</p>

    <p class="example">In JavaScript, the script execution environment consists of the interpreter,
    the stack of <i>execution contexts</i>, the <i>global code</i> and <i>function code</i> and the
    <code id="definitions-2:idl-function"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code> objects resulting, and so forth.</p>

   </dd><dt>A <dfn id="global-object">global object</dfn></dt><dd>

    <p>An object that provides the APIs that can be called by the code in scripts that use this
    <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-2">settings object</a>.</p>

    <p class="note">This is typically a <code id="definitions-2:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object or a
    <code id="definitions-2:workerglobalscope"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object. When a <a href="/breakup/specs/browser-dom/#global-object" id="definitions-2:global-object">global object</a> is an empty object, it
    can't do anything that interacts with the environment.</p>

    <p>If the <a href="/breakup/specs/browser-dom/#global-object" id="definitions-2:global-object-2">global object</a> is a <code id="definitions-2:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, then, in JavaScript, the
    ThisBinding of the global execution context for this script must be the <code id="definitions-2:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
    object's <code id="definitions-2:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object, rather than the global object. <a href="#refsECMA262">[ECMA262]</a></p>

    <p class="note">This is a <a href="/breakup/specs/html/#willful-violation" id="definitions-2:willful-violation">willful violation</a> of the JavaScript specification current
    at the time of writing (ECMAScript edition 5, as defined in section 10.4.1.1 Initial Global
    Execution Context, step 3). The JavaScript specification requires that the <code>this</code> keyword in the global scope return the global object, but this is not
    compatible with the security design prevalent in implementations as specified herein. <a href="#refsECMA262">[ECMA262]</a></p>

   </dd><dt>A <dfn id="responsible-browsing-context">responsible browsing context</dfn></dt><dd>

    <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-2:browsing-context">browsing context</a> that is assigned responsibility for actions taken by the
    scripts that use this <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-3">environment settings object</a>.</p>

    <p class="example">When a script creates and <a href="#navigate" id="definitions-2:navigate">navigates</a> a new
    <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="definitions-2:top-level-browsing-context">top-level browsing context</a>, the <code id="definitions-2:dom-opener"><a href="/breakup/specs/browser-dom/#dom-opener">opener</a></code> attribute
    of the new <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-2:browsing-context-2">browsing context</a>'s <code id="definitions-2:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object will be set to the
    <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="definitions-2:responsible-browsing-context">responsible browsing context</a>'s <code id="definitions-2:windowproxy-2"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> object.</p>

   </dd><dt>A <dfn id="responsible-event-loop">responsible event loop</dfn></dt><dd>

    <p>An <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-2:event-loop">event loop</a> that is used when it would not be immediately clear what event
    loop to use.</p>

   </dd><dt>A <dfn id="responsible-document">responsible document</dfn></dt><dd>

    <p>A <code id="definitions-2:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that is assigned responsibility for actions taken by the scripts that
    use this <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-4">environment settings object</a>.</p>

    <p class="example">For example, the <a href="https://dom.spec.whatwg.org/#concept-document-url" id="definitions-2:the-document's-address" data-x-internal="the-document's-address">address</a> of the
    <a href="/breakup/specs/browser-dom/#responsible-document" id="definitions-2:responsible-document">responsible document</a> is used to set the <a href="https://dom.spec.whatwg.org/#concept-document-url" id="definitions-2:the-document's-address-2" data-x-internal="the-document's-address">address</a> of the <code id="definitions-2:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> after it has been reset using <code id="definitions-2:dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code>.</p>

    <p>If the <a href="/breakup/specs/browser-dom/#responsible-event-loop" id="definitions-2:responsible-event-loop">responsible event loop</a> is not a <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-2:browsing-context-3">browsing context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-2:event-loop-2">event loop</a>,
    then the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-5">environment settings object</a> has no <a href="/breakup/specs/browser-dom/#responsible-document" id="definitions-2:responsible-document-2">responsible document</a>.</p>

   </dd><dt>A <dfn id="referrer-source">referrer source</dfn></dt><dd>

    <p>Either a <code id="definitions-2:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> (specifically, the <a href="/breakup/specs/browser-dom/#responsible-document" id="definitions-2:responsible-document-3">responsible document</a>), or a
    <a href="/breakup/specs/core-algorithms/#url" id="definitions-2:url">URL</a>, which is used by some APIs to determine what value to use for the <code id="definitions-2:http-referer"><a href="/breakup/specs/core-algorithms/#http-referer">Referer</a></code> (sic) header in calls to the <a href="/breakup/specs/core-algorithms/#fetch" id="definitions-2:fetch">fetching</a> algorithm.</p>

   </dd><dt>An <dfn id="api-url-character-encoding">API URL character encoding</dfn></dt><dd>

    <p>A character encoding used to encode URLs by APIs called by scripts that use this <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-6">environment
    settings object</a>.</p>

   </dd><dt>An <dfn id="api-base-url">API base URL</dfn></dt><dd>

    <p>An <a href="/breakup/specs/core-algorithms/#absolute-url" id="definitions-2:absolute-url">absolute URL</a> used by APIs called by scripts that use this <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-7">environment
    settings object</a> to resolve <a href="/breakup/specs/core-algorithms/#relative-url" id="definitions-2:relative-url">relative URLs</a>.</p>

   </dd><dt>An <a href="/breakup/specs/browser-dom/#origin-2" id="definitions-2:origin-2">origin</a> and an <a href="/breakup/specs/browser-dom/#effective-script-origin" id="definitions-2:effective-script-origin">effective script origin</a></dt><dd>

    <p>An instrument used in security checks.</p>

   </dd></dl>

  <p>The <dfn id="relevant-settings-object-for-a-global-object">relevant settings object for a global object</dfn> <var>o</var> is the
  <a href="/breakup/specs/browser-dom/#environment-settings-object" id="definitions-2:environment-settings-object-8">environment settings object</a> whose <a href="/breakup/specs/browser-dom/#global-object" id="definitions-2:global-object-3">global object</a> is <var>o</var>.
  (There is always a 1:1 mapping of global objects to environment settings objects.)</p>

  <p>The <dfn id="relevant-settings-object-for-a-script">relevant settings object for a script</dfn> <var>s</var> is the
  <a href="/breakup/specs/browser-dom/#settings-object" id="definitions-2:settings-object">settings object</a> of <var>s</var>.</p></section>



  <section><h5 id="script-settings-for-browsing-contexts">7.1.3.2 Script settings for browsing contexts</h5>

  <p>Whenever a new <code id="script-settings-for-browsing-contexts:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object is created, it must also create an <a href="/breakup/specs/browser-dom/#environment-settings-object" id="script-settings-for-browsing-contexts:environment-settings-object">environment
  settings object</a> whose algorithms are defined as follows:</p>

  <dl><dt>The <a href="/breakup/specs/browser-dom/#script-execution-environment" id="script-settings-for-browsing-contexts:script-execution-environment">script execution environments</a></dt><dd>

    <p>When the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="script-settings-for-browsing-contexts:environment-settings-object-2">environment settings object</a> is created, for each language supported by the
    user agent, create an appropriate execution environment as defined by the relevant
    specification.</p>

    <p>When a <a href="/breakup/specs/browser-dom/#script-execution-environment" id="script-settings-for-browsing-contexts:script-execution-environment-2">script execution environment</a> is needed, return the appropriate one from
    those created when the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="script-settings-for-browsing-contexts:environment-settings-object-3">environment settings object</a> was created.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#global-object" id="script-settings-for-browsing-contexts:global-object">global object</a></dt><dd>

    <p>Return the <code id="script-settings-for-browsing-contexts:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object itself.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="script-settings-for-browsing-contexts:responsible-browsing-context">responsible browsing context</a></dt><dd>

    <p>Return the <a href="/breakup/specs/browser-dom/#browsing-context" id="script-settings-for-browsing-contexts:browsing-context">browsing context</a> with which the <code id="script-settings-for-browsing-contexts:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object is
    associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#responsible-event-loop" id="script-settings-for-browsing-contexts:responsible-event-loop">responsible event loop</a></dt><dd>

    <p>Return the <a href="/breakup/specs/browser-dom/#event-loop" id="script-settings-for-browsing-contexts:event-loop">event loop</a> that is associated with the <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="script-settings-for-browsing-contexts:unit-of-related-similar-origin-browsing-contexts">unit of related
    similar-origin browsing contexts</a> to which the <code id="script-settings-for-browsing-contexts:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <a href="/breakup/specs/browser-dom/#browsing-context" id="script-settings-for-browsing-contexts:browsing-context-2">browsing
    context</a> belongs.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#responsible-document" id="script-settings-for-browsing-contexts:responsible-document">responsible document</a></dt><dd>

    <p>Return the <code id="script-settings-for-browsing-contexts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the <code id="script-settings-for-browsing-contexts:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently
    associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#referrer-source" id="script-settings-for-browsing-contexts:referrer-source">referrer source</a></dt><dd>

    <p>Return the <code id="script-settings-for-browsing-contexts:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the <code id="script-settings-for-browsing-contexts:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently
    associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#api-url-character-encoding" id="script-settings-for-browsing-contexts:api-url-character-encoding">API URL character encoding</a></dt><dd>

    <p>Return the current <a href="/breakup/specs/core-algorithms/#document's-character-encoding" id="script-settings-for-browsing-contexts:document's-character-encoding">character encoding</a> of
    the <code id="script-settings-for-browsing-contexts:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the <code id="script-settings-for-browsing-contexts:window-7"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#api-base-url" id="script-settings-for-browsing-contexts:api-base-url">API base URL</a></dt><dd>

    <p>Return the current <a href="/breakup/specs/core-algorithms/#document-base-url" id="script-settings-for-browsing-contexts:document-base-url">base URL</a> of the
    <code id="script-settings-for-browsing-contexts:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the <code id="script-settings-for-browsing-contexts:window-8"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#origin-2" id="script-settings-for-browsing-contexts:origin-2">origin</a></dt><dd>

    <p>Return the <a href="/breakup/specs/browser-dom/#origin-2" id="script-settings-for-browsing-contexts:origin-2-2">origin</a> of the <code id="script-settings-for-browsing-contexts:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the
    <code id="script-settings-for-browsing-contexts:window-9"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently associated.</p>

   </dd><dt>The <a href="/breakup/specs/browser-dom/#effective-script-origin" id="script-settings-for-browsing-contexts:effective-script-origin">effective script origin</a></dt><dd>

    <p>Return the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="script-settings-for-browsing-contexts:effective-script-origin-2">effective script origin</a> of the <code id="script-settings-for-browsing-contexts:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> with which the
    <code id="script-settings-for-browsing-contexts:window-10"><a href="/breakup/specs/browser-dom/#window">Window</a></code> is currently associated.</p>

   </dd></dl></section>




  <section><h5 id="calling-scripts">7.1.3.3 Calling scripts</h5>

  <p>Each <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="calling-scripts:unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</a> has a <dfn id="stack-of-script-settings-objects">stack of script
  settings objects</dfn>, which must be initially empty. When a new <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object">environment settings
  object</a> is <i>pushed</i> onto this stack, the specified <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-2">environment settings object</a>
  is to be added to the stack; when the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-3">environment settings object</a> on this stack that was
  most recently pushed onto it is to be <i>popped</i> from the stack, it must be removed. Entries on
  this stack can be labeled as <dfn id="candidate-entry-settings-object">candidate entry
  settings objects</dfn>.</p>

  <p>When a user agent is to <dfn id="jump-to-a-code-entry-point">jump to a code entry-point</dfn> for a <a href="/breakup/specs/browser-dom/#concept-script" id="calling-scripts:concept-script">script</a> <var>s</var>, the user agent must run the
  following steps:</p>

  <ol><li><p>Let <var>context</var> be the <a href="/breakup/specs/browser-dom/#settings-object" id="calling-scripts:settings-object">settings object</a> of <var>s</var>.</p></li><li><p><a href="/breakup/specs/browser-dom/#prepare-to-run-a-callback" id="calling-scripts:prepare-to-run-a-callback">Prepare to run a callback</a> with <var>context</var> as the
   <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-4">environment settings object</a>. If this returns "do not run" then abort these
   steps.</p></li><li><p>Make the appropriate <a href="/breakup/specs/browser-dom/#script-execution-environment" id="calling-scripts:script-execution-environment">script execution environment</a> specified by <var>context</var> execute the <var>s</var>'s <a href="/breakup/specs/browser-dom/#code-entry-point" id="calling-scripts:code-entry-point">code
   entry-point</a>.</p></li><li><p><a href="/breakup/specs/browser-dom/#clean-up-after-running-a-callback" id="calling-scripts:clean-up-after-running-a-callback">Clean up after running a callback</a>.</p></li></ol>

  <p>The steps to <dfn id="prepare-to-run-a-callback">prepare to run a callback</dfn> with an <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-5">environment settings object</a>
  <var>o</var> are as follows. They return either "run" or "do not run".</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#global-object" id="calling-scripts:global-object">global object</a> specified by <var>o</var> is a
   <code id="calling-scripts:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object whose <code id="calling-scripts:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is not <a href="/breakup/specs/browser-dom/#fully-active" id="calling-scripts:fully-active">fully active</a>,
   then return "do not run" and abort these steps.</p>

   </li><li><p>If <a href="/breakup/specs/browser-dom/#concept-bc-noscript" id="calling-scripts:concept-bc-noscript">scripting is disabled</a> for the
   <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="calling-scripts:responsible-browsing-context">responsible browsing context</a> specified by <var>o</var>, then return "do
   not run" and abort these steps.</p>

   </li><li><p>Push <var>o</var> onto the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects">stack of script settings objects</a>, and
   label it as a <a href="/breakup/specs/browser-dom/#candidate-entry-settings-object" id="calling-scripts:candidate-entry-settings-object">candidate entry settings object</a>.</p></li><li><p>Return "run".</p></li></ol>

  <p>The steps to <dfn id="clean-up-after-running-a-callback">clean up after running a callback</dfn> are as follows:</p>

  <ol><li><p>Pop the current <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="calling-scripts:incumbent-settings-object">incumbent settings object</a> from the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-2">stack of script
   settings objects</a>.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-3">stack of script settings objects</a> is now empty, <a href="/breakup/specs/browser-dom/#run-the-global-script-clean-up-jobs" id="calling-scripts:run-the-global-script-clean-up-jobs">run the global
   script clean-up jobs</a>. (These cannot run scripts.)</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-4">stack of script settings objects</a> is now empty, <a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="calling-scripts:perform-a-microtask-checkpoint">perform a
   microtask checkpoint</a>. (If this runs scripts, these algorithms will be invoked
   reentrantly.)</p></li></ol>

  <p class="note">These algorithms are not invoked by one script directly calling another, but they
  can be invoked reentrantly in an indirect manner, e.g. if a script dispatches an event which has
  event listeners registered.</p>

  <p>When a JavaScript <i>SourceElements</i> production is to be evaluated, the <a href="/breakup/specs/browser-dom/#settings-object" id="calling-scripts:settings-object-2">settings
  object</a> of the <a href="/breakup/specs/browser-dom/#concept-script" id="calling-scripts:concept-script-2">script</a> corresponding to that
  <i>SourceElements</i> must be pushed onto the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-5">stack of script settings objects</a> before
  the evaluation begins, and popped when the evaluation ends (regardless of whether it's an abrupt
  completion or not).</p>

  <p>The <dfn id="entry-settings-object">entry settings object</dfn> is the most-recently added <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-6">environment settings
  object</a> in the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-6">stack of script settings objects</a> that is labeled as a
  <a href="/breakup/specs/browser-dom/#candidate-entry-settings-object" id="calling-scripts:candidate-entry-settings-object-2">candidate entry settings object</a>. If the stack is empty, or has no entries labeled as
  such, then there is no <a href="/breakup/specs/browser-dom/#entry-settings-object" id="calling-scripts:entry-settings-object">entry settings object</a>. It is used to obtain, amongst other
  things, the <a href="/breakup/specs/browser-dom/#api-base-url" id="calling-scripts:api-base-url">API base URL</a> to <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="calling-scripts:resolve-a-url">resolve</a> relative
  <a href="/breakup/specs/core-algorithms/#url" id="calling-scripts:url">URLs</a> used in scripts running in that <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="calling-scripts:unit-of-related-similar-origin-browsing-contexts-2">unit of related
  similar-origin browsing contexts</a>.</p>

  <p>The <dfn id="incumbent-settings-object">incumbent settings object</dfn> is the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="calling-scripts:environment-settings-object-7">environment settings object</a> in the
  <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="calling-scripts:stack-of-script-settings-objects-7">stack of script settings objects</a> that was most-recently added (i.e. the last one on
  the stack). If the stack is empty, then there is no <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="calling-scripts:incumbent-settings-object-2">incumbent settings object</a>. It is
  used in some security checks.</p>

  <p class="note">The Web IDL specification also uses these algorithms. <a href="#refsWEBIDL">[WEBIDL]</a></p>

  <div class="example">

   <p>Consider the following two pages, with the first being loaded in a browser window and the
   second being loaded in the <code id="calling-scripts:the-iframe-element"><a href="#the-iframe-element">iframe</a></code> of the first:</p>

   <pre>&lt;!-- a/a.html --&gt;
&lt;!DOCTYPE HTML&gt;
&lt;title&gt;Outer page&lt;/title&gt;
&lt;iframe src="../b/b.html"&gt;&lt;/iframe&gt;
&lt;input type=button onclick="frames[0].hello()" value="Hello"&gt;</pre>

   <pre>&lt;!-- b/b.html --&gt;
&lt;!DOCTYPE HTML&gt;
&lt;title&gt;Inner page&lt;/title&gt;
&lt;script&gt;
 function hello() {
   location.assign('c.html');
 }
&lt;/script&gt;</pre>

   <p>When the button is pressed in the inner frame, the outer page runs script in the inner page.
   While the <code>hello()</code> function is running, the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="calling-scripts:entry-settings-object-2">entry settings
   object</a> is that of the outer file (<code>a/a.html</code>), and the
   <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="calling-scripts:incumbent-settings-object-3">incumbent settings object</a> is that of the inner file (<code>b/b.html</code>). The <code id="calling-scripts:dom-location-assign"><a href="/breakup/specs/browser-dom/#dom-location-assign">assign()</a></code> method uses
   the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="calling-scripts:entry-settings-object-3">entry settings object</a> to resolve the URL, so we end up loading <code>a/c.html</code>, but it uses the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="calling-scripts:incumbent-settings-object-4">incumbent settings object</a> to establish
   the <a href="#source-browsing-context" id="calling-scripts:source-browsing-context">source browsing context</a>, from which the referrer is established, so the <code id="calling-scripts:http-referer"><a href="/breakup/specs/core-algorithms/#http-referer">Referer</a></code> header sent with the request for <code>a/c.html</code> specifies the inner file's URL (the one ending with <code>b/b.html</code>).</p>

   

  </div>

  <hr>

  <p>Each <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="calling-scripts:unit-of-related-similar-origin-browsing-contexts-3">unit of related similar-origin browsing contexts</a> has a <dfn id="global-script-clean-up-jobs-list">global script
  clean-up jobs list</dfn>, which must initially be empty. A global script clean-up job cannot run
  scripts, and cannot be sensitive to the order in which other clean-up jobs are executed. The File
  API uses this to release <code id="calling-scripts:blob-protocol"><a data-x-internal="blob-protocol" href="http://dev.w3.org/2006/webapi/FileAPI/#DefinitionOfScheme">blob:</a></code> URLs. <a href="#refsFILEAPI">[FILEAPI]</a></p>

  <p>When the user agent is to <dfn id="run-the-global-script-clean-up-jobs">run the global script clean-up jobs</dfn>, the user agent must
  perform each of the jobs in the <a href="/breakup/specs/browser-dom/#global-script-clean-up-jobs-list" id="calling-scripts:global-script-clean-up-jobs-list">global script clean-up jobs list</a> and then empty the
  list.</p></section>

  


  

  <section><h5 id="creating-scripts">7.1.3.4 Creating scripts</h5>

  <p>When the specification says that a <a href="/breakup/specs/browser-dom/#concept-script" id="creating-scripts:concept-script">script</a> is to be <dfn id="create-a-script">created</dfn>, given some script source, a script source URL, its
  scripting language, an <a href="/breakup/specs/browser-dom/#environment-settings-object" id="creating-scripts:environment-settings-object">environment settings object</a>, and optionally a <var>muted
  errors</var> flag, the user agent must run the following steps:</p>

  <ol><li><p>Let <var>script</var> be a new <a href="/breakup/specs/browser-dom/#concept-script" id="creating-scripts:concept-script-2">script</a> that
   this algorithm will subsequently initialise.</p></li><li><p>If <a href="/breakup/specs/browser-dom/#concept-bc-noscript" id="creating-scripts:concept-bc-noscript">scripting is disabled</a> for <a href="/breakup/specs/browser-dom/#browsing-context" id="creating-scripts:browsing-context">browsing
   context</a> passed to this algorithm, then abort these steps, as if the script source
   described a program that did nothing but return void.</p>

   </li><li><p>Obtain the appropriate <a href="/breakup/specs/browser-dom/#script-execution-environment" id="creating-scripts:script-execution-environment">script execution environment</a> for the given scripting
   language from the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="creating-scripts:environment-settings-object-2">environment settings object</a> provided.</p></li><li><p>Parse/compile/initialise the source of the script using the <a href="/breakup/specs/browser-dom/#script-execution-environment" id="creating-scripts:script-execution-environment-2">script execution
   environment</a>, as appropriate for the scripting language, and thus obtain <var>script</var>'s <a href="/breakup/specs/browser-dom/#code-entry-point" id="creating-scripts:code-entry-point">code entry-point</a>.</p></li><li><p>Let <var>script</var>'s <a href="/breakup/specs/browser-dom/#settings-object" id="creating-scripts:settings-object">settings object</a> be the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="creating-scripts:environment-settings-object-3">environment
   settings object</a> provided.</p></li><li><p>If the <var>muted errors</var> flag was set, then set <var>script</var>'s <a href="/breakup/specs/browser-dom/#muted-errors" id="creating-scripts:muted-errors">muted errors</a> flag.</p></li><li>

    <p>If all the steps above succeeded (in particular, if the script was compiled successfully),
    <a href="/breakup/specs/browser-dom/#jump-to-a-code-entry-point" id="creating-scripts:jump-to-a-code-entry-point">Jump</a> to <var>script</var>'s <a href="/breakup/specs/browser-dom/#code-entry-point" id="creating-scripts:code-entry-point-2">code
    entry-point</a>.</p>

    <p>Otherwise, <a href="/breakup/specs/browser-dom/#report-the-error" id="creating-scripts:report-the-error">report the error</a> for <var>script</var>, with the
    problematic position (line number and column number), using the <a href="/breakup/specs/browser-dom/#global-object" id="creating-scripts:global-object">global object</a>
    specified by the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="creating-scripts:environment-settings-object-4">environment settings object</a> as the target. If the error is still <i id="creating-scripts:concept-error-nothandled"><a href="/breakup/specs/browser-dom/#concept-error-nothandled">not handled</a></i> after this, then the error may be reported to
    the user.</p>

   </li></ol></section>

  


  

  <section><h5 id="killing-scripts">7.1.3.5 Killing scripts</h5>

  <p>User agents may impose resource limitations on scripts, for example CPU quotas, memory limits,
  total execution time limits, or bandwidth limitations. When a script exceeds a limit, the user
  agent may either throw a <code id="killing-scripts:quotaexceedederror"><a href="/breakup/specs/core-algorithms/#quotaexceedederror">QuotaExceededError</a></code> exception, abort the script without an
  exception, prompt the user, or throttle script execution.</p>

  <div class="example">

   <p>For example, the following script never terminates. A user agent could, after waiting for a
   few seconds, prompt the user to either terminate the script or let it continue.</p>

   <pre>&lt;script&gt;
 while (true) { /* loop */ }
&lt;/script&gt;</pre>

  </div>

  <p>User agents are encouraged to allow users to disable scripting whenever the user is prompted
  either by a script (e.g. using the <code id="killing-scripts:dom-alert"><a href="/breakup/specs/browser-dom/#dom-alert">window.alert()</a></code> API) or because
  of a script's actions (e.g. because it has exceeded a time limit).</p>

  <p>If scripting is disabled while a script is executing, the script should be terminated
  immediately.</p>

  <p>User agents may allow users to specifically disable scripts just for the purposes of closing a
  <a href="/breakup/specs/browser-dom/#browsing-context" id="killing-scripts:browsing-context">browsing context</a>.</p>

  <p class="example">For example, the prompt mentioned in the example above could also offer the
  user with a mechanism to just close the page entirely, without running any <code id="killing-scripts:event-unload"><a href="/breakup/specs/html/#event-unload">unload</a></code> event handlers.</p></section>

  


  <section><h5 id="runtime-script-errors">7.1.3.6 Runtime script errors</h5>

  

  <p>When the user agent is required to <dfn id="report-the-error">report an error</dfn> for a
  particular <a href="/breakup/specs/browser-dom/#concept-script" id="runtime-script-errors:concept-script">script</a> <var>script</var> with a particular
  position <var>line</var>:<var>col</var>, using a particular target <var>target</var>, it must run these steps, after which the error is either <dfn id="concept-error-handled"><i>handled</i></dfn> or <dfn id="concept-error-nothandled"><i>not
  handled</i></dfn>:</p>

  <ol><li><p>If <var>target</var> is <a href="/breakup/specs/browser-dom/#in-error-reporting-mode" id="runtime-script-errors:in-error-reporting-mode">in error reporting mode</a>, then abort these
   steps; the error is <i id="runtime-script-errors:concept-error-nothandled"><a href="/breakup/specs/browser-dom/#concept-error-nothandled">not handled</a></i>.</p></li><li><p>Let <var>target</var> be <dfn id="in-error-reporting-mode">in error reporting mode</dfn>.</p></li><li><p>Let <var>message</var> be a user-agent-defined string describing the error in a
   helpful manner.
   <a href="/breakup/specs/html/#fingerprinting-vector" id="runtime-script-errors:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
   </p></li><li><p>Let <var>error object</var> be the object that represents the error: in the case of an
   uncaught exception, that would be the object that was thrown; in the case of a JavaScript error
   that would be an <code id="runtime-script-errors:idl-error"><a href="/breakup/specs/core-algorithms/#idl-error">Error</a></code> object. If there is no corresponding
   object, then the null value must be used instead.</p></li><li>

    <p>Let <var>location</var> be an <a href="/breakup/specs/core-algorithms/#absolute-url" id="runtime-script-errors:absolute-url">absolute URL</a> that corresponds to the
    resource from which <var>script</var> was obtained.</p>

    <p class="note">The resource containing the script will typically be the file from which the
    <code id="runtime-script-errors:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> was parsed, e.g. for inline <code id="runtime-script-errors:the-script-element"><a href="#the-script-element">script</a></code> elements or <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="runtime-script-errors:event-handler-content-attributes">event
    handler content attributes</a>; or the JavaScript file that the script was in, for external
    scripts. Even for dynamically-generated scripts, user agents are strongly encouraged to attempt
    to keep track of the original source of a script. For example, if an external script uses the
    <code id="runtime-script-errors:dom-document-write"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> API to insert an inline
    <code id="runtime-script-errors:the-script-element-2"><a href="#the-script-element">script</a></code> element during parsing, the URL of the resource containing the script would
    ideally be reported as being the external script, and the line number might ideally be reported
    as the line with the <code id="runtime-script-errors:dom-document-write-2"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> call or where the
    string passed to that call was first constructed. Naturally, implementing this can be somewhat
    non-trivial.</p>

    <p class="note">User agents are similarly encouraged to keep careful track of the original line
    numbers, even in the face of <code id="runtime-script-errors:dom-document-write-3"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> calls
    mutating the document as it is parsed, or <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="runtime-script-errors:event-handler-content-attributes-2">event handler content attributes</a> spanning
    multiple lines.</p>

   </li><li><p>If <var>script</var> has <a href="/breakup/specs/browser-dom/#muted-errors" id="runtime-script-errors:muted-errors">muted errors</a>, then set <var>message</var> to "<code>Script error.</code>", set <var>location</var>
   to the empty string, set <var>line</var> and <var>col</var> to 0, and set <var>error object</var> to null.</p></li><li><p>Let <var>event</var> be a new <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="runtime-script-errors:concept-events-trusted">trusted</a>
   <code id="runtime-script-errors:errorevent"><a href="/breakup/specs/browser-dom/#errorevent">ErrorEvent</a></code> object that does not bubble but is cancelable, and which has the event
   name <code id="runtime-script-errors:event-error"><a href="/breakup/specs/html/#event-error">error</a></code>.</p></li><li><p>Initialise <var>event</var>'s <code id="runtime-script-errors:dom-errorevent-message"><a href="/breakup/specs/browser-dom/#dom-errorevent-message">message</a></code>
   attribute to <var>message</var>.</p></li><li><p>Initialise <var>event</var>'s <code id="runtime-script-errors:dom-errorevent-filename"><a href="/breakup/specs/browser-dom/#dom-errorevent-filename">filename</a></code> attribute to <var>location</var>.</p></li><li><p>Initialise <var>event</var>'s <code id="runtime-script-errors:dom-errorevent-lineno"><a href="/breakup/specs/browser-dom/#dom-errorevent-lineno">lineno</a></code>
   attribute to <var>line</var>.</p></li><li><p>Initialise <var>event</var>'s <code id="runtime-script-errors:dom-errorevent-colno"><a href="/breakup/specs/browser-dom/#dom-errorevent-colno">colno</a></code>
   attribute to <var>col</var>.</p></li><li><p>Initialise <var>event</var>'s <code id="runtime-script-errors:dom-errorevent-error"><a href="/breakup/specs/browser-dom/#dom-errorevent-error">error</a></code>
   attribute to <var>error object</var>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-event-dispatch" id="runtime-script-errors:concept-event-dispatch">Dispatch</a> <var>event</var> at <var>target</var>.</p></li><li><p>Let <var>target</var> no longer be <a href="/breakup/specs/browser-dom/#in-error-reporting-mode" id="runtime-script-errors:in-error-reporting-mode-2">in error reporting mode</a>.</p></li><li><p>If <var>event</var> was canceled, then the error is <i id="runtime-script-errors:concept-error-handled"><a href="/breakup/specs/browser-dom/#concept-error-handled">handled</a></i>. Otherwise, the error is <i id="runtime-script-errors:concept-error-nothandled-2"><a href="/breakup/specs/browser-dom/#concept-error-nothandled">not handled</a></i>.</p>

  </li></ol>


  <section><h6 id="runtime-script-errors-in-documents">7.1.3.6.1 Runtime script errors in documents</h6>

  <p>When the user agent is to <dfn id="report-the-exception">report an exception</dfn>
  <var>E</var>, the user agent must <a href="/breakup/specs/browser-dom/#report-the-error" id="runtime-script-errors-in-documents:report-the-error">report the error</a> for the relevant <a href="/breakup/specs/browser-dom/#concept-script" id="runtime-script-errors-in-documents:concept-script">script</a>, with the problematic position (line number and column
  number) in the resource containing the script, using the <a href="/breakup/specs/browser-dom/#global-object" id="runtime-script-errors-in-documents:global-object">global object</a> specified by
  the script's <a href="/breakup/specs/browser-dom/#settings-object" id="runtime-script-errors-in-documents:settings-object">settings object</a> as the target. If the error is still <i id="runtime-script-errors-in-documents:concept-error-nothandled"><a href="/breakup/specs/browser-dom/#concept-error-nothandled">not handled</a></i> after this, then the error may be reported to
  the user.</p>

  <p>When an exception is thrown during the execution of one of the scripts associated with a
  <code id="runtime-script-errors-in-documents:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, and the exception is not caught, the user agent must <a href="/breakup/specs/browser-dom/#report-the-exception" id="runtime-script-errors-in-documents:report-the-exception">report the
  exception</a>.</p></section>


  <section><h6 id="the-errorevent-interface">7.1.3.6.2 The <code id="the-errorevent-interface:errorevent"><a href="/breakup/specs/browser-dom/#errorevent">ErrorEvent</a></code> interface</h6>

  

  <pre class="idl">[Constructor(DOMString type, optional <a href="/breakup/specs/browser-dom/#erroreventinit" id="the-errorevent-interface:erroreventinit">ErrorEventInit</a> eventInitDict), Exposed=(Window,Worker)]
interface <dfn id="errorevent">ErrorEvent</dfn> : <a href="/breakup/specs/core-algorithms/#event" id="the-errorevent-interface:event">Event</a> {
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-errorevent-message" id="the-errorevent-interface:dom-errorevent-message">message</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-errorevent-filename" id="the-errorevent-interface:dom-errorevent-filename">filename</a>;
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-errorevent-lineno" id="the-errorevent-interface:dom-errorevent-lineno">lineno</a>;
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-errorevent-colno" id="the-errorevent-interface:dom-errorevent-colno">colno</a>;
  readonly attribute any <a href="/breakup/specs/browser-dom/#dom-errorevent-error" id="the-errorevent-interface:dom-errorevent-error">error</a>;
};

dictionary <dfn id="erroreventinit">ErrorEventInit</dfn> : <a href="/breakup/specs/core-algorithms/#eventinit" id="the-errorevent-interface:eventinit">EventInit</a> {
  DOMString message;
  DOMString filename;
  unsigned long lineno;
  unsigned long colno;
  any error;
};</pre>

  <p>The <dfn id="dom-errorevent-message"><code>message</code></dfn> attribute must return the
  value it was initialised to. When the object is created, this attribute must be initialised to the
  empty string. It represents the error message.</p>

  <p>The <dfn id="dom-errorevent-filename"><code>filename</code></dfn> attribute must return the
  value it was initialised to. When the object is created, this attribute must be initialised to the
  empty string. It represents the <a href="/breakup/specs/core-algorithms/#absolute-url" id="the-errorevent-interface:absolute-url">absolute URL</a> of the script in which the error
  originally occurred.</p>

  <p>The <dfn id="dom-errorevent-lineno"><code>lineno</code></dfn> attribute must return the
  value it was initialised to. When the object is created, this attribute must be initialised to
  zero. It represents the line number where the error occurred in the script.</p>

  <p>The <dfn id="dom-errorevent-colno"><code>colno</code></dfn> attribute must return the value
  it was initialised to. When the object is created, this attribute must be initialised to zero. It
  represents the column number where the error occurred in the script.</p>

  <p>The <dfn id="dom-errorevent-error"><code>error</code></dfn> attribute must return the value
  it was initialised to. When the object is created, this attribute must be initialised to null.
  Where appropriate, it is set to the object representing the error (e.g. the exception object in
  the case of an uncaught DOM exception).</p></section></section></section>



  

  <section><h4 id="event-loops">7.1.4 Event loops</h4> 

  <section><h5 id="definitions-3">7.1.4.1 Definitions</h5>

  <p>To coordinate events, user interaction, scripts, rendering, networking, and so forth, user
  agents must use <dfn id="event-loop">event loops</dfn> as described in this section. There are
  two kinds of event loops: those for <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context">browsing contexts</a>, and
  those for <a href="http://www.w3.org/TR/workers/#workers">workers</a>.</p>

  <p>There must be at least one <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-2">browsing context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop">event loop</a> per user
  agent, and at most one per <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="definitions-3:unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</a>.</p>

  <p class="note">When there is more than one <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-2">event loop</a> for a <a href="/breakup/specs/browser-dom/#unit-of-related-browsing-contexts" id="definitions-3:unit-of-related-browsing-contexts">unit of related
  browsing contexts</a>, complications arise when a <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-3">browsing context</a> in that group
  is <a href="#navigate" id="definitions-3:navigate">navigated</a> such that it switches from one <a href="/breakup/specs/browser-dom/#unit-of-related-similar-origin-browsing-contexts" id="definitions-3:unit-of-related-similar-origin-browsing-contexts-2">unit of related
  similar-origin browsing contexts</a> to another. This specification does not currently describe
  how to handle these complications.</p>

  <p>A <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-4">browsing context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-3">event loop</a> always has at least one <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-5">browsing
  context</a>. If such an <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-4">event loop</a>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-6">browsing
  contexts</a> all go away, then the <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-5">event loop</a> goes away as well. A <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-7">browsing
  context</a> always has an <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-6">event loop</a> coordinating its activities.</p>

  <p><a href="http://www.w3.org/TR/workers/#worker-event-loop">Worker event loops</a> are simpler: each worker has one
  <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-7">event loop</a>, and the <a href="http://www.w3.org/TR/workers/#run-a-worker" id="definitions-3:run-a-worker">worker processing model</a>
  manages the <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-8">event loop</a>'s lifetime.</p>

  <hr>

  <p>An <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-9">event loop</a> has one or more <dfn id="task-queue">task queues</dfn>. A
  <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue">task queue</a> is an ordered list of <dfn id="concept-task">tasks</dfn>, which are
  algorithms that are responsible for such work as:</p>

  <dl><dt>Events</dt><dd>

    <p>Dispatching an <code id="definitions-3:event"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object at a particular
    <code id="definitions-3:eventtarget"><a href="/breakup/specs/core-algorithms/#eventtarget">EventTarget</a></code> object is often done by a dedicated task.</p>

    <p class="note">Not all events are dispatched using the <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue-2">task queue</a>, many are
    dispatched during other tasks.</p>

   </dd><dt>Parsing</dt><dd><p>The <a href="#html-parser" id="definitions-3:html-parser">HTML parser</a> tokenizing one or more bytes, and then processing any
   resulting tokens, is typically a task.</p></dd><dt>Callbacks</dt><dd><p>Calling a callback is often done by a dedicated task.</p></dd><dt>Using a resource</dt><dd><p>When an algorithm <a href="/breakup/specs/core-algorithms/#fetch" id="definitions-3:fetch">fetches</a> a resource, if the fetching occurs
   in a non-blocking fashion then the processing of the resource once some or all of the resource is available
   is performed by a task.</p></dd><dt>Reacting to DOM manipulation</dt><dd><p>Some elements have tasks that trigger in response to DOM manipulation, e.g. when that
   element is <a href="/breakup/specs/core-algorithms/#insert-an-element-into-a-document" id="definitions-3:insert-an-element-into-a-document">inserted into the document</a>.</p>

  </dd></dl>

  <p>Each <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task">task</a> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-8">browsing context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-10">event
  loop</a> is associated with a <code id="definitions-3:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>; if the task was queued in the context of
  an element, then it is the element's <a id="definitions-3:node-document" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>; if the task was queued in the context
  of a <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-9">browsing context</a>, then it is the <a href="/breakup/specs/browser-dom/#browsing-context" id="definitions-3:browsing-context-10">browsing context</a>'s <a href="/breakup/specs/browser-dom/#active-document" id="definitions-3:active-document">active
  document</a> at the time the task was queued; if the task was queued by or for a <a href="/breakup/specs/browser-dom/#concept-script" id="definitions-3:concept-script">script</a> then the document is the <a href="/breakup/specs/browser-dom/#responsible-document" id="definitions-3:responsible-document">responsible document</a>
  specified by the script's <a href="/breakup/specs/browser-dom/#settings-object" id="definitions-3:settings-object">settings object</a>.</p>

  <p>A <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task-2">task</a> is intended for a specific <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-11">event loop</a>:
  the <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-12">event loop</a> that is handling <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task-3">tasks</a> for the
  <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task-4">task</a>'s associated <code id="definitions-3:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> or <a href="http://www.w3.org/TR/workers/#workers">worker</a>.</p>

  <p>When a user agent is to <dfn id="queue-a-task">queue a task</dfn>, it must add the given task to one of the <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue-3">task queues</a> of the relevant <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-13">event loop</a>.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task-5">task</a> is defined as coming from a specific <dfn id="task-source">task
  source</dfn>. All the tasks from one particular <a href="/breakup/specs/browser-dom/#task-source" id="definitions-3:task-source">task source</a> and destined to a
  particular <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-14">event loop</a> (e.g. the callbacks generated by timers of a
  <code id="definitions-3:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, the events fired for mouse movements over that <code id="definitions-3:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, the
  tasks queued for the parser of that <code id="definitions-3:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>) must always be added to the same
  <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue-4">task queue</a>, but <a href="/breakup/specs/browser-dom/#concept-task" id="definitions-3:concept-task-6">tasks</a> from different <a href="/breakup/specs/browser-dom/#task-source" id="definitions-3:task-source-2">task sources</a> may be placed in different <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue-5">task
  queues</a>.</p>

  <p class="example">For example, a user agent could have one <a href="/breakup/specs/browser-dom/#task-queue" id="definitions-3:task-queue-6">task queue</a> for mouse and
  key events (the <a href="/breakup/specs/browser-dom/#user-interaction-task-source" id="definitions-3:user-interaction-task-source">user interaction task source</a>), and another for everything else. The
  user agent could then give keyboard and mouse events preference over other tasks three quarters of
  the time, keeping the interface responsive but not starving other task queues, and never
  processing events from any one <a href="/breakup/specs/browser-dom/#task-source" id="definitions-3:task-source-3">task source</a> out of order.</p>

  <p>Each <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-15">event loop</a> has a <dfn id="currently-running-task">currently running task</dfn>. Initially, this is null.
  It is used to handle reentrancy. Each <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-16">event loop</a> also has a <dfn id="performing-a-microtask-checkpoint">performing a
  microtask checkpoint</dfn> flag, which must initially be false. It is used to prevent reentrant
  invocation of the <a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="definitions-3:perform-a-microtask-checkpoint">perform a microtask checkpoint</a> algorithm.</p> 

  <hr>

  <p>A user agent may have one <dfn id="storage-mutex">storage mutex</dfn>. This mutex is used to control access to
  shared state like cookies. At any one point, the <a href="/breakup/specs/browser-dom/#storage-mutex" id="definitions-3:storage-mutex">storage mutex</a> is either free, or
  owned by a particular <a href="/breakup/specs/browser-dom/#event-loop" id="definitions-3:event-loop-17">event loop</a> or instance of the <a href="/breakup/specs/core-algorithms/#fetch" id="definitions-3:fetch-2">fetching</a> algorithm.</p>

  <p>If a user agent does not implement a <a href="/breakup/specs/browser-dom/#storage-mutex" id="definitions-3:storage-mutex-2">storage mutex</a>, it is exempt from implementing
  the requirements that require it to acquire or release it.</p>

  <p class="note">User agent implementors have to make a choice between two evils. On the one hand,
  not implementing the storage mutex means that there is a risk of data corruption: a site could,
  for instance, try to read a cookie, increment its value, then write it back out, using the new
  value of the cookie as a unique identifier for the session; if the site does this twice in two
  different browser windows at the same time, it might end up using the same "unique" identifier for
  both sessions, with potentially disastrous effects. On the other hand, implementing the storage
  mutex has potentially serious performance implications: whenever a site uses Web Storage or
  cookies, all other sites that try to use Web Storage or cookies are blocked until the first site
  finishes.</p>

  <p class="warning">So far, all browsers faced with this decision have opted to not implement the
  <a href="/breakup/specs/browser-dom/#storage-mutex" id="definitions-3:storage-mutex-3">storage mutex</a>.</p>

  <p>Whenever a <a href="/breakup/specs/browser-dom/#concept-script" id="definitions-3:concept-script-2">script</a> calls into a <a href="/breakup/specs/core-algorithms/#plugin" id="definitions-3:plugin">plugin</a>, and
  whenever a <a href="/breakup/specs/core-algorithms/#plugin" id="definitions-3:plugin-2">plugin</a> calls into a <a href="/breakup/specs/browser-dom/#concept-script" id="definitions-3:concept-script-3">script</a>, the user
  agent must release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="definitions-3:storage-mutex-4">storage mutex</a>.</p></section>


  <section><h5 id="processing-model-9">7.1.4.2 Processing model</h5> 

  <p>An <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop">event loop</a> must continually run through the following steps for as long as it
  exists:</p>

  <ol><li id="step1">

    <p>Select the oldest <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task">task</a> on one of the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-2">event
    loop</a>'s <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue">task queues</a>, if any, ignoring, in the case of a
    <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context">browsing context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-3">event loop</a>, tasks whose associated
    <code id="processing-model-9:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s are not <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active">fully active</a>. The user agent may pick any <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue-2">task
    queue</a>. If there is no task to select, then jump to the <i>microtasks</i> step below.</p>

   </li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-4">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task">currently running task</a> to the <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-2">task</a> selected in the previous step.</p></li><li><p><i>Run</i>: Run the selected <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-3">task</a>.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-5">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-2">currently running task</a> back to
   null.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#storage-mutex" id="processing-model-9:storage-mutex">storage mutex</a> is now owned by the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-6">event loop</a>, release it
   so that it is once again free.</p></li><li><p>Remove the task that was run in the <i>run</i> step above from its <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue-3">task
   queue</a>.</p></li><li><p><i>Microtasks</i>: <a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="processing-model-9:perform-a-microtask-checkpoint">Perform a microtask checkpoint</a>.</p></li><li>

    <p><i>Update the rendering</i>: If this <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-7">event loop</a> is a <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context-2">browsing
    context</a> <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-8">event loop</a> (as opposed to a <a href="http://www.w3.org/TR/workers/#workers">worker</a>
    <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-9">event loop</a>), then run the following substeps.</p>

    <ol><li><p>Let <var>now</var> be the value that would be returned by the <code id="processing-model-9:performance"><a href="/breakup/specs/core-algorithms/#performance">Performance</a></code>
     object's <code id="processing-model-9:dom-performance-now"><a href="/breakup/specs/core-algorithms/#dom-performance-now">now()</a></code> method. <a href="#refsHRT">[HRT]</a></p>

     </li><li>

      <p>Let <var>docs</var> be the list of <code id="processing-model-9:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects associated with the
      <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-10">event loop</a> in question, sorted arbitrarily except that the following conditions
      must be met:</p>

      <ul><li><p>Any <code id="processing-model-9:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>B</var> that is <span>nested through</span> a
       <code id="processing-model-9:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>A</var> must be listed after <var>A</var> in the list.</p></li><li><p>If there are two documents <var>A</var> and <var>B</var> whose <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context-3">browsing contexts</a> are both <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="processing-model-9:nested-browsing-context">nested
       browsing contexts</a> and their <a href="/breakup/specs/browser-dom/#browsing-context-container" id="processing-model-9:browsing-context-container">browsing context
       containers</a> are both elements in the same <code id="processing-model-9:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>C</var>, then the
       order of <var>A</var> and <var>B</var> in the list must match the relative <a href="/breakup/specs/core-algorithms/#tree-order" id="processing-model-9:tree-order">tree
       order</a> of their respective <a href="/breakup/specs/browser-dom/#browsing-context-container" id="processing-model-9:browsing-context-container-2">browsing context
       containers</a> in <var>C</var>.</p></li></ul>

      <p>In the steps below that iterate over <var>docs</var>, each <code id="processing-model-9:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> must be
      processed in the order it is found in the list.</p>

     </li><li>

      <p>If there is a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="processing-model-9:top-level-browsing-context">top-level browsing context</a> <var>B</var> that the user agent
      believes would not benefit from having its rendering updated at this time, then remove from
      <var>docs</var> all <code id="processing-model-9:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects whose <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context-4">browsing context</a>'s
      <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="processing-model-9:top-level-browsing-context-2">top-level browsing context</a> is <var>B</var>.</p>

      <p class="note">Whether a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="processing-model-9:top-level-browsing-context-3">top-level browsing context</a> would benefit from having
      its rendering updated depends on various factors, such as the update frequency. For example,
      if the browser is attempting to achieve a 60 Hz refresh rate, then these steps are only
      necessary every 60th of a second (about 16.7ms). If the browser finds that a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="processing-model-9:top-level-browsing-context-4">top-level
      browsing context</a> is not able to sustain this rate, it might drop to a more sustainable
      30Hz for that set of <code id="processing-model-9:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s, rather than occasionally dropping frames. (This
      specification does not mandate any particular model for when to update the rendering.)
      Similarly, if a <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="processing-model-9:top-level-browsing-context-5">top-level browsing context</a> is in the background, the user agent
      might decide to drop that page to a much slower 4Hz, or even less.</p>

     </li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-2">fully active</a> <code id="processing-model-9:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <dfn id="run-the-resize-steps">run the resize steps</dfn> for
     that <code id="processing-model-9:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the timestamp. <a href="#refsCSSOMVIEW">[CSSOMVIEW]</a></p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-3">fully active</a> <code id="processing-model-9:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <dfn id="run-the-scroll-steps">run the scroll steps</dfn> for
     that <code id="processing-model-9:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the timestamp. <a href="#refsCSSOMVIEW">[CSSOMVIEW]</a></p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-4">fully active</a> <code id="processing-model-9:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <dfn id="evaluate-media-queries-and-report-changes">evaluate media queries and
     report changes</dfn> for that <code id="processing-model-9:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the
     timestamp. <a href="#refsCSSOMVIEW">[CSSOMVIEW]</a></p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-5">fully active</a> <code id="processing-model-9:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <dfn id="run-css-animations-and-send-events">run CSS animations and send
     events</dfn> for that <code id="processing-model-9:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the timestamp. <a href="#refsCSSANIMATIONS">[CSSANIMATIONS]</a></p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-6">fully active</a> <code id="processing-model-9:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <dfn id="run-the-fullscreen-rendering-steps">run the fullscreen rendering
     steps</dfn> for that <code id="processing-model-9:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the timestamp. <a href="#refsFULLSCREEN">[FULLSCREEN]</a></p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-7">fully active</a> <code id="processing-model-9:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, <a href="/breakup/specs/browser-dom/#run-the-animation-frame-callbacks" id="processing-model-9:run-the-animation-frame-callbacks">run the animation frame
     callbacks</a> for that <code id="processing-model-9:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, passing in <var>now</var> as the
     timestamp.</p></li><li><p>For each <a href="/breakup/specs/browser-dom/#fully-active" id="processing-model-9:fully-active-8">fully active</a> <code id="processing-model-9:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in <var>docs</var>, update the rendering or user
     interface of that <code id="processing-model-9:document-22"><a href="/breakup/specs/browser-dom/#document">Document</a></code> and its <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context-5">browsing context</a> to reflect the
     current state.</p></li></ol>

   </li><li><p>If this is a <a href="http://www.w3.org/TR/workers/#workers">worker</a> <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-11">event loop</a> (i.e. one running for a
   <code id="processing-model-9:workerglobalscope"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code>), but there are no <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-4">tasks</a> in the
   <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-12">event loop</a>'s <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue-4">task queues</a> and the
   <code id="processing-model-9:workerglobalscope-2"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object's <a href="http://www.w3.org/TR/workers/#dom-workerglobalscope-closing" id="processing-model-9:dom-workerglobalscope-closing">closing</a> flag is true, then destroy the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-13">event
   loop</a>, aborting these steps, resuming the <a href="http://www.w3.org/TR/workers/#run-a-worker" id="processing-model-9:run-a-worker">run a worker</a> steps described in the
   Web Workers section below.</p></li><li><p>Return to the <a href="/breakup/specs/browser-dom/#step1">first step</a> of the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-14">event loop</a>.</p></li></ol>

  <hr>

  <p>Each <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-15">event loop</a> has a <dfn id="microtask-queue">microtask queue</dfn>. A <dfn id="microtask">microtask</dfn> is a
  <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-5">task</a> that is originally to be queued on the <a href="/breakup/specs/browser-dom/#microtask-queue" id="processing-model-9:microtask-queue">microtask
  queue</a> rather than a <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue-5">task queue</a>. There are two kinds of <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask">microtasks</a>: <dfn id="solitary-callback-microtask">solitary callback
  microtasks</dfn>, and <dfn id="compound-microtask">compound microtasks</dfn>.</p>

  <p class="note">This specification only has <a href="/breakup/specs/browser-dom/#solitary-callback-microtask" id="processing-model-9:solitary-callback-microtask">solitary
  callback microtasks</a>. Specifications that use <a href="/breakup/specs/browser-dom/#compound-microtask" id="processing-model-9:compound-microtask">compound
  microtasks</a> have to take extra care to <a href="/breakup/specs/browser-dom/#execute-a-compound-microtask-subtask" id="processing-model-9:execute-a-compound-microtask-subtask">wrap callbacks</a> to handle <a href="/breakup/specs/browser-dom/#spin-the-event-loop" id="processing-model-9:spin-the-event-loop">spinning the event
  loop</a>.</p>

  <p>When an algorithm requires a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-2">microtask</a> to be <dfn id="queue-a-microtask">queued</dfn>, it must be appended to the relevant <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-16">event loop</a>'s
  <a href="/breakup/specs/browser-dom/#microtask-queue" id="processing-model-9:microtask-queue-2">microtask queue</a>; the <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source">task source</a> of such a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-3">microtask</a> is the
  <dfn id="microtask-task-source">microtask task source</dfn>.</p>

  <p class="note">It is possible for a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-4">microtask</a> to be moved to a regular <a href="/breakup/specs/browser-dom/#task-queue" id="processing-model-9:task-queue-6">task
  queue</a>, if, during its initial execution, it <a href="/breakup/specs/browser-dom/#spin-the-event-loop" id="processing-model-9:spin-the-event-loop-2">spins the
  event loop</a>. In that case, the <a href="/breakup/specs/browser-dom/#microtask-task-source" id="processing-model-9:microtask-task-source">microtask task source</a> is the <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source-2">task
  source</a> used. Normally, the <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source-3">task source</a> of a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-5">microtask</a> is
  irrelevant.</p>

  <p>When a user agent is to <dfn id="perform-a-microtask-checkpoint">perform a microtask checkpoint</dfn>, if the <a href="/breakup/specs/browser-dom/#performing-a-microtask-checkpoint" id="processing-model-9:performing-a-microtask-checkpoint">performing a
  microtask checkpoint</a> flag is false, then the user agent must run the following steps:</p>

  <ol><li><p>Let the <a href="/breakup/specs/browser-dom/#performing-a-microtask-checkpoint" id="processing-model-9:performing-a-microtask-checkpoint-2">performing a microtask checkpoint</a> flag be true.</p></li><li><p><i>Microtask queue handling</i>: If the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-17">event loop</a>'s <a href="/breakup/specs/browser-dom/#microtask-queue" id="processing-model-9:microtask-queue-3">microtask
   queue</a> is empty, jump to the <i>done</i> step below.</p></li><li><p>Select the oldest <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-6">microtask</a> on the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-18">event loop</a>'s <a href="/breakup/specs/browser-dom/#microtask-queue" id="processing-model-9:microtask-queue-4">microtask
   queue</a>.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-19">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-3">currently running task</a> to the <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-6">task</a> selected in the previous step.</p></li><li>

    <p><i>Run</i>: Run the selected <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-7">task</a>.</p>

    <p class="note">This might involve invoking scripted callbacks, which eventually calls the
    <a href="/breakup/specs/browser-dom/#clean-up-after-running-a-callback" id="processing-model-9:clean-up-after-running-a-callback">clean up after running a callback</a> steps, which call this <a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="processing-model-9:perform-a-microtask-checkpoint-2">perform a microtask
    checkpoint</a> algorithm again, which is why we use the <a href="/breakup/specs/browser-dom/#performing-a-microtask-checkpoint" id="processing-model-9:performing-a-microtask-checkpoint-3">performing a microtask
    checkpoint</a> flag to avoid reentrancy.</p>

   </li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-20">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-4">currently running task</a> back to
   null.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#storage-mutex" id="processing-model-9:storage-mutex-2">storage mutex</a> is now owned by the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-21">event loop</a>, release it
   so that it is once again free.</p></li><li><p>Remove the <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-7">microtask</a> run in the step above from the <a href="/breakup/specs/browser-dom/#microtask-queue" id="processing-model-9:microtask-queue-5">microtask
   queue</a>, and return to the <i>microtask queue handling</i> step.</p></li><li><p><i>Done</i>: Let the <a href="/breakup/specs/browser-dom/#performing-a-microtask-checkpoint" id="processing-model-9:performing-a-microtask-checkpoint-4">performing a microtask checkpoint</a> flag be
   false.</p></li></ol>

  <p>If, while a <a href="/breakup/specs/browser-dom/#compound-microtask" id="processing-model-9:compound-microtask-2">compound microtask</a> is running, the user agent is required to
  <dfn id="execute-a-compound-microtask-subtask">execute a compound microtask subtask</dfn> to run a series of steps, the user agent must run
  the following steps:</p>

  <ol><li><p>Let <var>parent</var> be the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-22">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-5">currently running
   task</a> (the currently running <a href="/breakup/specs/browser-dom/#compound-microtask" id="processing-model-9:compound-microtask-3">compound microtask</a>).</p></li><li><p>Let <var>subtask</var> be a new <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-8">task</a> that
   consists of running the given series of steps. The <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source-4">task source</a> of such a
   <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-8">microtask</a> is the <a href="/breakup/specs/browser-dom/#microtask-task-source" id="processing-model-9:microtask-task-source-2">microtask task source</a>. This is a <dfn id="compound-microtask-subtask">compound
   microtask subtask</dfn>.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-23">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-6">currently running task</a> to <var>subtask</var>.</p></li><li><p>Run <var>subtask</var>.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-24">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-7">currently running task</a> back to <var>parent</var>.</p></li></ol>

  <hr>

  <p>When an algorithm running <a href="/breakup/specs/core-algorithms/#in-parallel" id="processing-model-9:in-parallel">in parallel</a> is to <dfn id="await-a-stable-state">await a stable state</dfn>, the
  user agent must <a href="/breakup/specs/browser-dom/#queue-a-microtask" id="processing-model-9:queue-a-microtask">queue a microtask</a> that runs the following steps, and must then stop
  executing (execution of the algorithm resumes when the microtask is run, as described in the
  following steps):</p>

  <ol><li><p>Run the algorithm's <dfn id="synchronous-section">synchronous section</dfn>.</p></li><li><p>Resumes execution of the algorithm <a href="/breakup/specs/core-algorithms/#in-parallel" id="processing-model-9:in-parallel-2">in parallel</a>, if appropriate, as described
   in the algorithm's steps.</p></li></ol>

  <p class="note">Steps in <a href="/breakup/specs/browser-dom/#synchronous-section" id="processing-model-9:synchronous-section">synchronous sections</a> are marked
  with .</p>

  <hr>

  <p>When an algorithm says to <dfn id="spin-the-event-loop">spin the event loop</dfn> until a condition <var>goal</var> is met, the user agent must run the following steps:</p>

  <ol><li>

    <p>Let <var>task</var> be the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-25">event loop</a>'s <a href="/breakup/specs/browser-dom/#currently-running-task" id="processing-model-9:currently-running-task-8">currently running
    task</a>.</p>

    <p class="note">This might be a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-9">microtask</a>, in which case it is a <a href="/breakup/specs/browser-dom/#solitary-callback-microtask" id="processing-model-9:solitary-callback-microtask-2">solitary
    callback microtask</a>. It could also be a <a href="/breakup/specs/browser-dom/#compound-microtask-subtask" id="processing-model-9:compound-microtask-subtask">compound microtask subtask</a>, or a
    regular <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-9">task</a> that is not a <a href="/breakup/specs/browser-dom/#microtask" id="processing-model-9:microtask-10">microtask</a>. It will
    <em>not</em> be a <a href="/breakup/specs/browser-dom/#compound-microtask" id="processing-model-9:compound-microtask-4">compound microtask</a>.</p> 

   </li><li><p>Let <var>task source</var> be <var>task</var>'s <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source-5">task
   source</a>.</p></li><li><p>Let <var>old stack of script settings objects</var> be a copy of the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="processing-model-9:stack-of-script-settings-objects">stack
   of script settings objects</a>.</p></li><li><p>Empty the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="processing-model-9:stack-of-script-settings-objects-2">stack of script settings objects</a>.</p></li><li><p><a href="/breakup/specs/browser-dom/#run-the-global-script-clean-up-jobs" id="processing-model-9:run-the-global-script-clean-up-jobs">Run the global script clean-up jobs</a>.</p></li><li><p><a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="processing-model-9:perform-a-microtask-checkpoint-3">Perform a microtask checkpoint</a>.</p></li><li>

    <p>Stop <var>task</var>, allowing whatever algorithm that invoked it to resume, but
    continue these steps <a href="/breakup/specs/core-algorithms/#in-parallel" id="processing-model-9:in-parallel-3">in parallel</a>.</p>

    <p class="note">This causes one of the following algorithms to continue: the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-26">event
    loop</a>'s main set of steps, the <a href="/breakup/specs/browser-dom/#perform-a-microtask-checkpoint" id="processing-model-9:perform-a-microtask-checkpoint-4">perform a microtask checkpoint</a> algorithm, or
    the <a href="/breakup/specs/browser-dom/#execute-a-compound-microtask-subtask" id="processing-model-9:execute-a-compound-microtask-subtask-2">execute a compound microtask subtask</a> algorithm to continue.</p>

   </li><li><p>Wait until the condition <var>goal</var> is met.</p></li><li><p><a href="/breakup/specs/browser-dom/#queue-a-task" id="processing-model-9:queue-a-task">Queue a task</a> to continue running these steps, using the <a href="/breakup/specs/browser-dom/#task-source" id="processing-model-9:task-source-6">task
   source</a> <var>task source</var>. Wait until this new task runs before continuing
   these steps.</p></li><li><p>Replace the <a href="/breakup/specs/browser-dom/#stack-of-script-settings-objects" id="processing-model-9:stack-of-script-settings-objects-3">stack of script settings objects</a> with the <var>old
   stack of script settings objects</var>.</p></li><li><p>Return to the caller.</p></li></ol>

  <hr>

  <p>Some of the algorithms in this specification, for historical reasons, require the user agent to
  <dfn id="pause">pause</dfn> while running a <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-10">task</a> until a condition <var>goal</var> is met. This means running the following steps:</p>

  <ol><li><p>If necessary, update the rendering or user interface of any <code id="processing-model-9:document-23"><a href="/breakup/specs/browser-dom/#document">Document</a></code> or
   <a href="/breakup/specs/browser-dom/#browsing-context" id="processing-model-9:browsing-context-6">browsing context</a> to reflect the current state.</p></li><li><p>Wait until the condition <var>goal</var> is met. While a user agent has a paused
   <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-11">task</a>, the corresponding <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-27">event loop</a> must not run
   further <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-12">tasks</a>, and any script in the currently running <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-13">task</a> must block. User agents should remain responsive to user input
   while paused, however, albeit in a reduced capacity since the <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-28">event loop</a> will not be
   doing anything.</p></li></ol>

  <hr>

  <p>When a user agent is to <dfn id="obtain-the-storage-mutex">obtain the storage mutex</dfn> as part of running a <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-14">task</a>, it must run through the following steps:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#storage-mutex" id="processing-model-9:storage-mutex-3">storage mutex</a> is already owned by this <a href="/breakup/specs/browser-dom/#concept-task" id="processing-model-9:concept-task-15">task</a>'s <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-29">event loop</a>, then abort these steps.</p></li><li><p>Otherwise, <a href="/breakup/specs/browser-dom/#pause" id="processing-model-9:pause">pause</a> until the <a href="/breakup/specs/browser-dom/#storage-mutex" id="processing-model-9:storage-mutex-4">storage mutex</a> can be taken by the
   <a href="/breakup/specs/browser-dom/#event-loop" id="processing-model-9:event-loop-30">event loop</a>.</p></li><li><p>Take ownership of the <a href="/breakup/specs/browser-dom/#storage-mutex" id="processing-model-9:storage-mutex-5">storage mutex</a>.</p></li></ol></section>

  


  

  <section><h5 id="generic-task-sources">7.1.4.3 Generic task sources</h5>

  <p>The following <a href="/breakup/specs/browser-dom/#task-source" id="generic-task-sources:task-source">task sources</a> are used by a number of mostly
  unrelated features in this and other specifications.</p>

  <dl><dt>The <dfn id="dom-manipulation-task-source">DOM manipulation task source</dfn></dt><dd>

    <p>This <a href="/breakup/specs/browser-dom/#task-source" id="generic-task-sources:task-source-2">task source</a> is used for features that react to DOM manipulations, such as
    things that happen in a non-blocking fashion when an element is <a href="/breakup/specs/core-algorithms/#insert-an-element-into-a-document" id="generic-task-sources:insert-an-element-into-a-document">inserted into the document</a>.</p>

   </dd><dt>The <dfn id="user-interaction-task-source">user interaction task source</dfn></dt><dd>

    <p>This <a href="/breakup/specs/browser-dom/#task-source" id="generic-task-sources:task-source-3">task source</a> is used for features that react to user interaction, for
    example keyboard or mouse input.</p>

    <p>Events sent in response to user input (e.g. <code id="generic-task-sources:event-click"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> events) must be fired using <a href="/breakup/specs/browser-dom/#concept-task" id="generic-task-sources:concept-task">tasks</a> <a href="/breakup/specs/browser-dom/#queue-a-task" id="generic-task-sources:queue-a-task">queued</a> with the <a href="/breakup/specs/browser-dom/#user-interaction-task-source" id="generic-task-sources:user-interaction-task-source">user
    interaction task source</a>. <a href="#refsDOMEVENTS">[DOMEVENTS]</a></p> 

   </dd><dt>The <dfn id="networking-task-source">networking task source</dfn></dt><dd>

    <p>This <a href="/breakup/specs/browser-dom/#task-source" id="generic-task-sources:task-source-4">task source</a> is used for features that trigger in response to network
    activity.</p>

   </dd><dt>The <dfn id="history-traversal-task-source">history traversal task source</dfn></dt><dd>

    <p>This <a href="/breakup/specs/browser-dom/#task-source" id="generic-task-sources:task-source-5">task source</a> is used to queue calls to <code id="generic-task-sources:dom-history-back"><a href="/breakup/specs/browser-dom/#dom-history-back">history.back()</a></code> and similar APIs.</p>

   </dd></dl></section></section>

  




  <section><h4 id="events">7.1.5 Events</h4>

  <section><h5 id="event-handler-attributes">7.1.5.1 Event handlers</h5>

  

  <p>Many objects can have <dfn id="event-handlers">event handlers</dfn> specified. These act as non-capture event
  listeners for the object on which they are specified. <a href="#refsDOM">[DOM]</a></p>

  <p>An <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers">event handler</a> has a name, which always starts with
  "<code>on</code>" and is followed by the name of the event for which it is intended.</p>

  <p>An <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-2">event handler</a> can either have the value null, or be set
  to a callback object, or be set to an <a href="/breakup/specs/browser-dom/#internal-raw-uncompiled-handler" id="event-handler-attributes:internal-raw-uncompiled-handler">internal raw uncompiled
  handler</a>. The <code id="event-handler-attributes:eventhandler"><a href="/breakup/specs/browser-dom/#eventhandler">EventHandler</a></code> callback function type describes how this is
  exposed to scripts. Initially, event handlers must be set to null.</p>

  <p>Event handlers are exposed in one of two ways.</p>

  <p>The first way, common to all event handlers, is as an <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes">event handler IDL attribute</a>.</p>

  <p>The second way is as an <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handler-attributes:event-handler-content-attributes">event handler content
  attribute</a>. Event handlers on <a href="/breakup/specs/core-algorithms/#html-elements" id="event-handler-attributes:html-elements">HTML elements</a> and some of the event handlers on
  <code id="event-handler-attributes:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects are exposed in this way.</p>

  

  <hr>

  <p>An <dfn id="event-handler-idl-attributes">event handler IDL attribute</dfn> is an IDL
  attribute for a specific <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-3">event handler</a>. The name of the IDL
  attribute is the same as the name of the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-4">event handler</a>.</p>

  <p><a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes-2">Event handler IDL attributes</a>, on setting, must set the corresponding <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-5">event handler</a> to their new value, and on getting, must return the
  result of <a href="/breakup/specs/browser-dom/#getting-the-current-value-of-the-event-handler" id="event-handler-attributes:getting-the-current-value-of-the-event-handler">getting the current value of the event handler</a> in question (this can throw
  an exception, in which case the getting propagates it to the caller, it does not catch it).</p>

  <p>If an <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes-3">event handler IDL attribute</a> exposes an
  <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-6">event handler</a> of an object that doesn't exist, it must always
  return null on getting and must do nothing on setting.</p>

  <p class="note">This can happen in particular for <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes-4">event
  handler IDL attribute</a> on <code id="event-handler-attributes:the-body-element"><a href="#the-body-element">body</a></code> elements that do not have corresponding
  <code id="event-handler-attributes:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects.</p>

  <p class="note">Certain event handler IDL attributes have additional requirements, in particular
  the <code id="event-handler-attributes:handler-messageport-onmessage"><a href="http://www.w3.org/TR/webmessaging/#handler-messageport-onmessage">onmessage</a></code> attribute of
  <code id="event-handler-attributes:messageport"><a href="http://www.w3.org/TR/webmessaging/#messageport">MessagePort</a></code> objects.</p>

  <hr>

  

  <p>An <dfn id="event-handler-content-attributes">event handler content attribute</dfn> is a
  content attribute for a specific <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-7">event handler</a>. The name of
  the content attribute is the same as the name of the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-8">event
  handler</a>.</p>

  <p><a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handler-attributes:event-handler-content-attributes-2">Event handler content attributes</a>, when specified, must contain valid JavaScript
  code which, when parsed, would match the <code>FunctionBody</code> production after
  automatic semicolon insertion. <a href="#refsECMA262">[ECMA262]</a></p>

  

  <p>When an <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handler-attributes:event-handler-content-attributes-3">event handler content attribute</a>
  is set, the user agent must set the corresponding <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-9">event
  handler</a> to an <a href="/breakup/specs/browser-dom/#internal-raw-uncompiled-handler" id="event-handler-attributes:internal-raw-uncompiled-handler-2">internal raw uncompiled handler</a> consisting of the attribute's
  new value and the script location where the attribute was set to this value</p>

  <p>When an event handler content attribute is removed, the user agent must set the corresponding
  <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-10">event handler</a> to null.</p>
  

  <hr>

  <p>When an <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-11">event handler</a> <var>H</var> of an element
  or object <var>T</var> implementing the <code id="event-handler-attributes:eventtarget"><a href="/breakup/specs/core-algorithms/#eventtarget">EventTarget</a></code> interface is first set
  to a non-null value, the user agent must append an <a href="/breakup/specs/core-algorithms/#concept-event-listener" id="event-handler-attributes:concept-event-listener">event
  listener</a> to the list of <a href="/breakup/specs/core-algorithms/#concept-event-listener" id="event-handler-attributes:concept-event-listener-2">event listeners</a>
  associated with <var>T</var> with <i>type</i> set to the <dfn id="event-handler-event-type">event handler event
  type</dfn> corresponding to <var>H</var>, <i>capture</i> set to false, and
  <i>listener</i> set to <a href="/breakup/specs/browser-dom/#the-event-handler-processing-algorithm" id="event-handler-attributes:the-event-handler-processing-algorithm">the event handler processing algorithm</a> defined below. <a href="#refsDOM">[DOM]</a></p>

  <p class="note">The <i>listener</i> is emphatically <em>not</em> the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-12">event handler</a> itself. Every event handler ends up registering the same
  <i>listener</i>, the algorithm defined below, which takes care of invoking the right callback, and
  processing the callback's return value.</p>

  <p class="note">This only happens the first time the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-13">event
  handler</a>'s value is set. Since listeners are called in the order they were registered, the
  order of event listeners for a particular event type will always be first the event listeners
  registered with <code id="event-handler-attributes:dom-eventtarget-addeventlistener"><a href="/breakup/specs/core-algorithms/#dom-eventtarget-addeventlistener">addEventListener()</a></code> before
  the first time the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-14">event handler</a> was set to a non-null value,
  then the callback to which it is currently set, if any, and finally the event listeners registered
  with <code id="event-handler-attributes:dom-eventtarget-addeventlistener-2"><a href="/breakup/specs/core-algorithms/#dom-eventtarget-addeventlistener">addEventListener()</a></code> <em>after</em> the
  first time the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-15">event handler</a> was set to a non-null value.</p>

  

  <div class="example">

   <p>This example demonstrates the order in which event listeners are invoked. If the button in
   this example is clicked by the user, the page will show four alerts, with the text "ONE", "TWO",
   "THREE", and "FOUR" respectively.</p>

   <pre>&lt;button id="test"&gt;Start Demo&lt;/button&gt;
&lt;script&gt;
 var button = document.getElementById('test');
 button.addEventListener('click', function () { alert('ONE') }, false);
 button.setAttribute('onclick', "alert('NOT CALLED')"); // event handler listener is registered here
 button.addEventListener('click', function () { alert('THREE') }, false);
 button.onclick = function () { alert('TWO'); };
 button.addEventListener('click', function () { alert('FOUR') }, false);
&lt;/script&gt;</pre>

  </div>

  

  <p class="note">The interfaces implemented by the event object do not influence whether an <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-16">event handler</a> is triggered or not.</p>

  <p><dfn id="the-event-handler-processing-algorithm">The event handler processing algorithm</dfn> for an <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-17">event
  handler</a> <var>H</var> and an <code id="event-handler-attributes:event"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object <var>E</var> is as
  follows:</p>

  <ol><li>

    <p>Let <var>callback</var> be the result of <a href="/breakup/specs/browser-dom/#getting-the-current-value-of-the-event-handler" id="event-handler-attributes:getting-the-current-value-of-the-event-handler-2">getting the current value of the
    event handler</a> <var>H</var>.</p>

   </li><li><p>If <var>callback</var> is null, then abort these steps.</p></li><li>

    <p>Process the <code id="event-handler-attributes:event-2"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object <var>E</var> as follows:</p>

    <dl class="switch"><dt>If <var>E</var> is an <code id="event-handler-attributes:errorevent"><a href="/breakup/specs/browser-dom/#errorevent">ErrorEvent</a></code> object and the <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes-5">event handler IDL attribute</a>'s type is
     <code id="event-handler-attributes:onerroreventhandler"><a href="/breakup/specs/browser-dom/#onerroreventhandler">OnErrorEventHandler</a></code></dt><dd>

      <p><a href="/breakup/specs/browser-dom/#concept-invoke-event-handler" id="event-handler-attributes:concept-invoke-event-handler">Invoke</a> <var>callback</var> with five
      arguments, the first one having the value of <var>E</var>'s <code id="event-handler-attributes:dom-errorevent-message"><a href="/breakup/specs/browser-dom/#dom-errorevent-message">message</a></code> attribute, the second having the value of
      <var>E</var>'s <code id="event-handler-attributes:dom-errorevent-filename"><a href="/breakup/specs/browser-dom/#dom-errorevent-filename">filename</a></code> attribute, the third
      having the value of <var>E</var>'s <code id="event-handler-attributes:dom-errorevent-lineno"><a href="/breakup/specs/browser-dom/#dom-errorevent-lineno">lineno</a></code>
      attribute, the fourth having the value of <var>E</var>'s <code id="event-handler-attributes:dom-errorevent-colno"><a href="/breakup/specs/browser-dom/#dom-errorevent-colno">colno</a></code> attribute, the fifth having the value of
      <var>E</var>'s <code id="event-handler-attributes:dom-errorevent-error"><a href="/breakup/specs/browser-dom/#dom-errorevent-error">error</a></code> attribute, and with the <i id="event-handler-attributes:dfn-callback-this-value"><a href="/breakup/specs/core-algorithms/#dfn-callback-this-value">callback this value</a></i> set to <var>E</var>'s <code id="event-handler-attributes:dom-event-currenttarget"><a href="/breakup/specs/core-algorithms/#dom-event-currenttarget">currentTarget</a></code>. Let <var>return value</var> be the
      callback's return value. <a href="#refsWEBIDL">[WEBIDL]</a></p>

     </dd><dt>Otherwise</dt><dd>

      <p><a href="/breakup/specs/browser-dom/#concept-invoke-event-handler" id="event-handler-attributes:concept-invoke-event-handler-2">Invoke</a> <var>callback</var>
      with one argument, the value of which is the <code id="event-handler-attributes:event-3"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object <var>E</var>,
      with the <i id="event-handler-attributes:dfn-callback-this-value-2"><a href="/breakup/specs/core-algorithms/#dfn-callback-this-value">callback this value</a></i> set to <var>E</var>'s <code id="event-handler-attributes:dom-event-currenttarget-2"><a href="/breakup/specs/core-algorithms/#dom-event-currenttarget">currentTarget</a></code>. Let <var>return value</var> be the callback's return value. <a href="#refsWEBIDL">[WEBIDL]</a></p>

     </dd></dl>

    <p>In this step, <dfn id="concept-invoke-event-handler">invoke</dfn> means to <a href="http://heycam.github.io/webidl/#es-invoking-callback-functions" id="event-handler-attributes:es-invoking-callback-functions" data-x-internal="es-invoking-callback-functions">invoke the Web IDL callback function</a>.</p>

    <p>If an exception gets thrown by the callback, end these steps and allow the exception to
    propagate. (It will propagate to the <a href="/breakup/specs/core-algorithms/#concept-event-dispatch" id="event-handler-attributes:concept-event-dispatch">DOM event dispatch
    logic</a>, which will then <a href="/breakup/specs/browser-dom/#report-the-exception" id="event-handler-attributes:report-the-exception">report the exception</a>.)</p>

   </li><li>

    <p>Process <var>return value</var> as follows:</p>

    <dl class="switch"><dt>If the event type is <code id="event-handler-attributes:event-mouseover"><a href="/breakup/specs/core-algorithms/#event-mouseover">mouseover</a></code></dt><dt>If the event type is <code id="event-handler-attributes:event-error"><a href="/breakup/specs/html/#event-error">error</a></code> and <var>E</var> is an <code id="event-handler-attributes:errorevent-2"><a href="/breakup/specs/browser-dom/#errorevent">ErrorEvent</a></code> object</dt><dd><p>If <var>return value</var> is a Web IDL boolean true value, then cancel the event.</p></dd><dt>If the event type is <code id="event-handler-attributes:event-beforeunload"><a href="/breakup/specs/html/#event-beforeunload">beforeunload</a></code></dt><dd>

      <p class="note">The <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handler-attributes:event-handler-idl-attributes-6">event handler IDL
      attribute</a>'s type is <code id="event-handler-attributes:onbeforeunloadeventhandler"><a href="/breakup/specs/browser-dom/#onbeforeunloadeventhandler">OnBeforeUnloadEventHandler</a></code>, and the <var>return value</var> will therefore have been coerced into either the value null or a
      DOMString.</p>

      <p>If the <var>return value</var> is null, then cancel the event.</p>

      <p>Otherwise, If the <code id="event-handler-attributes:event-4"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object <var>E</var> is a
      <code id="event-handler-attributes:beforeunloadevent"><a href="#beforeunloadevent">BeforeUnloadEvent</a></code> object, and the <code id="event-handler-attributes:event-5"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> object <var>E</var>'s <code id="event-handler-attributes:dom-beforeunloadevent-returnvalue"><a href="#dom-beforeunloadevent-returnvalue">returnValue</a></code>
      attribute's value is the empty string, then set the <code id="event-handler-attributes:dom-beforeunloadevent-returnvalue-2"><a href="#dom-beforeunloadevent-returnvalue">returnValue</a></code> attribute's value to <var>return value</var>.</p>

     </dd><dt>Otherwise</dt><dd><p>If <var>return value</var> is a Web IDL boolean false value, then cancel the
     event.</p></dd></dl>

   </li></ol>

  

  <hr>

  <p>The <code id="event-handler-attributes:eventhandler-2"><a href="/breakup/specs/browser-dom/#eventhandler">EventHandler</a></code> callback function type represents a callback used for event
  handlers. It is represented in Web IDL as follows:</p>

  <pre class="idl">[TreatNonObjectAsNull]
callback <dfn id="eventhandlernonnull">EventHandlerNonNull</dfn> = any (<a href="/breakup/specs/core-algorithms/#event" id="event-handler-attributes:event-6">Event</a> event);
typedef <a href="/breakup/specs/browser-dom/#eventhandlernonnull" id="event-handler-attributes:eventhandlernonnull">EventHandlerNonNull</a>? <dfn id="eventhandler">EventHandler</dfn>;</pre>

  <p class="note">In JavaScript, any <code id="event-handler-attributes:idl-function"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code> object implements
  this interface.</p>

  <div class="example">

   <p>For example, the following document fragment:</p>

   <pre>&lt;body onload="alert(this)" onclick="alert(this)"&gt;</pre>

   <p>...leads to an alert saying "<code>[object&nbsp;Window]</code>" when the document is
   loaded, and an alert saying "<code>[object&nbsp;HTMLBodyElement]</code>" whenever the
   user clicks something in the page.</p>

  </div>

  <p class="note">The return value of the function affects whether the event is canceled or not:
  as described above, if the return value is false, the event is canceled
  (except for <code id="event-handler-attributes:event-mouseover-2"><a href="/breakup/specs/core-algorithms/#event-mouseover">mouseover</a></code> events, where the return value has to
  be true to cancel the event). With <code id="event-handler-attributes:event-beforeunload-2"><a href="/breakup/specs/html/#event-beforeunload">beforeunload</a></code> events,
  the value is instead used to determine the message to show the user.</p>

  <p>For historical reasons, the <code id="event-handler-attributes:handler-onerror"><a href="/breakup/specs/browser-dom/#handler-onerror">onerror</a></code> handler has different
  arguments:</p>

  <pre class="idl">[TreatNonObjectAsNull]
callback <dfn id="onerroreventhandlernonnull">OnErrorEventHandlerNonNull</dfn> = any ((<a href="/breakup/specs/core-algorithms/#event" id="event-handler-attributes:event-7">Event</a> or DOMString) event, optional DOMString source, optional unsigned long lineno, optional unsigned long column, optional any error);
typedef <a href="/breakup/specs/browser-dom/#onerroreventhandlernonnull" id="event-handler-attributes:onerroreventhandlernonnull">OnErrorEventHandlerNonNull</a>? <dfn id="onerroreventhandler">OnErrorEventHandler</dfn>;</pre>

  <p>Similarly, the <code id="event-handler-attributes:handler-window-onbeforeunload"><a href="/breakup/specs/browser-dom/#handler-window-onbeforeunload">onbeforeunload</a></code> handler has a
  different return value:</p>

  <pre class="idl">[TreatNonObjectAsNull]
callback <dfn id="onbeforeunloadeventhandlernonnull">OnBeforeUnloadEventHandlerNonNull</dfn> = DOMString? (<a href="/breakup/specs/core-algorithms/#event" id="event-handler-attributes:event-8">Event</a> event);
typedef <a href="/breakup/specs/browser-dom/#onbeforeunloadeventhandlernonnull" id="event-handler-attributes:onbeforeunloadeventhandlernonnull">OnBeforeUnloadEventHandlerNonNull</a>? <dfn id="onbeforeunloadeventhandler">OnBeforeUnloadEventHandler</dfn>;</pre>

  

  

  <hr>

  <p>An <dfn id="internal-raw-uncompiled-handler">internal raw uncompiled handler</dfn> is a tuple with the following information:</p>

  <ul class="brief"><li>An uncompiled script body

   </li><li>A location where the script body originated, in case an error needs to be reported

  </li></ul>

  <p>When the user agent is to <dfn id="getting-the-current-value-of-the-event-handler">get the
  current value of the event handler</dfn> <var>H</var>, it must run these steps:</p>

  <ol><li>

    <p>If <var>H</var>'s value is an <a href="/breakup/specs/browser-dom/#internal-raw-uncompiled-handler" id="event-handler-attributes:internal-raw-uncompiled-handler-3">internal raw uncompiled handler</a>, run these
    substeps:</p>

    <ol><li>

      <p>If <var>H</var> is an element's <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-18">event
      handler</a>, then let <var>element</var> be the element, and <var>document</var> be the element's <a id="event-handler-attributes:node-document" href="https://dom.spec.whatwg.org/#concept-node-document" data-x-internal="node-document">node document</a>.</p>

      <p>Otherwise, <var>H</var> is a <code id="event-handler-attributes:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-19">event handler</a>: let <var>element</var> be null, and let <var>document</var> be the <code id="event-handler-attributes:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> most recently associated with that
      <code id="event-handler-attributes:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object.</p>

     </li><li><p>If  <var>document</var> is
     not in a <a href="/breakup/specs/browser-dom/#browsing-context" id="event-handler-attributes:browsing-context">browsing context</a>, or if <a href="/breakup/specs/browser-dom/#concept-bc-script" id="event-handler-attributes:concept-bc-script">scripting is
     enabled</a> for <var>document</var>'s <a href="/breakup/specs/browser-dom/#browsing-context" id="event-handler-attributes:browsing-context-2">browsing context</a>, then return
     null and abort the algorithm for <a href="/breakup/specs/browser-dom/#getting-the-current-value-of-the-event-handler" id="event-handler-attributes:getting-the-current-value-of-the-event-handler-3">getting the current value of the event
     handler</a>.</p></li><li><p>Let <var>body</var> be the uncompiled script body in the <a href="/breakup/specs/browser-dom/#internal-raw-uncompiled-handler" id="event-handler-attributes:internal-raw-uncompiled-handler-4">internal raw
     uncompiled handler</a>.</p></li><li><p>Let <var>location</var> be the location where the script body originated, as
     given by the <a href="/breakup/specs/browser-dom/#internal-raw-uncompiled-handler" id="event-handler-attributes:internal-raw-uncompiled-handler-5">internal raw uncompiled handler</a>.</p></li><li><p>If <var>element</var> is not null and <var>element</var> has a
     <a href="#form-owner" id="event-handler-attributes:form-owner">form owner</a>, let <var>form owner</var> be that <a href="#form-owner" id="event-handler-attributes:form-owner-2">form owner</a>.
     Otherwise, let <var>form owner</var> be null.</p></li><li><p>Let <var>script settings</var> be the <a href="/breakup/specs/browser-dom/#environment-settings-object" id="event-handler-attributes:environment-settings-object">environment settings object</a>
     created for the <code id="event-handler-attributes:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object with which <var>document</var> is
     currently associated.</p></li><li><p>Obtain the <a href="/breakup/specs/browser-dom/#script-execution-environment" id="event-handler-attributes:script-execution-environment">script execution environment</a> for JavaScript from <var>script settings</var>.</p></li><li>

      <p>If <var>body</var> is not parsable as <i>FunctionBody</i> or if parsing detects
      an <i>early error</i>, then follow these substeps:</p>

      <ol><li><p>Set <var>H</var>'s value to null.</p></li><li><p><a href="/breakup/specs/browser-dom/#report-the-error" id="event-handler-attributes:report-the-error">Report the error</a> for the appropriate <a href="/breakup/specs/browser-dom/#concept-script" id="event-handler-attributes:concept-script">script</a> and with the appropriate position (line number and
       column number) given by <var>location</var>, using the <a href="/breakup/specs/browser-dom/#global-object" id="event-handler-attributes:global-object">global object</a>
       specified by <var>script settings</var> as the target. If the error is still <i id="event-handler-attributes:concept-error-nothandled"><a href="/breakup/specs/browser-dom/#concept-error-nothandled">not handled</a></i> after this, then the error may be reported
       to the user.</p></li><li><p>Jump to the step labeled <i>end</i> below.</p></li></ol>

      <p class="note"><i>FunctionBody</i> is defined in ECMAScript edition 5 section 13 Function
      Definition. <i>Early error</i> is defined in ECMAScript edition 5 section 16 Errors. <a href="#refsECMA262">[ECMA262]</a></p>

     </li><li>

      <p>If <var>body</var> begins with a Directive Prologue that contains a Use Strict
      Directive then let <var>strict</var> be true, otherwise let <var>strict</var> be false.</p> 

      <p class="note">The terms "Directive Prologue" and "Use Strict Directive" are defined in
      ECMAScript edition 5 section 14.1 Directive Prologues and the Use Strict Directive. <a href="#refsECMA262">[ECMA262]</a></p>

     </li><li>

      <p>Using the <a href="/breakup/specs/browser-dom/#script-execution-environment" id="event-handler-attributes:script-execution-environment-2">script execution environment</a> obtained above, create a function
      object (as defined in ECMAScript edition 5 section 13.2 Creating Function Objects), with:</p>

      <dl><dt>Parameter list <var>FormalParameterList</var></dt><dd>

        <dl class="switch"><dt>If <var>H</var> is an <code id="event-handler-attributes:handler-onerror-2"><a href="/breakup/specs/browser-dom/#handler-onerror">onerror</a></code> <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-20">event handler</a> of a <code id="event-handler-attributes:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object</dt><dd>Let the function have five arguments, named <code>event</code>, <code>source</code>, <code>lineno</code>, <code>colno</code>, and
         <code>error</code>.</dd><dt>Otherwise</dt><dd>Let the function have a single argument called <code>event</code>.</dd></dl>

       </dd><dt>Function body <var>FunctionBody</var></dt><dd>The result of parsing <var>body</var> above.</dd><dt>Lexical Environment <var>Scope</var></dt><dd>

        <ol><li>

          <p>If <var>H</var> is an element's <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-21">event
          handler</a>, then let <var>Scope</var> be the result of
          NewObjectEnvironment(<var>document</var>, the <var>global
          environment</var>).</p>

          <p>Otherwise, <var>H</var> is a <code id="event-handler-attributes:window-7"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object's <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handler-attributes:event-handlers-22">event handler</a>: let <var>Scope</var> be the <var>global environment</var>.</p>

         </li><li><p>If <var>form owner</var> is not null, let <var>Scope</var> be
         the result of NewObjectEnvironment(<var>form owner</var>, <var>Scope</var>).</p></li><li><p>If <var>element</var> is not null, let <var>Scope</var> be the
         result of NewObjectEnvironment(<var>element</var>, <var>Scope</var>).</p></li></ol>

        <p class="note">NewObjectEnvironment() is defined in ECMAScript edition 5 section 10.2.2.3
        NewObjectEnvironment (O, E). <a href="#refsECMA262">[ECMA262]</a></p>

       </dd><dt>Boolean flag <var>Strict</var></dt><dd>The value of <var>strict</var>.</dd></dl>

      <p>Let <var>function</var> be this new function.</p>

     </li><li><p>Let <var>script</var> be a new <a href="/breakup/specs/browser-dom/#concept-script" id="event-handler-attributes:concept-script-2">script</a>.</p></li><li><p>Let <var>script</var>'s <a href="/breakup/specs/browser-dom/#code-entry-point" id="event-handler-attributes:code-entry-point">code entry-point</a> be <var>function</var>.</p></li><li><p>Let <var>script</var>'s <a href="/breakup/specs/browser-dom/#settings-object" id="event-handler-attributes:settings-object">settings object</a> be <var>script
     settings</var>.</p></li><li><p>Set <var>H</var> to <var>function</var>.</p></li></ol>

   </li><li><p><i>End</i>: Return <var>H</var>'s value.</p></li></ol></section>

  



  <section><h5 id="event-handlers-on-elements,-document-objects,-and-window-objects">7.1.5.2 Event handlers on elements, <code id="event-handlers-on-elements,-document-objects,-and-window-objects:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects, and <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects</h5>

  <p>The following are the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers">event handlers</a> (and their corresponding <a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type">event handler event types</a>) that must be
  supported by all <a href="/breakup/specs/core-algorithms/#html-elements" id="event-handlers-on-elements,-document-objects,-and-window-objects:html-elements">HTML elements</a>, as both <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-content-attributes">event handler content attributes</a>
  and <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes">event handler IDL attributes</a>; and that must be
  supported by all <code id="event-handlers-on-elements,-document-objects,-and-window-objects:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> and <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects, as <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-2">event handler IDL
  attributes</a>:</p>

  <table><thead><tr><th><a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-2">Event handler</a> </th><th><a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-2">Event handler event type</a>
   </th></tr></thead><tbody><tr><td><dfn id="handler-onabort"><code>onabort</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-abort"><a href="/breakup/specs/html/#event-abort">abort</a></code>
    </td></tr><tr><td><dfn id="handler-onautocomplete"><code>onautocomplete</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-autocomplete"><a href="/breakup/specs/html/#event-autocomplete">autocomplete</a></code> 
    </td></tr><tr><td><dfn id="handler-onautocompleteerror"><code>onautocompleteerror</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-autocompleteerror"><a href="/breakup/specs/html/#event-autocompleteerror">autocompleteerror</a></code> 
    </td></tr><tr><td><dfn id="handler-oncancel"><code>oncancel</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-cancel"><a href="/breakup/specs/html/#event-cancel">cancel</a></code>
    </td></tr><tr><td><dfn id="handler-oncanplay"><code>oncanplay</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-canplay"><a href="#event-media-canplay">canplay</a></code>
    </td></tr><tr><td><dfn id="handler-oncanplaythrough"><code>oncanplaythrough</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-canplaythrough"><a href="#event-media-canplaythrough">canplaythrough</a></code>
    </td></tr><tr><td><dfn id="handler-onchange"><code>onchange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-change"><a href="/breakup/specs/html/#event-change">change</a></code> 
    </td></tr><tr><td><dfn id="handler-onclick"><code>onclick</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-click"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> 
    </td></tr><tr><td><dfn id="handler-onclose"><code>onclose</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-close"><a href="/breakup/specs/html/#event-close">close</a></code> 
    </td></tr><tr><td><dfn id="handler-oncontextmenu"><code>oncontextmenu</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-contextmenu"><a href="/breakup/specs/html/#event-contextmenu">contextmenu</a></code> 
    </td></tr><tr><td><dfn id="handler-oncuechange"><code>oncuechange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-cuechange"><a href="#event-media-cuechange">cuechange</a></code>
    </td></tr><tr><td><dfn id="handler-ondblclick"><code>ondblclick</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dblclick"><a href="/breakup/specs/core-algorithms/#event-dblclick">dblclick</a></code> 
    </td></tr><tr><td><dfn id="handler-ondrag"><code>ondrag</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-drag"><a href="#event-dnd-drag">drag</a></code>
    </td></tr><tr><td><dfn id="handler-ondragend"><code>ondragend</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragend"><a href="#event-dnd-dragend">dragend</a></code>
    </td></tr><tr><td><dfn id="handler-ondragenter"><code>ondragenter</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragenter"><a href="#event-dnd-dragenter">dragenter</a></code>
    </td></tr><tr><td><dfn id="handler-ondragexit"><code>ondragexit</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragexit"><a href="#event-dnd-dragexit">dragexit</a></code>
    </td></tr><tr><td><dfn id="handler-ondragleave"><code>ondragleave</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragleave"><a href="#event-dnd-dragleave">dragleave</a></code>
    </td></tr><tr><td><dfn id="handler-ondragover"><code>ondragover</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragover"><a href="#event-dnd-dragover">dragover</a></code>
    </td></tr><tr><td><dfn id="handler-ondragstart"><code>ondragstart</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-dragstart"><a href="#event-dnd-dragstart">dragstart</a></code> 
    </td></tr><tr><td><dfn id="handler-ondrop"><code>ondrop</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-dnd-drop"><a href="#event-dnd-drop">drop</a></code>
    </td></tr><tr><td><dfn id="handler-ondurationchange"><code>ondurationchange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code>
    </td></tr><tr><td><dfn id="handler-onemptied"><code>onemptied</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-emptied"><a href="#event-media-emptied">emptied</a></code>
    </td></tr><tr><td><dfn id="handler-onended"><code>onended</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-ended"><a href="#event-media-ended">ended</a></code>
    </td></tr><tr><td><dfn id="handler-oninput"><code>oninput</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-input"><a href="/breakup/specs/html/#event-input">input</a></code>
    </td></tr><tr><td><dfn id="handler-oninvalid"><code>oninvalid</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-invalid"><a href="/breakup/specs/html/#event-invalid">invalid</a></code>
    </td></tr><tr><td><dfn id="handler-onkeydown"><code>onkeydown</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-keydown"><a href="/breakup/specs/core-algorithms/#event-keydown">keydown</a></code> 
    </td></tr><tr><td><dfn id="handler-onkeypress"><code>onkeypress</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-keypress"><a href="/breakup/specs/core-algorithms/#event-keypress">keypress</a></code> 
    </td></tr><tr><td><dfn id="handler-onkeyup"><code>onkeyup</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-keyup"><a href="/breakup/specs/core-algorithms/#event-keyup">keyup</a></code> 
    </td></tr><tr><td><dfn id="handler-onloadeddata"><code>onloadeddata</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-loadeddata"><a href="#event-media-loadeddata">loadeddata</a></code>
    </td></tr><tr><td><dfn id="handler-onloadedmetadata"><code>onloadedmetadata</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-loadedmetadata"><a href="#event-media-loadedmetadata">loadedmetadata</a></code>
    </td></tr><tr><td><dfn id="handler-onloadstart"><code>onloadstart</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-loadstart"><a href="#event-media-loadstart">loadstart</a></code>
    </td></tr><tr><td><dfn id="handler-onmousedown"><code>onmousedown</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mousedown"><a href="/breakup/specs/core-algorithms/#event-mousedown">mousedown</a></code> 
    </td></tr><tr><td><dfn id="handler-onmouseenter"><code>onmouseenter</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mouseenter"><a href="/breakup/specs/core-algorithms/#event-mouseenter">mouseenter</a></code> 
    </td></tr><tr><td><dfn id="handler-onmouseleave"><code>onmouseleave</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mouseleave"><a href="/breakup/specs/core-algorithms/#event-mouseleave">mouseleave</a></code> 
    </td></tr><tr><td><dfn id="handler-onmousemove"><code>onmousemove</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mousemove"><a href="/breakup/specs/core-algorithms/#event-mousemove">mousemove</a></code> 
    </td></tr><tr><td><dfn id="handler-onmouseout"><code>onmouseout</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mouseout"><a href="/breakup/specs/core-algorithms/#event-mouseout">mouseout</a></code> 
    </td></tr><tr><td><dfn id="handler-onmouseover"><code>onmouseover</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mouseover"><a href="/breakup/specs/core-algorithms/#event-mouseover">mouseover</a></code> 
    </td></tr><tr><td><dfn id="handler-onmouseup"><code>onmouseup</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mouseup"><a href="/breakup/specs/core-algorithms/#event-mouseup">mouseup</a></code> 
    </td></tr><tr><td><dfn id="handler-onmousewheel"><code>onmousewheel</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-mousewheel"><a href="/breakup/specs/core-algorithms/#event-mousewheel">mousewheel</a></code> 
    </td></tr><tr><td><dfn id="handler-onpause"><code>onpause</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-pause"><a href="#event-media-pause">pause</a></code>
    </td></tr><tr><td><dfn id="handler-onplay"><code>onplay</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-play"><a href="#event-media-play">play</a></code>
    </td></tr><tr><td><dfn id="handler-onplaying"><code>onplaying</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-playing"><a href="#event-media-playing">playing</a></code>
    </td></tr><tr><td><dfn id="handler-onprogress"><code>onprogress</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-progress"><a href="#event-media-progress">progress</a></code>
    </td></tr><tr><td><dfn id="handler-onratechange"><code>onratechange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-ratechange"><a href="#event-media-ratechange">ratechange</a></code>
    </td></tr><tr><td><dfn id="handler-onreset"><code>onreset</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-reset"><a href="/breakup/specs/html/#event-reset">reset</a></code>
    </td></tr><tr><td><dfn id="handler-onseeked"><code>onseeked</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-seeked"><a href="#event-media-seeked">seeked</a></code>
    </td></tr><tr><td><dfn id="handler-onseeking"><code>onseeking</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-seeking"><a href="#event-media-seeking">seeking</a></code>
    </td></tr><tr><td><dfn id="handler-onselect"><code>onselect</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-select"><a href="/breakup/specs/html/#event-select">select</a></code>  
    </td></tr><tr><td><dfn id="handler-onshow"><code>onshow</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-show"><a href="/breakup/specs/html/#event-show">show</a></code>
    </td></tr><tr><td><dfn id="handler-onsort"><code>onsort</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-sort"><a href="/breakup/specs/html/#event-sort">sort</a></code>
    </td></tr><tr><td><dfn id="handler-onstalled"><code>onstalled</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-stalled"><a href="#event-media-stalled">stalled</a></code>
    </td></tr><tr><td><dfn id="handler-onsubmit"><code>onsubmit</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-submit"><a href="/breakup/specs/html/#event-submit">submit</a></code> 
    </td></tr><tr><td><dfn id="handler-onsuspend"><code>onsuspend</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-suspend"><a href="#event-media-suspend">suspend</a></code>
    </td></tr><tr><td><dfn id="handler-ontimeupdate"><code>ontimeupdate</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code>
    </td></tr><tr><td><dfn id="handler-ontoggle"><code>ontoggle</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-toggle"><a href="/breakup/specs/html/#event-toggle">toggle</a></code>
    </td></tr><tr><td><dfn id="handler-onvolumechange"><code>onvolumechange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-volumechange"><a href="#event-media-volumechange">volumechange</a></code>
    </td></tr><tr><td><dfn id="handler-onwaiting"><code>onwaiting</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-media-waiting"><a href="#event-media-waiting">waiting</a></code>


 
 
 

 
  </td></tr></tbody></table>

  <hr>

  <p>The following are the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-3">event handlers</a> (and their corresponding <a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-3">event handler event types</a>) that must be
  supported by all <a href="/breakup/specs/core-algorithms/#html-elements" id="event-handlers-on-elements,-document-objects,-and-window-objects:html-elements-2">HTML elements</a> other than <code id="event-handlers-on-elements,-document-objects,-and-window-objects:the-body-element"><a href="#the-body-element">body</a></code> and <code id="event-handlers-on-elements,-document-objects,-and-window-objects:frameset"><a href="#frameset">frameset</a></code>
  elements, as both <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-content-attributes-2">event handler content attributes</a> and <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-3">event handler IDL
  attributes</a>; that must be supported by all <code id="event-handlers-on-elements,-document-objects,-and-window-objects:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
  objects, as <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-4">event handler IDL attributes</a>; and that must be
  supported by all <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects, as <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-5">event handler IDL attributes</a> on the
  <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects themselves, and with corresponding <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-content-attributes-3">event handler content
  attributes</a> and <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-6">event handler IDL attributes</a> exposed on all <code id="event-handlers-on-elements,-document-objects,-and-window-objects:the-body-element-2"><a href="#the-body-element">body</a></code>
  and <code id="event-handlers-on-elements,-document-objects,-and-window-objects:frameset-2"><a href="#frameset">frameset</a></code> elements that are owned by <a href="/breakup/specs/browser-dom/#concept-document-window" id="event-handlers-on-elements,-document-objects,-and-window-objects:concept-document-window">that
  <code>Window</code> object's <code>Document</code>s</a>:</p>

  <table><thead><tr><th><a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-4">Event handler</a> </th><th><a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-4">Event handler event type</a>
   </th></tr></thead><tbody><tr><td><dfn id="handler-onblur"><code>onblur</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-blur"><a href="/breakup/specs/html/#event-blur">blur</a></code> 
    </td></tr><tr><td><dfn id="handler-onerror"><code>onerror</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-error"><a href="/breakup/specs/html/#event-error">error</a></code>
    </td></tr><tr><td><dfn id="handler-onfocus"><code>onfocus</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-focus"><a href="/breakup/specs/html/#event-focus">focus</a></code> 
    </td></tr><tr><td><dfn id="handler-onload"><code>onload</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-load"><a href="/breakup/specs/html/#event-load">load</a></code>
    </td></tr><tr><td><dfn id="handler-onresize"><code>onresize</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-resize"><a href="/breakup/specs/core-algorithms/#event-resize">resize</a></code>
    </td></tr><tr><td><dfn id="handler-onscroll"><code>onscroll</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-scroll"><a href="/breakup/specs/core-algorithms/#event-scroll">scroll</a></code>
  </td></tr></tbody></table>

  <hr>

  <p>The following are the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-5">event handlers</a> (and their corresponding <a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-5">event handler event types</a>) that must be
  supported by <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects, as <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-7">event handler IDL attributes</a> on the
  <code id="event-handlers-on-elements,-document-objects,-and-window-objects:window-6"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects themselves, and with corresponding <a href="/breakup/specs/browser-dom/#event-handler-content-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-content-attributes-4">event handler content
  attributes</a> and <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-8">event handler IDL attributes</a> exposed on all <code id="event-handlers-on-elements,-document-objects,-and-window-objects:the-body-element-3"><a href="#the-body-element">body</a></code>
  and <code id="event-handlers-on-elements,-document-objects,-and-window-objects:frameset-3"><a href="#frameset">frameset</a></code> elements that are owned by <a href="/breakup/specs/browser-dom/#concept-document-window" id="event-handlers-on-elements,-document-objects,-and-window-objects:concept-document-window-2">that
  <code>Window</code> object's <code>Document</code>s</a>:</p>

  <table><thead><tr><th><a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-6">Event handler</a> </th><th><a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-6">Event handler event type</a>
   </th></tr></thead><tbody><tr><td><dfn id="handler-window-onafterprint"><code>onafterprint</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-afterprint"><a href="/breakup/specs/html/#event-afterprint">afterprint</a></code>
    </td></tr><tr><td><dfn id="handler-window-onbeforeprint"><code>onbeforeprint</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-beforeprint"><a href="/breakup/specs/html/#event-beforeprint">beforeprint</a></code>
    </td></tr><tr><td><dfn id="handler-window-onbeforeunload"><code>onbeforeunload</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-beforeunload"><a href="/breakup/specs/html/#event-beforeunload">beforeunload</a></code>
    </td></tr><tr><td><dfn id="handler-window-onhashchange"><code>onhashchange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-hashchange"><a href="/breakup/specs/html/#event-hashchange">hashchange</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onlanguagechange"><code>onlanguagechange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-languagechange"><a href="/breakup/specs/html/#event-languagechange">languagechange</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onmessage"><code>onmessage</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-message"><a href="/breakup/specs/html/#event-message">message</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onoffline"><code>onoffline</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-offline"><a href="/breakup/specs/html/#event-offline">offline</a></code> 
    </td></tr><tr><td><dfn id="handler-window-ononline"><code>ononline</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-online"><a href="/breakup/specs/html/#event-online">online</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onpagehide"><code>onpagehide</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-pagehide"><a href="/breakup/specs/html/#event-pagehide">pagehide</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onpageshow"><code>onpageshow</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-pageshow"><a href="/breakup/specs/html/#event-pageshow">pageshow</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onpopstate"><code>onpopstate</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-popstate"><a href="/breakup/specs/html/#event-popstate">popstate</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onstorage"><code>onstorage</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-storage"><a href="/breakup/specs/html/#event-storage">storage</a></code> 
    </td></tr><tr><td><dfn id="handler-window-onunload"><code>onunload</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-unload"><a href="/breakup/specs/html/#event-unload">unload</a></code> 
  </td></tr></tbody></table>

  <hr>

  

  <p>The following are the <a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-7">event handlers</a> (and their corresponding <a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-7">event handler event types</a>) that must be
  supported on <code id="event-handlers-on-elements,-document-objects,-and-window-objects:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects as <a href="/breakup/specs/browser-dom/#event-handler-idl-attributes" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-idl-attributes-9">event handler IDL attributes</a>:</p>

  <table><thead><tr><th><a href="/breakup/specs/browser-dom/#event-handlers" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handlers-8">Event handler</a> </th><th><a href="/breakup/specs/browser-dom/#event-handler-event-type" id="event-handlers-on-elements,-document-objects,-and-window-objects:event-handler-event-type-8">Event handler event type</a>
   </th></tr></thead><tbody><tr><td><dfn id="handler-onreadystatechange"><code>onreadystatechange</code></dfn> </td><td> <code id="event-handlers-on-elements,-document-objects,-and-window-objects:event-readystatechange"><a href="/breakup/specs/html/#event-readystatechange">readystatechange</a></code>
  </td></tr></tbody></table>


  <section><h6 id="idl-definitions">7.1.5.2.1 IDL definitions</h6>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="globaleventhandlers">GlobalEventHandlers</dfn> {
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onabort" id="idl-definitions:handler-onabort">onabort</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-2">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onautocomplete" id="idl-definitions:handler-onautocomplete">onautocomplete</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-3">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onautocompleteerror" id="idl-definitions:handler-onautocompleteerror">onautocompleteerror</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-4">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onblur" id="idl-definitions:handler-onblur">onblur</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-5">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oncancel" id="idl-definitions:handler-oncancel">oncancel</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-6">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oncanplay" id="idl-definitions:handler-oncanplay">oncanplay</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-7">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oncanplaythrough" id="idl-definitions:handler-oncanplaythrough">oncanplaythrough</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-8">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onchange" id="idl-definitions:handler-onchange">onchange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-9">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onclick" id="idl-definitions:handler-onclick">onclick</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-10">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onclose" id="idl-definitions:handler-onclose">onclose</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-11">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oncontextmenu" id="idl-definitions:handler-oncontextmenu">oncontextmenu</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-12">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oncuechange" id="idl-definitions:handler-oncuechange">oncuechange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-13">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondblclick" id="idl-definitions:handler-ondblclick">ondblclick</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-14">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondrag" id="idl-definitions:handler-ondrag">ondrag</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-15">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragend" id="idl-definitions:handler-ondragend">ondragend</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-16">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragenter" id="idl-definitions:handler-ondragenter">ondragenter</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-17">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragexit" id="idl-definitions:handler-ondragexit">ondragexit</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-18">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragleave" id="idl-definitions:handler-ondragleave">ondragleave</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-19">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragover" id="idl-definitions:handler-ondragover">ondragover</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-20">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondragstart" id="idl-definitions:handler-ondragstart">ondragstart</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-21">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondrop" id="idl-definitions:handler-ondrop">ondrop</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-22">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ondurationchange" id="idl-definitions:handler-ondurationchange">ondurationchange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-23">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onemptied" id="idl-definitions:handler-onemptied">onemptied</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-24">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onended" id="idl-definitions:handler-onended">onended</a>;
  attribute <a href="/breakup/specs/browser-dom/#onerroreventhandler" id="idl-definitions:onerroreventhandler">OnErrorEventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onerror" id="idl-definitions:handler-onerror">onerror</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-25">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onfocus" id="idl-definitions:handler-onfocus">onfocus</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-26">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oninput" id="idl-definitions:handler-oninput">oninput</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-27">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-oninvalid" id="idl-definitions:handler-oninvalid">oninvalid</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-28">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onkeydown" id="idl-definitions:handler-onkeydown">onkeydown</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-29">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onkeypress" id="idl-definitions:handler-onkeypress">onkeypress</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-30">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onkeyup" id="idl-definitions:handler-onkeyup">onkeyup</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-31">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onload" id="idl-definitions:handler-onload">onload</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-32">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onloadeddata" id="idl-definitions:handler-onloadeddata">onloadeddata</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-33">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onloadedmetadata" id="idl-definitions:handler-onloadedmetadata">onloadedmetadata</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-34">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onloadstart" id="idl-definitions:handler-onloadstart">onloadstart</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-35">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmousedown" id="idl-definitions:handler-onmousedown">onmousedown</a>;
  [LenientThis] attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-36">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmouseenter" id="idl-definitions:handler-onmouseenter">onmouseenter</a>;
  [LenientThis] attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-37">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmouseleave" id="idl-definitions:handler-onmouseleave">onmouseleave</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-38">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmousemove" id="idl-definitions:handler-onmousemove">onmousemove</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-39">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmouseout" id="idl-definitions:handler-onmouseout">onmouseout</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-40">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmouseover" id="idl-definitions:handler-onmouseover">onmouseover</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-41">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmouseup" id="idl-definitions:handler-onmouseup">onmouseup</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-42">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onmousewheel" id="idl-definitions:handler-onmousewheel">onmousewheel</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-43">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onpause" id="idl-definitions:handler-onpause">onpause</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-44">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onplay" id="idl-definitions:handler-onplay">onplay</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-45">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onplaying" id="idl-definitions:handler-onplaying">onplaying</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-46">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onprogress" id="idl-definitions:handler-onprogress">onprogress</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-47">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onratechange" id="idl-definitions:handler-onratechange">onratechange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-48">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onreset" id="idl-definitions:handler-onreset">onreset</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-49">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onresize" id="idl-definitions:handler-onresize">onresize</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-50">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onscroll" id="idl-definitions:handler-onscroll">onscroll</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-51">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onseeked" id="idl-definitions:handler-onseeked">onseeked</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-52">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onseeking" id="idl-definitions:handler-onseeking">onseeking</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-53">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onselect" id="idl-definitions:handler-onselect">onselect</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-54">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onshow" id="idl-definitions:handler-onshow">onshow</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-55">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onsort" id="idl-definitions:handler-onsort">onsort</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-56">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onstalled" id="idl-definitions:handler-onstalled">onstalled</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-57">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onsubmit" id="idl-definitions:handler-onsubmit">onsubmit</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-58">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onsuspend" id="idl-definitions:handler-onsuspend">onsuspend</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-59">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ontimeupdate" id="idl-definitions:handler-ontimeupdate">ontimeupdate</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-60">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-ontoggle" id="idl-definitions:handler-ontoggle">ontoggle</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-61">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onvolumechange" id="idl-definitions:handler-onvolumechange">onvolumechange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-62">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-onwaiting" id="idl-definitions:handler-onwaiting">onwaiting</a>;
};

[NoInterfaceObject]
interface <dfn id="windoweventhandlers">WindowEventHandlers</dfn> {
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-63">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onafterprint" id="idl-definitions:handler-window-onafterprint">onafterprint</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-64">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onbeforeprint" id="idl-definitions:handler-window-onbeforeprint">onbeforeprint</a>;
  attribute <a href="/breakup/specs/browser-dom/#onbeforeunloadeventhandler" id="idl-definitions:onbeforeunloadeventhandler">OnBeforeUnloadEventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onbeforeunload" id="idl-definitions:handler-window-onbeforeunload">onbeforeunload</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-65">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onhashchange" id="idl-definitions:handler-window-onhashchange">onhashchange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-66">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onlanguagechange" id="idl-definitions:handler-window-onlanguagechange">onlanguagechange</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-67">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onmessage" id="idl-definitions:handler-window-onmessage">onmessage</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-68">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onoffline" id="idl-definitions:handler-window-onoffline">onoffline</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-69">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-ononline" id="idl-definitions:handler-window-ononline">ononline</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-70">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onpagehide" id="idl-definitions:handler-window-onpagehide">onpagehide</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-71">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onpageshow" id="idl-definitions:handler-window-onpageshow">onpageshow</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-72">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onpopstate" id="idl-definitions:handler-window-onpopstate">onpopstate</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-73">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onstorage" id="idl-definitions:handler-window-onstorage">onstorage</a>;
  attribute <a href="/breakup/specs/browser-dom/#eventhandler" id="idl-definitions:eventhandler-74">EventHandler</a> <a href="/breakup/specs/browser-dom/#handler-window-onunload" id="idl-definitions:handler-window-onunload">onunload</a>;
};</pre></section></section>



  

  <section><h5 id="event-firing">7.1.5.3 Event firing</h5>

  <p>Certain operations and methods are defined as firing events on elements. For example, the <code id="event-firing:dom-click"><a href="#dom-click">click()</a></code> method on the <code id="event-firing:htmlelement"><a href="#htmlelement">HTMLElement</a></code> interface is defined as
  firing a <code id="event-firing:event-click"><a href="/breakup/specs/core-algorithms/#event-click">click</a></code> event on the element. <a href="#refsDOMEVENTS">[DOMEVENTS]</a></p>

  <p><dfn id="fire-a-simple-event">Firing a simple event named <var>e</var></dfn>
  means that a <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="event-firing:concept-events-trusted">trusted</a> event with the name <var>e</var>, which does not bubble (except where otherwise stated) and is not cancelable
  (except where otherwise stated), and which uses the <code id="event-firing:event"><a href="/breakup/specs/core-algorithms/#event">Event</a></code> interface, must be created
  and <a href="/breakup/specs/core-algorithms/#concept-event-dispatch" id="event-firing:concept-event-dispatch">dispatched</a> at the given target.</p>

  <p><dfn id="fire-a-synthetic-mouse-event">Firing a synthetic mouse event named <var>e</var></dfn> means that an event with the name <var>e</var>, which is <a href="/breakup/specs/core-algorithms/#concept-events-trusted" id="event-firing:concept-events-trusted-2">trusted</a> (except where otherwise stated), does not bubble
  (except where otherwise stated), is not cancelable (except where otherwise stated), and which uses
  the <code id="event-firing:mouseevent"><a href="/breakup/specs/core-algorithms/#mouseevent">MouseEvent</a></code> interface, must be created and dispatched at the given target. The
  event object must have its <code>screenX</code>, <code>screenY</code>, <code>clientX</code>, <code>clientY</code>, and <code>button</code>
  attributes initialised to 0, its <code>ctrlKey</code>, <code>shiftKey</code>,
  <code>altKey</code>, and <code>metaKey</code> attributes initialised according
  to the current state of the key input device, if any (false for any keys that are not available),
  its <code>detail</code> attribute initialised to 1, its <code id="event-firing:dom-mouseevent-relatedtarget"><a href="/breakup/specs/core-algorithms/#dom-mouseevent-relatedtarget">relatedTarget</a></code> attribute initialised to null (except
  where otherwise stated), and its <code id="event-firing:dom-uievent-view"><a href="/breakup/specs/core-algorithms/#dom-uievent-view">view</a></code> attribute initialised to the <code id="event-firing:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the <code id="event-firing:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object of the given target node, if any, or else null. The <code>getModifierState()</code> method on the object must
  return values appropriately describing the state of the key input device at the time the event is
  created.</p>

  <p><dfn id="fire-a-click-event">Firing a <code>click</code> event</dfn>
  means <a href="/breakup/specs/browser-dom/#fire-a-synthetic-mouse-event" id="event-firing:fire-a-synthetic-mouse-event">firing a synthetic mouse event named <code>click</code></a>, which bubbles and is cancelable.</p>

  <p>The default action of these events is to do nothing except where otherwise stated.</p></section>

  


  

  <section><h5 id="events-and-the-window-object">7.1.5.4 Events and the <code id="events-and-the-window-object:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object</h5>

  <p>When an event is dispatched at a DOM node in a <code id="events-and-the-window-object:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in a <a href="/breakup/specs/browser-dom/#browsing-context" id="events-and-the-window-object:browsing-context">browsing
  context</a>, if the event is not a <code id="events-and-the-window-object:event-load"><a href="/breakup/specs/html/#event-load">load</a></code> event, the user agent
  must act as if, for the purposes of <a href="/breakup/specs/core-algorithms/#concept-event-dispatch" id="events-and-the-window-object:concept-event-dispatch">event dispatching</a>,
  the <code id="events-and-the-window-object:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object is the parent of the <code id="events-and-the-window-object:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object. <a href="#refsDOM">[DOM]</a></p></section></section></section><section><h3 id="atob">7.2 Base64 utility methods</h3>

  <p>The <code id="atob:dom-windowbase64-atob"><a href="/breakup/specs/browser-dom/#dom-windowbase64-atob">atob()</a></code> and <code id="atob:dom-windowbase64-btoa"><a href="/breakup/specs/browser-dom/#dom-windowbase64-btoa">btoa()</a></code> methods allow authors to transform content to and from
  the base64 encoding.</p>

  

  <pre class="idl">[NoInterfaceObject, Exposed=(Window,Worker)]
interface <dfn id="windowbase64">WindowBase64</dfn> {
  DOMString <a href="/breakup/specs/browser-dom/#dom-windowbase64-btoa" id="atob:dom-windowbase64-btoa-2">btoa</a>(DOMString btoa);
  DOMString <a href="/breakup/specs/browser-dom/#dom-windowbase64-atob" id="atob:dom-windowbase64-atob-2">atob</a>(DOMString atob);
};
<a href="/breakup/specs/browser-dom/#window" id="atob:window">Window</a> implements <a href="/breakup/specs/browser-dom/#windowbase64" id="atob:windowbase64">WindowBase64</a>;</pre>

  <p class="note">In these APIs, for mnemonic purposes, the "b" can be considered to stand for
  "binary", and the "a" for "ASCII". In practice, though, for primarily historical reasons, both the
  input and output of these functions are Unicode strings.</p>

  <dl class="domintro"><dt><var>result</var> = <var>window</var> . <code id="atob:dom-windowbase64-btoa-3"><a href="/breakup/specs/browser-dom/#dom-windowbase64-btoa">btoa</a></code>( <var>data</var> )</dt><dd>

    <p>Takes the input data, in the form of a Unicode string containing only characters in the range
    U+0000 to U+00FF, each representing a binary byte with values 0x00 to 0xFF respectively, and
    converts it to its base64 representation, which it returns.</p>

    <p>Throws an <code id="atob:invalidcharactererror"><a href="/breakup/specs/core-algorithms/#invalidcharactererror">InvalidCharacterError</a></code> exception if the input string contains any
    out-of-range characters.</p>

   </dd><dt><var>result</var> = <var>window</var> . <code id="atob:dom-windowbase64-atob-3"><a href="/breakup/specs/browser-dom/#dom-windowbase64-atob">atob</a></code>( <var>data</var> )</dt><dd>

    <p>Takes the input data, in the form of a Unicode string containing base64-encoded binary data,
    decodes it, and returns a string consisting of characters in the range U+0000 to U+00FF, each
    representing a binary byte with values 0x00 to 0xFF respectively, corresponding to that binary
    data.</p>

    <p>Throws an <code id="atob:invalidcharactererror-2"><a href="/breakup/specs/core-algorithms/#invalidcharactererror">InvalidCharacterError</a></code> exception if the input string is not valid
    base64 data.</p>

   </dd></dl>

  

  <p class="note">The <code id="atob:windowbase64-2"><a href="/breakup/specs/browser-dom/#windowbase64">WindowBase64</a></code> interface adds to the <code id="atob:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> interface
  and the <code id="atob:workerglobalscope"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> interface (part of Web workers).</p>

  <p>The <dfn id="dom-windowbase64-btoa"><code>btoa()</code></dfn> method must throw an
  <code id="atob:invalidcharactererror-3"><a href="/breakup/specs/core-algorithms/#invalidcharactererror">InvalidCharacterError</a></code> exception if the method's first argument contains any character
  whose code point is greater than U+00FF. Otherwise, the user agent must convert that argument to a
  sequence of octets whose <var>n</var>th octet is the eight-bit representation of the code
  point of the <var>n</var>th character of the argument, and then must apply the base64
  algorithm to that sequence of octets, and return the result. <a href="#refsRFC4648">[RFC4648]</a></p> 


  <p>The <dfn id="dom-windowbase64-atob"><code>atob()</code></dfn> method must run the following
  steps to parse the string passed in the method's first argument:</p>

  <ol><li><p>Let <var>input</var> be the string being parsed.</p></li><li><p>Let <var>position</var> be a pointer into <var>input</var>, initially
   pointing at the start of the string.</p></li><li><p>Remove all <a href="/breakup/specs/core-algorithms/#space-character" id="atob:space-character">space characters</a> from <var>input</var>.</p></li><li><p>If the length of <var>input</var> divides by 4 leaving no remainder, then: if
   <var>input</var> ends with one or two U+003D EQUALS SIGN (=) characters, remove them
   from <var>input</var>.</p></li><li><p>If the length of <var>input</var> divides by 4 leaving a remainder of 1, throw an
   <code id="atob:invalidcharactererror-4"><a href="/breakup/specs/core-algorithms/#invalidcharactererror">InvalidCharacterError</a></code> exception and abort these steps.</p>

   </li><li>

    <p>If <var>input</var> contains a character that is not in the following list of
    characters and character ranges, throw an <code id="atob:invalidcharactererror-5"><a href="/breakup/specs/core-algorithms/#invalidcharactererror">InvalidCharacterError</a></code> exception and abort
    these steps:</p>

    <ul class="brief"><li>U+002B PLUS SIGN (+)
     </li><li>U+002F SOLIDUS (/)
     </li><li><a href="/breakup/specs/core-algorithms/#alphanumeric-ascii-characters" id="atob:alphanumeric-ascii-characters">Alphanumeric ASCII characters</a>
    </li></ul>

   </li><li><p>Let <var>output</var> be a string, initially empty.</p></li><li><p>Let <var>buffer</var> be a buffer that can have bits appended to it, initially
   empty.</p></li><li>

    <p>While <var>position</var> does not point past the end of <var>input</var>,
    run these substeps:</p>

    <ol><li>

      <p>Find the character pointed to by <var>position</var> in the first column of the
      following table. Let <var>n</var> be the number given in the second cell of the same
      row.</p>

      <div id="base64-table">
       <table><thead><tr><th>Character
          </th><th>Number
        </th></tr></thead><tbody><tr><td>A</td><td>0
         </td></tr><tr><td>B</td><td>1
         </td></tr><tr><td>C</td><td>2
         </td></tr><tr><td>D</td><td>3
         </td></tr><tr><td>E</td><td>4
         </td></tr><tr><td>F</td><td>5
         </td></tr><tr><td>G</td><td>6
         </td></tr><tr><td>H</td><td>7
         </td></tr><tr><td>I</td><td>8
         </td></tr><tr><td>J</td><td>9
         </td></tr><tr><td>K</td><td>10
         </td></tr><tr><td>L</td><td>11
         </td></tr><tr><td>M</td><td>12
         </td></tr><tr><td>N</td><td>13
         </td></tr><tr><td>O</td><td>14
         </td></tr><tr><td>P</td><td>15
         </td></tr><tr><td>Q</td><td>16
         </td></tr><tr><td>R</td><td>17
         </td></tr><tr><td>S</td><td>18
         </td></tr><tr><td>T</td><td>19
         </td></tr><tr><td>U</td><td>20
         </td></tr><tr><td>V</td><td>21
         </td></tr><tr><td>W</td><td>22
         </td></tr><tr><td>X</td><td>23
         </td></tr><tr><td>Y</td><td>24
         </td></tr><tr><td>Z</td><td>25
         </td></tr><tr><td>a</td><td>26
         </td></tr><tr><td>b</td><td>27
         </td></tr><tr><td>c</td><td>28
         </td></tr><tr><td>d</td><td>29
         </td></tr><tr><td>e</td><td>30
         </td></tr><tr><td>f</td><td>31
         </td></tr><tr><td>g</td><td>32
         </td></tr><tr><td>h</td><td>33
         </td></tr><tr><td>i</td><td>34
         </td></tr><tr><td>j</td><td>35
         </td></tr><tr><td>k</td><td>36
         </td></tr><tr><td>l</td><td>37
         </td></tr><tr><td>m</td><td>38
         </td></tr><tr><td>n</td><td>39
         </td></tr><tr><td>o</td><td>40
         </td></tr><tr><td>p</td><td>41
         </td></tr><tr><td>q</td><td>42
         </td></tr><tr><td>r</td><td>43
         </td></tr><tr><td>s</td><td>44
         </td></tr><tr><td>t</td><td>45
         </td></tr><tr><td>u</td><td>46
         </td></tr><tr><td>v</td><td>47
         </td></tr><tr><td>w</td><td>48
         </td></tr><tr><td>x</td><td>49
         </td></tr><tr><td>y</td><td>50
         </td></tr><tr><td>z</td><td>51
         </td></tr><tr><td>0</td><td>52
         </td></tr><tr><td>1</td><td>53
         </td></tr><tr><td>2</td><td>54
         </td></tr><tr><td>3</td><td>55
         </td></tr><tr><td>4</td><td>56
         </td></tr><tr><td>5</td><td>57
         </td></tr><tr><td>6</td><td>58
         </td></tr><tr><td>7</td><td>59
         </td></tr><tr><td>8</td><td>60
         </td></tr><tr><td>9</td><td>61
         </td></tr><tr><td>+</td><td>62
         </td></tr><tr><td>/</td><td>63
       </td></tr></tbody></table>
      </div>

     </li><li><p>Append to <var>buffer</var> the six bits corresponding to <var>number</var>, most significant bit first.</p></li><li><p>If <var>buffer</var> has accumulated 24 bits, interpret them as three 8-bit
     big-endian numbers. Append the three characters with code points equal to those numbers to <var>output</var>, in the same order, and then empty <var>buffer</var>.</p></li><li><p>Advance <var>position</var> by one character.</p></li></ol>

   </li><li>

    <p>If <var>buffer</var> is not empty, it contains either 12 or 18 bits. If it contains
    12 bits, discard the last four and interpret the remaining eight as an 8-bit big-endian number.
    If it contains 18 bits, discard the last two and interpret the remaining 16 as two 8-bit
    big-endian numbers. Append the one or two characters with code points equal to those one or two
    numbers to <var>output</var>, in the same order.</p>

    <p class="note">The discarded bits mean that, for instance, <code>atob("YQ")</code> and
    <code>atob("YR")</code> both return "<code>a</code>".</p>

   </li><li><p>Return <var>output</var>.</p></li></ol></section><section><h3 id="dynamic-markup-insertion">7.3 <dfn>Dynamic markup insertion</dfn></h3>

  <p class="note">APIs for dynamically inserting markup into the document interact with the parser,
  and thus their behaviour varies depending on whether they are used with <a href="/breakup/specs/core-algorithms/#html-documents" id="dynamic-markup-insertion:html-documents">HTML documents</a>
  (and the <a href="#html-parser" id="dynamic-markup-insertion:html-parser">HTML parser</a>) or XHTML in <a href="/breakup/specs/core-algorithms/#xml-documents" id="dynamic-markup-insertion:xml-documents">XML documents</a> (and the <a href="#xml-parser" id="dynamic-markup-insertion:xml-parser">XML
  parser</a>).</p>



  <section><h4 id="opening-the-input-stream">7.3.1 Opening the input stream</h4>

  <p>The <dfn id="dom-document-open"><code>open()</code></dfn> method comes in several variants
  with different numbers of arguments.</p>

  <dl class="domintro"><dt><var>document</var> = <var>document</var> . <code id="opening-the-input-stream:dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">open</a></code>( [ <var>type</var> [, <var>replace</var> ] ] )</dt><dd>

    <p>Causes the <code id="opening-the-input-stream:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> to be replaced in-place, as if it was a new
    <code id="opening-the-input-stream:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, but reusing the previous object, which is then returned.</p>

    <p>If the <var>type</var> argument is omitted or has the value
    "<code id="opening-the-input-stream:text/html"><a href="#text/html">text/html</a></code>", then the resulting <code id="opening-the-input-stream:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has an HTML parser associated
    with it, which can be given data to parse using <code id="opening-the-input-stream:dom-document-write"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code>. Otherwise, all content passed to <code id="opening-the-input-stream:dom-document-write-2"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> will be parsed as plain text.</p>

    <p>If the <var>replace</var> argument is present and has the value "<code>replace</code>", the existing entries in the session history for the
    <code id="opening-the-input-stream:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object are removed.</p>

    <p>The method has no effect if the <code id="opening-the-input-stream:document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is still being parsed.</p>

    <p>Throws an <code id="opening-the-input-stream:invalidstateerror"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception if the <code id="opening-the-input-stream:document-6"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is an <a href="/breakup/specs/core-algorithms/#xml-documents" id="opening-the-input-stream:xml-documents">XML document</a>.</p>

   </dd><dt><var>window</var> = <var>document</var> . <code id="opening-the-input-stream:dom-document-open-2"><a href="/breakup/specs/browser-dom/#dom-document-open">open</a></code>( <var>url</var>, <var>name</var>, <var>features</var> [, <var>replace</var> ] )</dt><dd>

    <p>Works like the <code id="opening-the-input-stream:dom-open"><a href="/breakup/specs/browser-dom/#dom-open">window.open()</a></code> method.</p>

   </dd></dl>

  

  <p><code id="opening-the-input-stream:document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects have an <dfn id="ignore-opens-during-unload-counter">ignore-opens-during-unload counter</dfn>, which is
  used to prevent scripts from invoking the <code id="opening-the-input-stream:dom-document-open-3"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code>
  method (directly or indirectly) while the document is <a href="#unload-a-document" id="opening-the-input-stream:unload-a-document">being
  unloaded</a>. Initially, the counter must be set to zero.</p> 

  <p>When called with two arguments (or fewer), the <code id="opening-the-input-stream:dom-document-open-4"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code>
  method must act as follows:</p>

  <ol><li><p>If the <code id="opening-the-input-stream:document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is not flagged as an <a href="/breakup/specs/core-algorithms/#html-documents" id="opening-the-input-stream:html-documents">HTML
   document</a>, throw an <code id="opening-the-input-stream:invalidstateerror-2"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="opening-the-input-stream:document-9"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is not an <a href="/breakup/specs/browser-dom/#active-document" id="opening-the-input-stream:active-document">active document</a>, then abort
   these steps.</p></li><li><p>Let <var>type</var> be the value of the first argument.</p></li><li>

    <p>If the second argument is an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="opening-the-input-stream:ascii-case-insensitive">ASCII case-insensitive</a> match for the value
    "replace", then let <var>replace</var> be true.</p>

    <p>Otherwise, if the <a href="/breakup/specs/browser-dom/#browsing-context" id="opening-the-input-stream:browsing-context">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="opening-the-input-stream:session-history">session history</a> contains only
    one <code id="opening-the-input-stream:document-10"><a href="/breakup/specs/browser-dom/#document">Document</a></code>, and that was the <code id="opening-the-input-stream:about:blank"><a href="/breakup/specs/core-algorithms/#about:blank">about:blank</a></code> <code id="opening-the-input-stream:document-11"><a href="/breakup/specs/browser-dom/#document">Document</a></code>
    created when the <a href="/breakup/specs/browser-dom/#browsing-context" id="opening-the-input-stream:browsing-context-2">browsing context</a> was <a href="/breakup/specs/browser-dom/#creating-a-new-browsing-context" id="opening-the-input-stream:creating-a-new-browsing-context">created</a>, and that <code id="opening-the-input-stream:document-12"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has
    never had the <a href="#unload-a-document" id="opening-the-input-stream:unload-a-document-2">unload a document</a> algorithm invoked on it (e.g. by a previous call to
    <code id="opening-the-input-stream:dom-document-open-5"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code>), then let <var>replace</var> be
    true.</p>

    <p>Otherwise, let <var>replace</var> be false.</p>

   </li><li>

    <p>If the <code id="opening-the-input-stream:document-13"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has an <a href="/breakup/specs/browser-dom/#active-parser" id="opening-the-input-stream:active-parser">active parser</a> whose <a href="#script-nesting-level" id="opening-the-input-stream:script-nesting-level">script nesting
    level</a> is greater than zero, then the method does nothing. Abort these steps and return
    the <code id="opening-the-input-stream:document-14"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object on which the method was invoked.</p>

    <p class="note">This basically causes <code id="opening-the-input-stream:dom-document-open-6"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> to
    be ignored when it's called in an inline script found during parsing, while still letting it
    have an effect when called from a non-parser task such as a timer callback or event handler.</p>

   </li><li>

    <p>Similarly, if the <code id="opening-the-input-stream:document-15"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#ignore-opens-during-unload-counter" id="opening-the-input-stream:ignore-opens-during-unload-counter">ignore-opens-during-unload counter</a> is
    greater than zero, then the method does nothing. Abort these steps and return the
    <code id="opening-the-input-stream:document-16"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object on which the method was invoked.</p>

    <p class="note">This basically causes <code id="opening-the-input-stream:dom-document-open-7"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> to
    be ignored when it's called from a <code id="opening-the-input-stream:event-beforeunload"><a href="/breakup/specs/html/#event-beforeunload">beforeunload</a></code> <code id="opening-the-input-stream:event-pagehide"><a href="/breakup/specs/html/#event-pagehide">pagehide</a></code>, or <code id="opening-the-input-stream:event-unload"><a href="/breakup/specs/html/#event-unload">unload</a></code> event
    handler while the <code id="opening-the-input-stream:document-17"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is being unloaded.</p>

   </li><li><p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="opening-the-input-stream:storage-mutex">storage mutex</a>.</p></li><li><p>Set the <code id="opening-the-input-stream:document-18"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <i id="opening-the-input-stream:concept-document-salvageable"><a href="#concept-document-salvageable">salvageable</a></i> state to false.</p></li><li><p><a href="#prompt-to-unload-a-document" id="opening-the-input-stream:prompt-to-unload-a-document">Prompt to unload</a> the
   <code id="opening-the-input-stream:document-19"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object. If the user <a href="#refused-to-allow-the-document-to-be-unloaded" id="opening-the-input-stream:refused-to-allow-the-document-to-be-unloaded">refused to allow the document to be
   unloaded</a>, then abort these steps and return the <code id="opening-the-input-stream:document-20"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object on which the
   method was invoked.</p></li><li><p><a href="#unload-a-document" id="opening-the-input-stream:unload-a-document-3">Unload</a> the <code id="opening-the-input-stream:document-21"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, with the
   <var>recycle</var> parameter set to true.</p></li><li><p><a href="#abort-a-document" id="opening-the-input-stream:abort-a-document">Abort</a> the <code id="opening-the-input-stream:document-22"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p></li><li><p>Unregister all event listeners registered on the <code id="opening-the-input-stream:document-23"><a href="/breakup/specs/browser-dom/#document">Document</a></code> node and its
   descendants.</p>

   </li><li><p>Remove any <a href="/breakup/specs/browser-dom/#concept-task" id="opening-the-input-stream:concept-task">tasks</a> associated with the
   <code id="opening-the-input-stream:document-24"><a href="/breakup/specs/browser-dom/#document">Document</a></code> in any <a href="/breakup/specs/browser-dom/#task-source" id="opening-the-input-stream:task-source">task source</a>.</p></li><li><p>Remove all child nodes of the document, without firing any mutation events.</p></li><li>

    <p>Replace the <code id="opening-the-input-stream:document-25"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s singleton objects with new instances of those objects.
    (This includes in particular the <code id="opening-the-input-stream:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>, <code id="opening-the-input-stream:location"><a href="/breakup/specs/browser-dom/#location">Location</a></code>,
    <code id="opening-the-input-stream:history-3"><a href="/breakup/specs/browser-dom/#history-3">History</a></code>, <code id="opening-the-input-stream:applicationcache"><a href="#applicationcache">ApplicationCache</a></code>, and <code id="opening-the-input-stream:navigator"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code>, objects, the
    various <code id="opening-the-input-stream:barprop"><a href="/breakup/specs/browser-dom/#barprop">BarProp</a></code> objects, the two <code id="opening-the-input-stream:storage-2"><a href="http://www.w3.org/TR/webstorage/#storage-2">Storage</a></code> objects, the various
    <code id="opening-the-input-stream:htmlcollection"><a href="/breakup/specs/core-algorithms/#htmlcollection">HTMLCollection</a></code> objects, and objects defined by other specifications, like
    <code id="opening-the-input-stream:selection"><a href="/breakup/specs/core-algorithms/#selection">Selection</a></code>. It also includes all the Web
    IDL prototypes in the JavaScript binding, including the <code id="opening-the-input-stream:document-26"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object's
    prototype.)</p>

    <p class="note">The new <code id="opening-the-input-stream:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object has a new <a href="/breakup/specs/browser-dom/#environment-settings-object" id="opening-the-input-stream:environment-settings-object">environment settings
    object</a>.</p>

   </li><li><p>Change the <a href="/breakup/specs/core-algorithms/#document's-character-encoding" id="opening-the-input-stream:document's-character-encoding">document's character encoding</a> to UTF-8.</p></li><li><p>If the <code id="opening-the-input-stream:document-27"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is <a href="#ready-for-post-load-tasks" id="opening-the-input-stream:ready-for-post-load-tasks">ready for post-load tasks</a>, then set the
   <code id="opening-the-input-stream:document-28"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object's <a href="/breakup/specs/browser-dom/#reload-override-flag" id="opening-the-input-stream:reload-override-flag">reload override flag</a> and set the
   <code id="opening-the-input-stream:document-29"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#reload-override-buffer" id="opening-the-input-stream:reload-override-buffer">reload override buffer</a> to the empty string.</p></li><li><p>Set the <code id="opening-the-input-stream:document-30"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <i id="opening-the-input-stream:concept-document-salvageable-2"><a href="#concept-document-salvageable">salvageable</a></i> state back to true.</p></li><li><p>Change <a id="opening-the-input-stream:the-document's-address" href="https://dom.spec.whatwg.org/#concept-document-url" data-x-internal="the-document's-address">the document's address</a> to the <a href="https://dom.spec.whatwg.org/#concept-document-url" id="opening-the-input-stream:the-document's-address-2" data-x-internal="the-document's-address">address</a> of the <a href="/breakup/specs/browser-dom/#responsible-document" id="opening-the-input-stream:responsible-document">responsible document</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="opening-the-input-stream:entry-settings-object">entry
   settings object</a>.</p></li><li><p>If the <code id="opening-the-input-stream:document-31"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="#iframe-load-in-progress" id="opening-the-input-stream:iframe-load-in-progress">iframe load in progress</a> flag is set, set the
   <code id="opening-the-input-stream:document-32"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="#mute-iframe-load" id="opening-the-input-stream:mute-iframe-load">mute iframe load</a> flag.</p></li><li><p>Create a new <a href="#html-parser" id="opening-the-input-stream:html-parser">HTML parser</a> and associate it with the document. This is a
   <dfn id="script-created-parser">script-created parser</dfn> (meaning that it can be closed by the <code id="opening-the-input-stream:dom-document-open-8"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> and <code id="opening-the-input-stream:dom-document-close"><a href="/breakup/specs/browser-dom/#dom-document-close">document.close()</a></code> methods, and that the tokenizer will wait for
   an explicit call to <code id="opening-the-input-stream:dom-document-close-2"><a href="/breakup/specs/browser-dom/#dom-document-close">document.close()</a></code> before emitting an
   end-of-file token). The encoding <a href="#concept-encoding-confidence" id="opening-the-input-stream:concept-encoding-confidence">confidence</a> is
   <i>irrelevant</i>.</p></li><li><p>Set the <a href="/breakup/specs/browser-dom/#current-document-readiness" id="opening-the-input-stream:current-document-readiness">current document readiness</a> of the document to "<code>loading</code>".</p></li><li>

    

    <p>If <var>type</var> is an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="opening-the-input-stream:ascii-case-insensitive-2">ASCII case-insensitive</a> match for the string
    "<code>replace</code>", then, for historical reasons, set it to the string "<code>text/html</code>".</p>

    <p>Otherwise:</p>

    <p>If the <var>type</var> string contains a U+003B SEMICOLON character (;), remove the
    first such character and all characters from it up to the end of the string.</p>

    <p><a href="/breakup/specs/core-algorithms/#strip-leading-and-trailing-whitespace" id="opening-the-input-stream:strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> from <var>type</var>.</p>

   </li><li>

    <p>If <var>type</var> is <em>not</em> now an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="opening-the-input-stream:ascii-case-insensitive-3">ASCII case-insensitive</a> match
    for the string "<code id="opening-the-input-stream:text/html-2"><a href="#text/html">text/html</a></code>", then act as if the tokenizer had emitted a start tag
    token with the tag name "pre" followed by a single U+000A LINE FEED (LF) character, then switch the
    <a href="#html-parser" id="opening-the-input-stream:html-parser-2">HTML parser</a>'s tokenizer to the <a href="#plaintext-state" id="opening-the-input-stream:plaintext-state">PLAINTEXT state</a>.</p>

    

   </li><li>

    <p>Remove all the entries in the <a href="/breakup/specs/browser-dom/#browsing-context" id="opening-the-input-stream:browsing-context-3">browsing context</a>'s <a href="/breakup/specs/browser-dom/#session-history" id="opening-the-input-stream:session-history-2">session history</a>
    after the <a href="/breakup/specs/browser-dom/#current-entry" id="opening-the-input-stream:current-entry">current entry</a>. If the <a href="/breakup/specs/browser-dom/#current-entry" id="opening-the-input-stream:current-entry-2">current entry</a> is the last entry in the
    session history, then no entries are removed.</p>

    <p class="note">This <a href="/breakup/specs/browser-dom/#history-notes">doesn't necessarily have to affect</a> the user
    agent's user interface.</p>

   </li><li><p>Remove any <a href="/breakup/specs/browser-dom/#concept-task" id="opening-the-input-stream:concept-task-2">tasks</a> queued by the <a href="/breakup/specs/browser-dom/#history-traversal-task-source" id="opening-the-input-stream:history-traversal-task-source">history traversal
   task source</a> that are associated with any <code id="opening-the-input-stream:document-33"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects in the
   <a href="/breakup/specs/browser-dom/#top-level-browsing-context" id="opening-the-input-stream:top-level-browsing-context">top-level browsing context</a>'s <a href="/breakup/specs/browser-dom/#document-family" id="opening-the-input-stream:document-family">document family</a>.</p></li><li>Remove any earlier entries that share the same <code id="opening-the-input-stream:document-34"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</li><li><p>If <var>replace</var> is false, then add a new entry, just before the last entry,
   and associate with the new entry the text that was parsed by the previous parser associated with
   the <code id="opening-the-input-stream:document-35"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, as well as the state of the document at the start of these
   steps. This allows the user to step backwards in the session history to see the page before it
   was blown away by the <code id="opening-the-input-stream:dom-document-open-9"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> call. This new entry
   does not have a <code id="opening-the-input-stream:document-36"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, so a new one will be created if the session history
   is traversed to that entry.</p></li><li><p>Finally, set the <a href="#insertion-point" id="opening-the-input-stream:insertion-point">insertion point</a> to point at just before the end of the
   <a href="#input-stream" id="opening-the-input-stream:input-stream">input stream</a> (which at this point will be empty).</p></li><li><p>Return the <code id="opening-the-input-stream:document-37"><a href="/breakup/specs/browser-dom/#document">Document</a></code> on which the method was invoked.</p></li></ol>

  <p class="note">The <code id="opening-the-input-stream:dom-document-open-10"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> method does not affect
  whether a <code id="opening-the-input-stream:document-38"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is <a href="#ready-for-post-load-tasks" id="opening-the-input-stream:ready-for-post-load-tasks-2">ready for post-load tasks</a> or <a href="#completely-loaded" id="opening-the-input-stream:completely-loaded">completely
  loaded</a>.</p>

  <p>When called with four arguments, the <code id="opening-the-input-stream:dom-document-open-11"><a href="/breakup/specs/browser-dom/#dom-document-open">open()</a></code> method on
  the <code id="opening-the-input-stream:document-39"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object must call the <code id="opening-the-input-stream:dom-open-2"><a href="/breakup/specs/browser-dom/#dom-open">open()</a></code> method on the
  <code id="opening-the-input-stream:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the <code id="opening-the-input-stream:document-40"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object, with the same arguments as the
  original call to the <code id="opening-the-input-stream:dom-document-open-12"><a href="/breakup/specs/browser-dom/#dom-document-open">open()</a></code> method, and return whatever
  that method returned. If the <code id="opening-the-input-stream:document-41"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object has no <code id="opening-the-input-stream:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, then
  the method must throw an <code id="opening-the-input-stream:invalidaccesserror"><a href="/breakup/specs/core-algorithms/#invalidaccesserror">InvalidAccessError</a></code> exception.</p></section>

  



  <section><h4 id="closing-the-input-stream">7.3.2 Closing the input stream</h4>

  <dl class="domintro"><dt><var>document</var> . <code id="closing-the-input-stream:dom-document-close"><a href="/breakup/specs/browser-dom/#dom-document-close">close</a></code>()</dt><dd>

    <p>Closes the input stream that was opened by the <code id="closing-the-input-stream:dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> method.</p>

    <p>Throws an <code id="closing-the-input-stream:invalidstateerror"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception if the
    <code id="closing-the-input-stream:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is an <a href="/breakup/specs/core-algorithms/#xml-documents" id="closing-the-input-stream:xml-documents">XML
    document</a>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-close"><code>close()</code></dfn> method must run the following
  steps:</p>

  <ol><li><p>If the <code id="closing-the-input-stream:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is not flagged as an <a href="/breakup/specs/core-algorithms/#html-documents" id="closing-the-input-stream:html-documents">HTML
   document</a>, throw an <code id="closing-the-input-stream:invalidstateerror-2"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these
   steps.</p></li><li><p>If there is no <a href="/breakup/specs/browser-dom/#script-created-parser" id="closing-the-input-stream:script-created-parser">script-created parser</a> associated with the document, then abort
   these steps.</p></li><li><p>Insert an <a href="#explicit-eof-character" id="closing-the-input-stream:explicit-eof-character">explicit "EOF" character</a> at the end of the parser's <a href="#input-stream" id="closing-the-input-stream:input-stream">input
   stream</a>.</p></li><li><p>If there is a <a href="#pending-parsing-blocking-script" id="closing-the-input-stream:pending-parsing-blocking-script">pending parsing-blocking script</a>, then abort these
   steps.</p></li><li><p>Run the tokenizer, processing resulting tokens as they are emitted, and stopping when the
   tokenizer reaches the <a href="#explicit-eof-character" id="closing-the-input-stream:explicit-eof-character-2">explicit "EOF" character</a> or <a href="/breakup/specs/browser-dom/#spin-the-event-loop" id="closing-the-input-stream:spin-the-event-loop">spins the event loop</a>.</p></li></ol></section>

  



  <section><h4 id="document.write()">7.3.3 <code id="document.write():dom-document-write"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code></h4>

  <dl class="domintro"><dt><var>document</var> . <code id="document.write():dom-document-write-2"><a href="/breakup/specs/browser-dom/#dom-document-write">write</a></code>(<var>text</var>...)</dt><dd>

    <p>In general, adds the given string(s) to the <code id="document.write():document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s input stream.</p>

    <p class="warning">This method has very idiosyncratic behaviour. In some cases, this method can
    affect the state of the <a href="#html-parser" id="document.write():html-parser">HTML parser</a> while the parser is running, resulting in a DOM
    that does not correspond to the source of the document (e.g. if the string written is the string
    "<code>&lt;plaintext&gt;</code>" or "<code>&lt;!--</code>"). In other cases,
    the call can clear the current page first, as if <code id="document.write():dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code> had been called. In yet more cases, the method
    is simply ignored, or throws an exception. To make matters worse, the exact behaviour of this
    method can in some cases be dependent on network latency, which can lead to failures that are very hard to debug. <strong>For all these reasons, use
    of this method is strongly discouraged.</strong></p>

    <p>This method throws an <code id="document.write():invalidstateerror"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception when invoked on <a href="/breakup/specs/core-algorithms/#xml-documents" id="document.write():xml-documents">XML
    documents</a>.</p>

   </dd></dl>

  

  <p><code id="document.write():document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> objects have an <dfn id="ignore-destructive-writes-counter">ignore-destructive-writes counter</dfn>, which is
  used in conjunction with the processing of <code id="document.write():the-script-element"><a href="#the-script-element">script</a></code> elements to prevent external
  scripts from being able to use <code id="document.write():dom-document-write-3"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> to blow
  away the document by implicitly calling <code id="document.write():dom-document-open-2"><a href="/breakup/specs/browser-dom/#dom-document-open">document.open()</a></code>.
  Initially, the counter must be set to zero.</p>

  <p>The <dfn id="dom-document-write"><code>document.write(...)</code></dfn> method must act as
  follows:</p>

  <ol><li>

    <p>If the method was invoked on an <a href="/breakup/specs/core-algorithms/#xml-documents" id="document.write():xml-documents-2">XML document</a>, throw an
    <code id="document.write():invalidstateerror-2"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p>

    

   </li><li><p>If the <code id="document.write():document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object is not an <a href="/breakup/specs/browser-dom/#active-document" id="document.write():active-document">active document</a>, then abort
   these steps.</p></li><li>

    <p>If the <a href="#insertion-point" id="document.write():insertion-point">insertion point</a> is undefined and either the <code id="document.write():document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s
    <a href="/breakup/specs/browser-dom/#ignore-opens-during-unload-counter" id="document.write():ignore-opens-during-unload-counter">ignore-opens-during-unload counter</a> is greater than zero or the
    <code id="document.write():document-5"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#ignore-destructive-writes-counter" id="document.write():ignore-destructive-writes-counter">ignore-destructive-writes counter</a> is greater than zero,
    abort these steps.</p>

   </li><li>

    <p>If the <a href="#insertion-point" id="document.write():insertion-point-2">insertion point</a> is undefined, call the <code id="document.write():dom-document-open-3"><a href="/breakup/specs/browser-dom/#dom-document-open">open()</a></code> method on the <code id="document.write():document-6"><a href="/breakup/specs/browser-dom/#document">document</a></code>
    object (with no arguments). If the user <a href="#refused-to-allow-the-document-to-be-unloaded" id="document.write():refused-to-allow-the-document-to-be-unloaded">refused to allow the document to be
    unloaded</a>, then abort these steps. Otherwise, the <a href="#insertion-point" id="document.write():insertion-point-3">insertion point</a> will point
    at just before the end of the (empty) <a href="#input-stream" id="document.write():input-stream">input stream</a>.</p>

   </li><li>

    <p>Insert the string consisting of the concatenation of all the arguments to the method into the
    <a href="#input-stream" id="document.write():input-stream-2">input stream</a> just before the <a href="#insertion-point" id="document.write():insertion-point-4">insertion point</a>.</p>

   </li><li>

    <p>If the <code id="document.write():document-7"><a href="/breakup/specs/browser-dom/#document">Document</a></code> object's <a href="/breakup/specs/browser-dom/#reload-override-flag" id="document.write():reload-override-flag">reload override flag</a> is set, then append
    the string consisting of the concatenation of all the arguments to the method to the
    <code id="document.write():document-8"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s <a href="/breakup/specs/browser-dom/#reload-override-buffer" id="document.write():reload-override-buffer">reload override buffer</a>.</p>

   </li><li>

    <p>If there is no <a href="#pending-parsing-blocking-script" id="document.write():pending-parsing-blocking-script">pending parsing-blocking script</a>, have the <a href="#html-parser" id="document.write():html-parser-2">HTML
    parser</a> process the characters that were inserted, one at a time, processing resulting
    tokens as they are emitted, and stopping when the tokenizer reaches the insertion point or when
    the processing of the tokenizer is aborted by the tree construction stage (this can happen if a
    <code id="document.write():the-script-element-2"><a href="#the-script-element">script</a></code> end tag token is emitted by the tokenizer).

    </p><p class="note">If the <code id="document.write():dom-document-write-4"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> method was
    called from script executing inline (i.e. executing because the parser parsed a set of
    <code id="document.write():the-script-element-3"><a href="#the-script-element">script</a></code> tags), then this is a <a href="#nestedParsing">reentrant invocation of the
    parser</a>.</p>

   </li><li>

    <p>Finally, return from the method.</p>

   </li></ol></section>

  


  <section><h4 id="document.writeln()">7.3.4 <code id="document.writeln():dom-document-writeln"><a href="/breakup/specs/browser-dom/#dom-document-writeln">document.writeln()</a></code></h4>

  <dl class="domintro"><dt><var>document</var> . <code id="document.writeln():dom-document-writeln-2"><a href="/breakup/specs/browser-dom/#dom-document-writeln">writeln</a></code>(<var>text</var>...)</dt><dd>

    <p>Adds the given string(s) to the <code id="document.writeln():document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>'s input stream, followed by a newline
    character. If necessary, calls the <code id="document.writeln():dom-document-open"><a href="/breakup/specs/browser-dom/#dom-document-open">open()</a></code> method
    implicitly first.</p>

    <p>This method throws an <code id="document.writeln():invalidstateerror"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception when invoked on <a href="/breakup/specs/core-algorithms/#xml-documents" id="document.writeln():xml-documents">XML
    documents</a>.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-document-writeln"><code>document.writeln(...)</code></dfn> method, when
  invoked, must act as if the <code id="document.writeln():dom-document-write"><a href="/breakup/specs/browser-dom/#dom-document-write">document.write()</a></code> method had
  been invoked with the same argument(s), plus an extra argument consisting of a string containing a
  single line feed character (U+000A).</p></section></section><section><h3 id="timers">7.4 Timers</h3>

  <p>The <code id="timers:dom-windowtimers-settimeout"><a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout">setTimeout()</a></code>
  and <code id="timers:dom-windowtimers-setinterval"><a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval">setInterval()</a></code>
  methods allow authors to schedule timer-based callbacks.</p>

  <pre class="idl">[NoInterfaceObject, Exposed=(Window,Worker)]
interface <dfn id="windowtimers">WindowTimers</dfn> {
  long <a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout" id="timers:dom-windowtimers-settimeout-2">setTimeout</a>(<a href="/breakup/specs/core-algorithms/#idl-function" id="timers:idl-function">Function</a> handler, optional long timeout = 0, any... arguments);
  long <a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout" id="timers:dom-windowtimers-settimeout-3">setTimeout</a>(DOMString handler, optional long timeout = 0, any... arguments);
  void <a href="/breakup/specs/browser-dom/#dom-windowtimers-cleartimeout" id="timers:dom-windowtimers-cleartimeout">clearTimeout</a>(optional long handle = 0);
  long <a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval" id="timers:dom-windowtimers-setinterval-2">setInterval</a>(<a href="/breakup/specs/core-algorithms/#idl-function" id="timers:idl-function-2">Function</a> handler, optional long timeout = 0, any... arguments);
  long <a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval" id="timers:dom-windowtimers-setinterval-3">setInterval</a>(DOMString handler, optional long timeout = 0, any... arguments);
  void <a href="/breakup/specs/browser-dom/#dom-windowtimers-clearinterval" id="timers:dom-windowtimers-clearinterval">clearInterval</a>(optional long handle = 0);
};
<a href="/breakup/specs/browser-dom/#window" id="timers:window">Window</a> implements <a href="/breakup/specs/browser-dom/#windowtimers" id="timers:windowtimers">WindowTimers</a>;</pre>

  

  <dl class="domintro"><dt><var>handle</var> = <var>window</var> . <code id="timers:dom-windowtimers-settimeout-4"><a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout">setTimeout</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )</dt><dd>

    <p>Schedules a timeout to run <var>handler</var> after <var>timeout</var>
    milliseconds. Any <var>arguments</var> are passed straight through to the <var>handler</var>.</p>

   </dd><dt><var>handle</var> = <var>window</var> . <code id="timers:dom-windowtimers-settimeout-5"><a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout">setTimeout</a></code>( <var>code</var> [, <var>timeout</var> ] )</dt><dd>

    <p>Schedules a timeout to compile and run <var>code</var> after <var>timeout</var> milliseconds.</p>

   </dd><dt><var>window</var> . <code id="timers:dom-windowtimers-cleartimeout-2"><a href="/breakup/specs/browser-dom/#dom-windowtimers-cleartimeout">clearTimeout</a></code>( <var>handle</var> )</dt><dd>

    <p>Cancels the timeout set with <code id="timers:dom-windowtimers-settimeout-6"><a href="/breakup/specs/browser-dom/#dom-windowtimers-settimeout">setTimeout()</a></code>
    identified by <var>handle</var>.</p>

   </dd><dt><var>handle</var> = <var>window</var> . <code id="timers:dom-windowtimers-setinterval-4"><a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval">setInterval</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )</dt><dd>

    <p>Schedules a timeout to run <var>handler</var> every <var>timeout</var>
    milliseconds. Any <var>arguments</var> are passed straight through to the <var>handler</var>.</p>

   </dd><dt><var>handle</var> = <var>window</var> . <code id="timers:dom-windowtimers-setinterval-5"><a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval">setInterval</a></code>( <var>code</var> [, <var>timeout</var> ] )</dt><dd>

    <p>Schedules a timeout to compile and run <var>code</var> every <var>timeout</var> milliseconds.</p>

   </dd><dt><var>window</var> . <code id="timers:dom-windowtimers-clearinterval-2"><a href="/breakup/specs/browser-dom/#dom-windowtimers-clearinterval">clearInterval</a></code>( <var>handle</var> )</dt><dd>

    <p>Cancels the timeout set with <code id="timers:dom-windowtimers-setinterval-6"><a href="/breakup/specs/browser-dom/#dom-windowtimers-setinterval">setInterval()</a></code> identified by <var>handle</var>.</p>

   </dd></dl>

  <p class="note">Timers can be nested; after five such nested timers, however, the interval is
  forced to be at least four milliseconds.</p>

  <p class="note">This API does not guarantee that timers will run exactly on schedule. Delays due
  to CPU load, other tasks, etc, are to be expected.</p>

  

  <p class="note">The <code id="timers:windowtimers-2"><a href="/breakup/specs/browser-dom/#windowtimers">WindowTimers</a></code> interface adds to the <code id="timers:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> interface
  and the <code id="timers:workerglobalscope"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> interface (part of Web workers).</p>

  <p>Each object that implements the <code id="timers:windowtimers-3"><a href="/breakup/specs/browser-dom/#windowtimers">WindowTimers</a></code> interface has a <dfn id="list-of-active-timers">list of active
  timers</dfn>. Each entry in this lists is identified by a number, which must be unique within the
  list for the lifetime of the object that implements the <code id="timers:windowtimers-4"><a href="/breakup/specs/browser-dom/#windowtimers">WindowTimers</a></code> interface.</p>

  <hr>

  <p>The <dfn id="dom-windowtimers-settimeout"><code>setTimeout()</code></dfn> method must return
  the value returned by the <a href="/breakup/specs/browser-dom/#timer-initialisation-steps" id="timers:timer-initialisation-steps">timer initialisation steps</a>, passing them the method's
  arguments, the object on which the method for which the algorithm is running is implemented (a
  <code id="timers:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> or <code id="timers:workerglobalscope-2"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object) as the <var>method
  context</var>, and the <var>repeat</var> flag set to false.</p>

  <p>The <dfn id="dom-windowtimers-setinterval"><code>setInterval()</code></dfn> method must
  return the value returned by the <a href="/breakup/specs/browser-dom/#timer-initialisation-steps" id="timers:timer-initialisation-steps-2">timer initialisation steps</a>, passing them the
  method's arguments, the object on which the method for which the algorithm is running is
  implemented (a <code id="timers:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> or <code id="timers:workerglobalscope-3"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var> flag set to true.</p>

  <p>The <dfn id="dom-windowtimers-cleartimeout"><code>clearTimeout()</code></dfn> and <dfn id="dom-windowtimers-clearinterval"><code>clearInterval()</code></dfn> methods must clear the
  entry identified as <var>handle</var> from the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers">list of active timers</a> of the
  <code id="timers:windowtimers-5"><a href="/breakup/specs/browser-dom/#windowtimers">WindowTimers</a></code> object on which the method was invoked, if any, where <var>handle</var> is the argument passed to the method. (If <var>handle</var> does
  not identify an entry in the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers-2">list of active timers</a> of the <code id="timers:windowtimers-6"><a href="/breakup/specs/browser-dom/#windowtimers">WindowTimers</a></code>
  object on which the method was invoked, the method does nothing.)</p>

  <hr>

  <p>The <dfn id="timer-initialisation-steps">timer initialisation steps</dfn>, which are invoked with some method arguments, a <var>method context</var>, a <var>repeat</var> flag which can be true or false, and
  optionally (and only if the <var>repeat</var> flag is true) a <var>previous
  handle</var>, are as follows:</p>

  <ol><li><p>Let <var>method context proxy</var> be <var>method context</var> if that
   is a <code id="timers:workerglobalscope-4"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object, or else the <code id="timers:windowproxy"><a href="/breakup/specs/browser-dom/#windowproxy">WindowProxy</a></code> that corresponds
   to <var>method context</var>.</p></li><li><p>If <var>previous handle</var> was provided, let <var>handle</var> be
   <var>previous handle</var>; otherwise, let <var>handle</var> be a
   user-agent-defined integer that is greater than zero that will identify the timeout to be set by
   this call in the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers-3">list of active timers</a>.</p></li><li><p>If <var>previous handle</var> was not provided, add an entry to the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers-4">list of
   active timers</a> for <var>handle</var>.</p></li><li>

    <p>Let <var>task</var> be a <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task">task</a> that runs the
    following substeps:</p>

    <ol><li><p>If the entry for <var>handle</var> in the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers-5">list of active timers</a>
     has been cleared, then abort this <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task-2">task</a>'s substeps.</p></li><li>

      <p>Run the appropriate set of steps from the following list:</p>

      <dl class="switch"><dt>If the first method argument is a <code id="timers:idl-function-3"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code></dt><dd>

        <p><a href="http://heycam.github.io/webidl/#es-invoking-callback-functions" id="timers:es-invoking-callback-functions" data-x-internal="es-invoking-callback-functions">Invoke</a> the <code id="timers:idl-function-4"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code>. Use the third and subsequent method
        arguments (if any) as the arguments for invoking the <code id="timers:idl-function-5"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code>. Use <var>method context proxy</var> as the
        <var>thisArg</var> for invoking the <code id="timers:idl-function-6"><a href="/breakup/specs/core-algorithms/#idl-function">Function</a></code>. <a href="#refsECMA262">[ECMA262]</a></p>

       </dd><dt>Otherwise</dt><dd>

        <ol><li><p>Let <var>script source</var> be the first method argument.</p></li><li><p>Let <var>script language</var> be JavaScript.</p></li><li><p>Let <var>settings object</var> be <var>method context</var>'s <a href="/breakup/specs/browser-dom/#environment-settings-object" id="timers:environment-settings-object">environment settings
         object</a>.</p></li><li><p><a href="/breakup/specs/browser-dom/#create-a-script" id="timers:create-a-script">Create a script</a> using <var>script source</var> as the script source,
         the <a href="/breakup/specs/core-algorithms/#url" id="timers:url">URL</a> where <var>script source</var> can be found, <var>scripting
         language</var> as the scripting language, and <var>settings object</var> as the
         <a href="/breakup/specs/browser-dom/#environment-settings-object" id="timers:environment-settings-object-2">environment settings object</a>.</p></li></ol>

       </dd></dl>

     </li><li><p>If the <var>repeat</var> flag is true, then call <a href="/breakup/specs/browser-dom/#timer-initialisation-steps" id="timers:timer-initialisation-steps-3">timer initialisation
     steps</a> again, passing them the same method arguments, the same <var>method
     context</var>, with the <var>repeat</var> flag still set to true, and with the <var>previous handle</var> set to <var>handler</var>.</p></li></ol>

   </li><li><p>Let <var>timeout</var> be the second method argument.</p></li><li><p>If the currently running <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task-3">task</a> is a task that was created
   by this algorithm, then let <var>nesting level</var> be the <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task-4">task</a>'s <a href="/breakup/specs/browser-dom/#timer-nesting-level" id="timers:timer-nesting-level">timer nesting level</a>. Otherwise, let <var>nesting level</var> be zero.</p></li><li><p>If <var>nesting level</var> is greater than 5, and <var>timeout</var> is
   less than 4, then increase <var>timeout</var> to 4.</p></li><li><p>Increment <var>nesting level</var> by one.</p></li><li><p>Let <var>task</var>'s <dfn id="timer-nesting-level">timer nesting level</dfn> be <var>nesting
   level</var>.</p></li><li><p>Return <var>handle</var>, and then continue running this algorithm
   <a href="/breakup/specs/core-algorithms/#in-parallel" id="timers:in-parallel">in parallel</a>.</p></li><li>

    <p>If <var>method context</var> is a <code id="timers:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object, wait until the
    <code id="timers:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> associated with <var>method context</var> has been <a href="/breakup/specs/browser-dom/#fully-active" id="timers:fully-active">fully
    active</a> for a further <var>timeout</var> milliseconds (not necessarily
    consecutively).</p>

    <p>Otherwise, <var>method context</var> is a <code id="timers:workerglobalscope-5"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object;
    wait until <var>timeout</var> milliseconds have passed with the worker not suspended
    (not necessarily consecutively).</p>

   </li><li>

    <p>Wait until any invocations of this algorithm that had the same <var>method
    context</var>, that started before this one, and whose <var>timeout</var> is equal to
    or less than this one's, have completed.</p>

    <p class="note">Argument conversion as defined by Web IDL (for example, invoking <code>toString()</code> methods on objects passed as the first argument) happens in the
    algorithms defined in Web IDL, before this algorithm is invoked.</p>

    <div class="example">

     <p>So for example, the following rather silly code will result in the log containing "<code>ONE&nbsp;TWO&nbsp;</code>":</p>

     <pre>var log = '';
function logger(s) { log += s + ' '; }

setTimeout({ toString: function () {
  setTimeout("logger('ONE')", 100);
  return "logger('TWO')";
} }, 100);</pre>

    </div>

   </li><li>

    <p>Optionally, wait a further user-agent defined length of time.</p>

    <p class="note">This is intended to allow user agents to pad timeouts as needed to optimise the
    power usage of the device. For example, some processors have a low-power mode where the
    granularity of timers is reduced; on such platforms, user agents can slow timers down to fit
    this schedule instead of requiring the processor to use the more accurate mode with its
    associated higher power usage.</p>

   </li><li>

    <p><a href="/breakup/specs/browser-dom/#queue-a-task" id="timers:queue-a-task">Queue</a> the <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task-5">task</a> <var>task</var>.</p>

    <p class="note">Once the task has been processed, if the <var>repeat</var> flag is
    false, it is safe to remove the entry for <var>handle</var> from the <a href="/breakup/specs/browser-dom/#list-of-active-timers" id="timers:list-of-active-timers-6">list of
    active timers</a> (there is no way for the entry's existence to be detected past this point,
    so it does not technically matter one way or the other).</p>

   </li></ol>

  <p>The <a href="/breakup/specs/browser-dom/#task-source" id="timers:task-source">task source</a> for these <a href="/breakup/specs/browser-dom/#concept-task" id="timers:concept-task-6">tasks</a> is the
  <dfn id="timer-task-source">timer task source</dfn>.</p>

  

  <div class="example">

   <p>To run tasks of several milliseconds back to back without any delay, while still yielding back
   to the browser to avoid starving the user interface (and to avoid the browser killing the script
   for hogging the CPU), simply queue the next timer before performing work:</p>

   <pre>function doExpensiveWork() {
  var done = false;
  // ...
  // this part of the function takes up to five milliseconds
  // set done to true if we're done
  // ...
  return done;
}

function rescheduleWork() {
  var handle = setTimeout(rescheduleWork, 0); // preschedule next iteration
  if (doExpensiveWork())
    clearTimeout(handle); // clear the timeout if we don't need it
}

function scheduleWork() {
  setTimeout(rescheduleWork, 0);
}

scheduleWork(); // queues a task to do lots of work</pre>

  </div></section><section><h3 id="user-prompts">7.5 User prompts</h3>

  

  <section><h4 id="simple-dialogs">7.5.1 Simple dialogs</h4>

  <dl class="domintro"><dt><var>window</var> . <code id="simple-dialogs:dom-alert"><a href="/breakup/specs/browser-dom/#dom-alert">alert</a></code>(<var>message</var>)</dt><dd>

    <p>Displays a modal alert with the given message, and waits for the user to dismiss it.</p>

    <p>A call to the <code id="simple-dialogs:dom-navigator-yieldforstorageupdates"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code> method is
    implied when this method is invoked.</p>

   </dd><dt><var>result</var> = <var>window</var> . <code id="simple-dialogs:dom-confirm"><a href="/breakup/specs/browser-dom/#dom-confirm">confirm</a></code>(<var>message</var>)</dt><dd>

    <p>Displays a modal OK/Cancel prompt with the given message, waits for the user to dismiss it,
    and returns true if the user clicks OK and false if the user clicks Cancel.</p>

    <p>A call to the <code id="simple-dialogs:dom-navigator-yieldforstorageupdates-2"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code> method is
    implied when this method is invoked.</p>

   </dd><dt><var>result</var> = <var>window</var> . <code id="simple-dialogs:dom-prompt"><a href="/breakup/specs/browser-dom/#dom-prompt">prompt</a></code>(<var>message</var> [, <var>default</var>] )</dt><dd>

    <p>Displays a modal text field prompt with the given message, waits for the user to dismiss it,
    and returns the value that the user entered. If the user cancels the prompt, then returns null
    instead. If the second argument is present, then the given value is used as a default.</p>

    <p>A call to the <code id="simple-dialogs:dom-navigator-yieldforstorageupdates-3"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code> method is
    implied when this method is invoked.</p>

   </dd></dl>

  <p class="note">Logic that depends on <a href="/breakup/specs/browser-dom/#concept-task" id="simple-dialogs:concept-task">tasks</a> or <a href="/breakup/specs/browser-dom/#microtask" id="simple-dialogs:microtask">microtasks</a>, such as <a href="#media-element" id="simple-dialogs:media-element">media elements</a>
  loading their <a href="#media-data" id="simple-dialogs:media-data">media data</a>, are stalled when these methods are invoked.</p>

  

  <p>The <dfn id="dom-alert"><code>alert(<var>message</var>)</code></dfn> method, when
  invoked, must run the following steps:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#event-loop" id="simple-dialogs:event-loop">event loop</a>'s <a href="#termination-nesting-level" id="simple-dialogs:termination-nesting-level">termination nesting level</a> is non-zero,
   optionally abort these steps.</p></li><li><p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="simple-dialogs:storage-mutex">storage mutex</a>.</p></li><li><p>Optionally, abort these steps. (For example, the user agent might give the user the option
   to ignore all alerts, and would thus abort at this step whenever the method was
   invoked.)</p></li><li><p>If the method was invoked with no arguments, then let <var>message</var> be the
   empty string; otherwise, let <var>message</var> be the method's first
   argument.</p></li><li><p>Show the given <var>message</var> to the user.</p></li><li><p>Optionally, <a href="/breakup/specs/browser-dom/#pause" id="simple-dialogs:pause">pause</a> while waiting for the user to acknowledge the
   message.</p></li></ol>

  <p>The <dfn id="dom-confirm"><code>confirm(<var>message</var>)</code></dfn> method,
  when invoked, must run the following steps:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#event-loop" id="simple-dialogs:event-loop-2">event loop</a>'s <a href="#termination-nesting-level" id="simple-dialogs:termination-nesting-level-2">termination nesting level</a> is non-zero,
   optionally abort these steps, returning false.</p></li><li><p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="simple-dialogs:storage-mutex-2">storage mutex</a>.</p></li><li><p>Optionally, return false and abort these steps. (For example, the user agent might give
   the user the option to ignore all prompts, and would thus abort at this step whenever the method
   was invoked.)</p></li><li><p>Show the given <var>message</var> to the user, and ask the user to respond with a
   positive or negative response.</p></li><li><p><a href="/breakup/specs/browser-dom/#pause" id="simple-dialogs:pause-2">Pause</a> until the user responds either positively or negatively.</p></li><li><p>If the user responded positively, return true; otherwise, the user responded negatively:
   return false.</p></li></ol>

  <p>The <dfn id="dom-prompt"><code>prompt(<var>message</var>, <var>default</var>)</code></dfn> method, when invoked, must run the following steps:</p>

  <ol><li><p>If the <a href="/breakup/specs/browser-dom/#event-loop" id="simple-dialogs:event-loop-3">event loop</a>'s <a href="#termination-nesting-level" id="simple-dialogs:termination-nesting-level-3">termination nesting level</a> is non-zero,
   optionally abort these steps, returning null.</p></li><li><p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="simple-dialogs:storage-mutex-3">storage mutex</a>.</p></li><li><p>Optionally, return null and abort these steps. (For example, the user agent might give the
   user the option to ignore all prompts, and would thus abort at this step whenever the method was
   invoked.)</p></li><li><p>Show the given <var>message</var> to the user, and ask the user to either respond
   with a string value or abort. The response must be defaulted to the value given by
   <var>default</var>.</p></li><li><p><a href="/breakup/specs/browser-dom/#pause" id="simple-dialogs:pause-3">Pause</a> while waiting for the user's response.</p></li><li><p>If the user aborts, then return null; otherwise, return the string that the user responded
   with.</p></li></ol></section>

  


  <section><h4 id="printing">7.5.2 Printing</h4>

  <dl class="domintro"><dt><var>window</var> . <code id="printing:dom-print"><a href="/breakup/specs/browser-dom/#dom-print">print</a></code>()</dt><dd>

    <p>Prompts the user to print the page.</p>

    <p>A call to the <code id="printing:dom-navigator-yieldforstorageupdates"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code> method is
    implied when this method is invoked.</p>

   </dd></dl>

  

  <p>When the <dfn id="dom-print"><code>print()</code></dfn> method is invoked, if the
  <code id="printing:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> is <a href="#ready-for-post-load-tasks" id="printing:ready-for-post-load-tasks">ready for post-load tasks</a>, then the user agent must
  run the <a href="/breakup/specs/browser-dom/#printing-steps" id="printing:printing-steps">printing steps</a> <a href="/breakup/specs/core-algorithms/#in-parallel" id="printing:in-parallel">in parallel</a>. Otherwise, the user agent must only set the
  <dfn id="print-when-loaded">print when loaded</dfn> flag on the <code id="printing:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>.</p>



  <p>User agents should also run the <a href="/breakup/specs/browser-dom/#printing-steps" id="printing:printing-steps-2">printing steps</a> whenever the user asks for the
  opportunity to <a href="#obtain-a-physical-form" id="printing:obtain-a-physical-form">obtain a physical form</a> (e.g. printed copy), or the representation of a
  physical form (e.g. PDF copy), of a document.</p>

  <p>The <dfn id="printing-steps">printing steps</dfn> are as follows:</p>

  <ol><li>

    <p>The user agent may display a message to the user or abort these steps (or both).</p>

    <p class="example">For instance, a kiosk browser could silently ignore any invocations of the
    <code id="printing:dom-print-2"><a href="/breakup/specs/browser-dom/#dom-print">print()</a></code> method.</p>

    <p class="example">For instance, a browser on a mobile device could detect that there are no
    printers in the vicinity and display a message saying so before continuing to offer a "save to
    PDF" option.</p>

   </li><li>

    <p>The user agent must <a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="printing:fire-a-simple-event">fire a simple event</a> named <code id="printing:event-beforeprint"><a href="/breakup/specs/html/#event-beforeprint">beforeprint</a></code> at the <code id="printing:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the
    <code id="printing:document-3"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that is being printed, as well as any <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="printing:nested-browsing-context">nested browsing contexts</a> in it.</p>

    <p class="example">The <code id="printing:event-beforeprint-2"><a href="/breakup/specs/html/#event-beforeprint">beforeprint</a></code> event can be used to
    annotate the printed copy, for instance adding the time at which the document was printed.</p>

   </li><li>

    <p>The user agent must release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="printing:storage-mutex">storage mutex</a>.</p>

   </li><li>

    <p>The user agent should offer the user the opportunity to <a href="#obtain-a-physical-form" id="printing:obtain-a-physical-form-2">obtain a physical form</a>
    (or the representation of a physical form) of the document. The user agent may wait for the user
    to either accept or decline before returning; if so, the user agent must <a href="/breakup/specs/browser-dom/#pause" id="printing:pause">pause</a>
    while the method is waiting. Even if the user agent doesn't wait at this point, the user agent
    must use the state of the relevant documents as they are at this point in the algorithm if and
    when it eventually creates the alternate form.</p>

   </li><li>

    <p>The user agent must <a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="printing:fire-a-simple-event-2">fire a simple event</a> named <code id="printing:event-afterprint"><a href="/breakup/specs/html/#event-afterprint">afterprint</a></code> at the <code id="printing:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object of the
    <code id="printing:document-4"><a href="/breakup/specs/browser-dom/#document">Document</a></code> that is being printed, as well as any <a href="/breakup/specs/browser-dom/#nested-browsing-context" id="printing:nested-browsing-context-2">nested browsing contexts</a> in it.</p>

    <p class="example">The <code id="printing:event-afterprint-2"><a href="/breakup/specs/html/#event-afterprint">afterprint</a></code> event can be used to
    revert annotations added in the earlier event, as well as showing post-printing UI. For
    instance, if a page is walking the user through the steps of applying for a home loan, the
    script could automatically advance to the next step after having printed a form or other.</p>

   </li></ol></section>

  



  <section><h4 id="dialogs-implemented-using-separate-documents">7.5.3 Dialogs implemented using separate documents with <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code></h4>

  <p class="critical">This feature is in the process of being removed from the Web platform. (This
  is a long process that takes many years.) Using the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-2"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> API at this time is highly discouraged.</p>



  

  <p>The <dfn id="dom-showmodaldialog"><code>showModalDialog(<var>url</var>, <var>argument</var>)</code></dfn> method, when invoked,
  must cause the user agent to run the following steps:</p>

  <ol><li>

    <p><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="dialogs-implemented-using-separate-documents:resolve-a-url">Resolve</a> <var>url</var> relative to the
    <a href="/breakup/specs/browser-dom/#api-base-url" id="dialogs-implemented-using-separate-documents:api-base-url">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="dialogs-implemented-using-separate-documents:entry-settings-object">entry settings object</a>.</p>

    <p>If this fails, then throw a <code id="dialogs-implemented-using-separate-documents:syntaxerror"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception and abort these steps.</p>

   </li><li><p>If the <a href="/breakup/specs/browser-dom/#event-loop" id="dialogs-implemented-using-separate-documents:event-loop">event loop</a>'s <a href="#termination-nesting-level" id="dialogs-implemented-using-separate-documents:termination-nesting-level">termination nesting level</a> is non-zero,
   optionally abort these steps, returning the empty string.</p></li><li>

    <p>Release the <a href="/breakup/specs/browser-dom/#storage-mutex" id="dialogs-implemented-using-separate-documents:storage-mutex">storage mutex</a>.</p>

   </li><li>

    <p>If the user agent is configured such that this invocation of <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-3"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> is somehow disabled, then return the empty
    string and abort these steps.</p>

    <p class="note">User agents are expected to disable this method in certain cases to avoid user
    annoyance (e.g. as part of their popup blocker feature). For instance, a user agent could
    require that a site be white-listed before enabling this method, or the user agent could be
    configured to only allow one modal dialog at a time.</p>

   </li><li>

    <p>If the <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="dialogs-implemented-using-separate-documents:active-sandboxing-flag-set">active sandboxing flag set</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document">active document</a> of the
    <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="dialogs-implemented-using-separate-documents:responsible-browsing-context">responsible browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="dialogs-implemented-using-separate-documents:incumbent-settings-object">incumbent settings
    object</a> has its <a href="/breakup/specs/browser-dom/#sandboxed-auxiliary-navigation-browsing-context-flag" id="dialogs-implemented-using-separate-documents:sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</a> set,
    then return the empty string and abort these steps.</p>

   </li><li>

    <p>Let <var>incumbent origin</var> be the <a href="/breakup/specs/browser-dom/#effective-script-origin" id="dialogs-implemented-using-separate-documents:effective-script-origin">effective script origin</a>
    specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="dialogs-implemented-using-separate-documents:incumbent-settings-object-2">incumbent settings object</a> at the time the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-4"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method was called.</p>

   </li><li>

    <p>Let <var>the list of background browsing contexts</var> be a list of all the
    browsing contexts that:</p>

    <ul><li>are part of the same <a href="/breakup/specs/browser-dom/#unit-of-related-browsing-contexts" id="dialogs-implemented-using-separate-documents:unit-of-related-browsing-contexts">unit of related browsing contexts</a> as the browsing context
     of the <code id="dialogs-implemented-using-separate-documents:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object on which the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-5"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method was called, and that</li><li>have an <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document-2">active document</a> whose <a href="/breakup/specs/browser-dom/#origin-2" id="dialogs-implemented-using-separate-documents:origin-2">origin</a> is the <a href="/breakup/specs/browser-dom/#same-origin" id="dialogs-implemented-using-separate-documents:same-origin">same</a> as <var>incumbent origin</var>,</li></ul>

    <p>...as well as any browsing contexts that are nested inside any of the browsing contexts
    matching those conditions.</p>

   </li><li>

    <p>Disable the user interface for all the browsing contexts in <var>the list of
    background browsing contexts</var>. This should prevent the user from navigating those browsing
    contexts, causing events to be sent to those browsing context, or editing any content in those
    browsing contexts. However, it does not prevent those browsing contexts from receiving events
    from sources other than the user, from running scripts, from running animations, and so
    forth.</p>

   </li><li>

    <p><a href="/breakup/specs/browser-dom/#creating-a-new-browsing-context" id="dialogs-implemented-using-separate-documents:creating-a-new-browsing-context">Create</a> a new <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="dialogs-implemented-using-separate-documents:auxiliary-browsing-context">auxiliary browsing context</a>, with the <a href="/breakup/specs/browser-dom/#opener-browsing-context" id="dialogs-implemented-using-separate-documents:opener-browsing-context">opener browsing
    context</a> being the browsing context of the <code id="dialogs-implemented-using-separate-documents:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code> object on which the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-6"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method was called. The new auxiliary
    browsing context has no name.</p>

    <p class="note">This <a href="/breakup/specs/browser-dom/#browsing-context" id="dialogs-implemented-using-separate-documents:browsing-context">browsing context</a>'s <code id="dialogs-implemented-using-separate-documents:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s' <code id="dialogs-implemented-using-separate-documents:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
    objects all implement the <code id="dialogs-implemented-using-separate-documents:windowmodal"><a href="/breakup/specs/browser-dom/#windowmodal">WindowModal</a></code> interface.</p>

   </li><li>

    <p>Set all the flags in the new browsing context's <a href="/breakup/specs/browser-dom/#popup-sandboxing-flag-set" id="dialogs-implemented-using-separate-documents:popup-sandboxing-flag-set">popup sandboxing flag set</a> that
    are set in the <a href="/breakup/specs/browser-dom/#active-sandboxing-flag-set" id="dialogs-implemented-using-separate-documents:active-sandboxing-flag-set-2">active sandboxing flag set</a> of the <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document-3">active document</a> of
    the <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="dialogs-implemented-using-separate-documents:responsible-browsing-context-2">responsible browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="dialogs-implemented-using-separate-documents:incumbent-settings-object-3">incumbent settings
    object</a>. The <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="dialogs-implemented-using-separate-documents:responsible-browsing-context-3">responsible browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="dialogs-implemented-using-separate-documents:incumbent-settings-object-4">incumbent
    settings object</a> must be set as the new browsing context's <a href="/breakup/specs/browser-dom/#one-permitted-sandboxed-navigator" id="dialogs-implemented-using-separate-documents:one-permitted-sandboxed-navigator">one permitted sandboxed
    navigator</a>.</p>

   </li><li>

    <p>Let the <a href="/breakup/specs/browser-dom/#dialog-arguments" id="dialogs-implemented-using-separate-documents:dialog-arguments">dialog arguments</a> of the new browsing context be set to the value of <var>argument</var>, or the <i>undefined</i> value if the argument was omitted.</p>

   </li><li>

    <p>Let the <a href="/breakup/specs/browser-dom/#dialog-arguments'-origin" id="dialogs-implemented-using-separate-documents:dialog-arguments'-origin">dialog arguments' origin</a> be <var>incumbent origin</var>.</p>

   </li><li>

    <p>Let the <a href="/breakup/specs/browser-dom/#return-value" id="dialogs-implemented-using-separate-documents:return-value">return value</a> of the new browsing context be the <i>undefined</i> value.</p>

   </li><li>

    <p>Let the <a href="/breakup/specs/browser-dom/#return-value-origin" id="dialogs-implemented-using-separate-documents:return-value-origin">return value origin</a> be <var>incumbent origin</var>.</p>

   </li><li>

    <p><a href="#navigate" id="dialogs-implemented-using-separate-documents:navigate">Navigate</a> the new <a href="/breakup/specs/browser-dom/#browsing-context" id="dialogs-implemented-using-separate-documents:browsing-context-2">browsing context</a> to
    the <a href="/breakup/specs/core-algorithms/#absolute-url" id="dialogs-implemented-using-separate-documents:absolute-url">absolute URL</a> that resulted from <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="dialogs-implemented-using-separate-documents:resolve-a-url-2">resolving</a>
    <var>url</var> earlier, with <a href="#replacement-enabled" id="dialogs-implemented-using-separate-documents:replacement-enabled">replacement enabled</a>, and with the
    <a href="/breakup/specs/browser-dom/#responsible-browsing-context" id="dialogs-implemented-using-separate-documents:responsible-browsing-context-4">responsible browsing context</a> specified by the <a href="/breakup/specs/browser-dom/#incumbent-settings-object" id="dialogs-implemented-using-separate-documents:incumbent-settings-object-5">incumbent settings
    object</a> as the <a href="#source-browsing-context" id="dialogs-implemented-using-separate-documents:source-browsing-context">source browsing context</a>.</p>

    

   </li><li>

    <p><a href="/breakup/specs/browser-dom/#spin-the-event-loop" id="dialogs-implemented-using-separate-documents:spin-the-event-loop">Spin the event loop</a> until the new <a href="/breakup/specs/browser-dom/#browsing-context" id="dialogs-implemented-using-separate-documents:browsing-context-3">browsing context</a> is <a href="/breakup/specs/browser-dom/#close-a-browsing-context" id="dialogs-implemented-using-separate-documents:close-a-browsing-context">closed</a>. The user agent must allow the user to indicate
    that the <a href="/breakup/specs/browser-dom/#browsing-context" id="dialogs-implemented-using-separate-documents:browsing-context-4">browsing context</a> is to be closed.</p>

   </li><li>

    <p>Reenable the user interface for all the browsing contexts in <var>the list of
    background browsing contexts</var>.</p>

   </li><li>

    <p>If the <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="dialogs-implemented-using-separate-documents:auxiliary-browsing-context-2">auxiliary browsing context</a>'s <a href="/breakup/specs/browser-dom/#return-value-origin" id="dialogs-implemented-using-separate-documents:return-value-origin-2">return value origin</a> at the time
    the browsing context was <a href="/breakup/specs/browser-dom/#close-a-browsing-context" id="dialogs-implemented-using-separate-documents:close-a-browsing-context-2">closed</a> was the <a href="/breakup/specs/browser-dom/#same-origin" id="dialogs-implemented-using-separate-documents:same-origin-2">same</a> as <var>incumbent origin</var>, then let <var>return value</var> be the <a href="/breakup/specs/browser-dom/#auxiliary-browsing-context" id="dialogs-implemented-using-separate-documents:auxiliary-browsing-context-3">auxiliary browsing context</a>'s <a href="/breakup/specs/browser-dom/#return-value" id="dialogs-implemented-using-separate-documents:return-value-2">return
    value</a> as it stood when the browsing context was <a href="/breakup/specs/browser-dom/#close-a-browsing-context" id="dialogs-implemented-using-separate-documents:close-a-browsing-context-3">closed</a>.</p>

    <p>Otherwise, let <var>return value</var> be undefined.</p>

   </li><li>

    <p>Return <var>return value</var>.</p>

   </li></ol>

  <p>The <code id="dialogs-implemented-using-separate-documents:window-4"><a href="/breakup/specs/browser-dom/#window">Window</a></code> objects of <code id="dialogs-implemented-using-separate-documents:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code>s hosted by <a href="/breakup/specs/browser-dom/#browsing-context" id="dialogs-implemented-using-separate-documents:browsing-context-5">browsing contexts</a> created by the above algorithm must also implement the
  <code id="dialogs-implemented-using-separate-documents:windowmodal-2"><a href="/breakup/specs/browser-dom/#windowmodal">WindowModal</a></code> interface.</p>

  <p class="note">When this happens, the members of the <code id="dialogs-implemented-using-separate-documents:windowmodal-3"><a href="/breakup/specs/browser-dom/#windowmodal">WindowModal</a></code> interface, in
  JavaScript environments, appear to actually be part of the <code id="dialogs-implemented-using-separate-documents:window-5"><a href="/breakup/specs/browser-dom/#window">Window</a></code> interface (e.g.
  they are on the same prototype chain as the <code id="dialogs-implemented-using-separate-documents:dom-alert"><a href="/breakup/specs/browser-dom/#dom-alert">window.alert()</a></code>
  method).</p>

  

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="windowmodal">WindowModal</dfn> {
  readonly attribute any <a href="/breakup/specs/browser-dom/#dom-windowmodal-dialogarguments" id="dialogs-implemented-using-separate-documents:dom-windowmodal-dialogarguments">dialogArguments</a>;
  attribute any <a href="/breakup/specs/browser-dom/#dom-windowmodal-returnvalue" id="dialogs-implemented-using-separate-documents:dom-windowmodal-returnvalue">returnValue</a>;
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="dialogs-implemented-using-separate-documents:dom-windowmodal-dialogarguments-2"><a href="/breakup/specs/browser-dom/#dom-windowmodal-dialogarguments">dialogArguments</a></code></dt><dd>

    <p>Returns the <var>argument</var> argument that was passed to the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-7"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method.</p>

   </dd><dt><var>window</var> . <code id="dialogs-implemented-using-separate-documents:dom-windowmodal-returnvalue-2"><a href="/breakup/specs/browser-dom/#dom-windowmodal-returnvalue">returnValue</a></code> [ = <var>value</var> ]</dt><dd>

    <p>Returns the current return value for the window.</p>

    <p>Can be set, to change the value that will be returned by the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-8"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method.</p>

   </dd></dl>

  

  <p>Such browsing contexts have associated <dfn id="dialog-arguments">dialog arguments</dfn>, which are stored along with
  the <dfn id="dialog-arguments'-origin">dialog arguments' origin</dfn>. These values are set by the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-9"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method in the algorithm above, when the
  browsing context is created, based on the arguments provided to the method.</p>

  <p>The <dfn id="dom-windowmodal-dialogarguments"><code>dialogArguments</code></dfn> IDL
  attribute, on getting, must check whether its browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document-4">active document</a>'s
  <a href="/breakup/specs/browser-dom/#effective-script-origin" id="dialogs-implemented-using-separate-documents:effective-script-origin-2">effective script origin</a> is the <a href="/breakup/specs/browser-dom/#same-origin" id="dialogs-implemented-using-separate-documents:same-origin-3">same</a> as the <a href="/breakup/specs/browser-dom/#dialog-arguments'-origin" id="dialogs-implemented-using-separate-documents:dialog-arguments'-origin-2">dialog arguments'
  origin</a>. If it is, then the browsing context's <a href="/breakup/specs/browser-dom/#dialog-arguments" id="dialogs-implemented-using-separate-documents:dialog-arguments-2">dialog arguments</a> must be
  returned unchanged. Otherwise, the IDL attribute must return <i>undefined</i>.</p>

  <p>These browsing contexts also have an associated <dfn id="return-value">return value</dfn> and <dfn id="return-value-origin">return value
  origin</dfn>. As with the previous two values, these values are set by the <code id="dialogs-implemented-using-separate-documents:dom-showmodaldialog-10"><a href="/breakup/specs/browser-dom/#dom-showmodaldialog">showModalDialog()</a></code> method in the algorithm above, when the
  browsing context is created.</p>

  <p>The <dfn id="dom-windowmodal-returnvalue"><code>returnValue</code></dfn> IDL attribute, on
  getting, must check whether its browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document-5">active document</a>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="dialogs-implemented-using-separate-documents:effective-script-origin-3">effective
  script origin</a> is the <a href="/breakup/specs/browser-dom/#same-origin" id="dialogs-implemented-using-separate-documents:same-origin-4">same</a> as the current <a href="/breakup/specs/browser-dom/#return-value-origin" id="dialogs-implemented-using-separate-documents:return-value-origin-3">return
  value origin</a>. If it is, then the browsing context's <a href="/breakup/specs/browser-dom/#return-value" id="dialogs-implemented-using-separate-documents:return-value-3">return value</a> must be
  returned unchanged. Otherwise, the IDL attribute must return <i>undefined</i>. On setting, the
  attribute must set the <a href="/breakup/specs/browser-dom/#return-value" id="dialogs-implemented-using-separate-documents:return-value-4">return value</a> to the given new value, and the <a href="/breakup/specs/browser-dom/#return-value-origin" id="dialogs-implemented-using-separate-documents:return-value-origin-4">return
  value origin</a> to the browsing context's <a href="/breakup/specs/browser-dom/#active-document" id="dialogs-implemented-using-separate-documents:active-document-6">active document</a>'s <a href="/breakup/specs/browser-dom/#effective-script-origin" id="dialogs-implemented-using-separate-documents:effective-script-origin-4">effective
  script origin</a>.</p>

  

  <p class="note">The <code id="dialogs-implemented-using-separate-documents:dom-window-close"><a href="/breakup/specs/browser-dom/#dom-window-close">window.close()</a></code> method can be used to
  close the browsing context.</p></section></section><section><h3 id="system-state-and-capabilities">7.6 System state and capabilities</h3>

  <section><h4 id="the-navigator-object">7.6.1 The <code id="the-navigator-object:navigator"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code> object</h4>

  

  <p>The <dfn id="dom-navigator"><code>navigator</code></dfn> attribute of the
  <code id="the-navigator-object:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> interface must return an instance of the <code id="the-navigator-object:navigator-2"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code> interface,
  which represents the identity and state of the user agent (the client), and allows Web pages to
  register themselves as potential protocol and content handlers:</p>

  

  <pre class="idl">interface <dfn id="navigator">Navigator</dfn> {
  // objects implementing this interface also implement the interfaces given below
};
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-3">Navigator</a> implements <a href="/breakup/specs/browser-dom/#navigatorid" id="the-navigator-object:navigatorid">NavigatorID</a>;
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-4">Navigator</a> implements <a href="/breakup/specs/browser-dom/#navigatorlanguage" id="the-navigator-object:navigatorlanguage">NavigatorLanguage</a>;
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-5">Navigator</a> implements <a href="#navigatoronline" id="the-navigator-object:navigatoronline">NavigatorOnLine</a>;
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-6">Navigator</a> implements <a href="/breakup/specs/browser-dom/#navigatorcontentutils" id="the-navigator-object:navigatorcontentutils">NavigatorContentUtils</a>;
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-7">Navigator</a> implements <a href="/breakup/specs/browser-dom/#navigatorstorageutils" id="the-navigator-object:navigatorstorageutils">NavigatorStorageUtils</a>;
<a href="/breakup/specs/browser-dom/#navigator" id="the-navigator-object:navigator-8">Navigator</a> implements <a href="/breakup/specs/browser-dom/#navigatorplugins" id="the-navigator-object:navigatorplugins">NavigatorPlugins</a>;</pre>



  

  <p>These interfaces are defined separately so that other specifications can re-use parts of the
  <code id="the-navigator-object:navigator-9"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code> interface.</p>

  


  <section><h5 id="client-identification">7.6.1.1 Client identification</h5>

  <pre class="idl">[NoInterfaceObject, Exposed=(Window,Worker)]
interface <dfn id="navigatorid">NavigatorID</dfn> {
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-appcodename" id="client-identification:dom-navigator-appcodename">appCodeName</a>; // constant "Mozilla"
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-appname" id="client-identification:dom-navigator-appname">appName</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-appversion" id="client-identification:dom-navigator-appversion">appVersion</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-platform" id="client-identification:dom-navigator-platform">platform</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-product" id="client-identification:dom-navigator-product">product</a>; // constant "Gecko"
  boolean <a href="/breakup/specs/browser-dom/#dom-navigator-taintenabled" id="client-identification:dom-navigator-taintenabled">taintEnabled</a>(); // constant false
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-useragent" id="client-identification:dom-navigator-useragent">userAgent</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-vendorsub" id="client-identification:dom-navigator-vendorsub">vendorSub</a>;
};</pre>

  <p>In certain cases, despite the best efforts of the entire industry, Web browsers have bugs and
  limitations that Web authors are forced to work around.</p>

  <p>This section defines a collection of attributes that can be used to determine, from script, the
  kind of user agent in use, in order to work around these issues.</p>

  <p>Client detection should always be limited to detecting known current versions; future versions
  and unknown versions should always be assumed to be fully compliant.</p>

  <dl class="domintro"><dt><var>window</var> . <code id="client-identification:dom-navigator"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-appcodename-2"><a href="/breakup/specs/browser-dom/#dom-navigator-appcodename">appCodeName</a></code></dt><dd>
    <p>Returns the string "<code>Mozilla</code>".</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-2"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-appname-2"><a href="/breakup/specs/browser-dom/#dom-navigator-appname">appName</a></code></dt><dd>
    <p>Returns the name of the browser.</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-3"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-appversion-2"><a href="/breakup/specs/browser-dom/#dom-navigator-appversion">appVersion</a></code></dt><dd>
    <p>Returns the version of the browser.</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-4"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-platform-2"><a href="/breakup/specs/browser-dom/#dom-navigator-platform">platform</a></code></dt><dd>
    <p>Returns the name of the platform.</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-5"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-product-2"><a href="/breakup/specs/browser-dom/#dom-navigator-product">product</a></code></dt><dd>
    <p>Returns the string "<code>Gecko</code>".</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-6"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-taintenabled-2"><a href="/breakup/specs/browser-dom/#dom-navigator-taintenabled">taintEnabled</a></code>()</dt><dd>
    <p>Returns false.</p>
   </dd><dt><var>window</var> . <code id="client-identification:dom-navigator-7"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="client-identification:dom-navigator-useragent-2"><a href="/breakup/specs/browser-dom/#dom-navigator-useragent">userAgent</a></code></dt><dd>
    <p>Returns the complete User-Agent header.</p>
   </dd></dl>

  

  <dl><dt><dfn id="dom-navigator-appcodename"><code>appCodeName</code></dfn></dt><dd><p>Must return the string "<code>Mozilla</code>".</p></dd><dt><dfn id="dom-navigator-appname"><code>appName</code></dfn></dt><dd><p>Must return either the string "<code>Netscape</code>" or the full name of the
   browser, e.g. "<code>Mellblom Browsernator</code>".</p></dd><dt><dfn id="dom-navigator-appversion"><code>appVersion</code></dfn></dt><dd><p>Must return either the string "<code>4.0</code>" or a string representing the
   version of the browser in detail, e.g. "<code>1.0 (VMS; en-US)
   Mellblomenator/9000</code>".</p></dd><dt><dfn id="dom-navigator-platform"><code>platform</code></dfn></dt><dd><p>Must return either the empty string or a string representing the platform on which the
   browser is executing, e.g. "<code>MacIntel</code>", "<code>Win32</code>",
   "<code>FreeBSD i386</code>", "<code>WebTV OS</code>".</p></dd><dt><dfn id="dom-navigator-product"><code>product</code></dfn></dt><dd><p>Must return the string "<code>Gecko</code>".</p></dd><dt><dfn id="dom-navigator-taintenabled"><code>taintEnabled()</code></dfn></dt><dd><p>Must return false.</p></dd><dt><dfn id="dom-navigator-useragent"><code>userAgent</code></dfn></dt><dd><p>Must return the string used for the value of the "<code>User-Agent</code>" header
   in HTTP requests, or the empty string if no such header is ever sent.</p></dd><dt><dfn id="dom-navigator-vendorsub"><code>vendorSub</code></dfn></dt><dd><p>Must return the empty string.</p></dd></dl>

  
  <p class="warning">Any information in this API that varies from user to user can be used to
  profile the user. In fact, if enough such information is available, a user can actually be
  uniquely identified. For this reason, user agent implementors are strongly urged to include as
  little information in this API as possible.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="client-identification:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p></section>

  

  

  <section><h5 id="language-preferences">7.6.1.2 Language preferences</h5>

  <pre class="idl">[NoInterfaceObject, Exposed=(Window,Worker)]
interface <dfn id="navigatorlanguage">NavigatorLanguage</dfn> {
  readonly attribute DOMString? <a href="/breakup/specs/browser-dom/#dom-navigator-language" id="language-preferences:dom-navigator-language">language</a>;
  readonly attribute DOMString[] <a href="/breakup/specs/browser-dom/#dom-navigator-languages" id="language-preferences:dom-navigator-languages">languages</a>;
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="language-preferences:dom-navigator"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="language-preferences:dom-navigator-language-2"><a href="/breakup/specs/browser-dom/#dom-navigator-language">language</a></code></dt><dd>
    <p>Returns a language tag representing the user's preferred language.</p>
   </dd><dt><var>window</var> . <code id="language-preferences:dom-navigator-2"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="language-preferences:dom-navigator-languages-2"><a href="/breakup/specs/browser-dom/#dom-navigator-languages">languages</a></code></dt><dd>
    <p>Returns an array of language tags representing the user's preferred languages, with the most preferred language first.</p>
    <p>The most preferred language is the one returned by <code id="language-preferences:dom-navigator-language-3"><a href="/breakup/specs/browser-dom/#dom-navigator-language">navigator.language</a></code>.</p>
   </dd></dl>

  <p class="note">A <code id="language-preferences:event-languagechange"><a href="/breakup/specs/html/#event-languagechange">languagechange</a></code> event is fired at the
  <code id="language-preferences:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code> or <code id="language-preferences:workerglobalscope"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object when the user agent's understanding
  of what the user's preferred languages are changes.</p>

  

  <dl><dt><dfn id="dom-navigator-language"><code>language</code></dfn></dt><dd><p>Must return a valid BCP 47 language tag representing either <a href="/breakup/specs/browser-dom/#a-plausible-language" id="language-preferences:a-plausible-language">a plausible
   language</a> or the user's most preferred language. <a href="#refsBCP47">[BCP47]</a></p></dd><dt><dfn id="dom-navigator-languages"><code>languages</code></dfn></dt><dd>

    <p>Must return a <a href="/breakup/specs/core-algorithms/#dfn-read-only-array" id="language-preferences:dfn-read-only-array">read only</a> array of valid BCP 47
    language tags representing either one or more <a href="/breakup/specs/browser-dom/#a-plausible-language" id="language-preferences:a-plausible-language-2">plausible
    languages</a>, or the user's preferred languages, ordered by preference with the most
    preferred language first. The same object must be returned until the user agent needs to return
    different values, or values in a different order. <a href="#refsBCP47">[BCP47]</a></p>

    <p>Whenever the user agent needs to make the <code id="language-preferences:dom-navigator-languages-3"><a href="/breakup/specs/browser-dom/#dom-navigator-languages">navigator.languages</a></code> attribute of a <code id="language-preferences:window-2"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
    or <code id="language-preferences:workerglobalscope-2"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object return a new set of language tags, the user agent must
    <a href="/breakup/specs/browser-dom/#queue-a-task" id="language-preferences:queue-a-task">queue a task</a> to <a href="/breakup/specs/browser-dom/#fire-a-simple-event" id="language-preferences:fire-a-simple-event">fire a simple event</a> named <code id="language-preferences:event-languagechange-2"><a href="/breakup/specs/html/#event-languagechange">languagechange</a></code> at the <code id="language-preferences:window-3"><a href="/breakup/specs/browser-dom/#window">Window</a></code> or
    <code id="language-preferences:workerglobalscope-3"><a href="http://www.w3.org/TR/workers/#workerglobalscope">WorkerGlobalScope</a></code> object and wait until that task begins to be executed before
    actually returning a new value.</p>

    <p>The <a href="/breakup/specs/browser-dom/#task-source" id="language-preferences:task-source">task source</a> for this <a href="/breakup/specs/browser-dom/#concept-task" id="language-preferences:concept-task">task</a> is the
    <a href="/breakup/specs/browser-dom/#dom-manipulation-task-source" id="language-preferences:dom-manipulation-task-source">DOM manipulation task source</a>.</p>

   </dd></dl>

  <p>To determine <dfn id="a-plausible-language">a plausible language</dfn>, the user agent should bear in mind the following:</p>

  <ul><li>Any information in this API that varies from user to user can be used to profile or identify
   the user.
   <a href="/breakup/specs/html/#fingerprinting-vector" id="language-preferences:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
   </li><li>If the user is not using a service that obfuscates the user's point of origin (e.g. the Tor
   anonymity network), then the value that is least likely to distinguish the user from other users
   with similar origins (e.g. from the same IP address block) is the language used by the majority
   of such users. <a href="#refsTOR">[TOR]</a></li><li>If the user is using an anonymizing service, then the value "<code>en-US</code>" is
   suggested; if all users of the service use that same value, that reduces the possibility of
   distinguishing the users from each other.</li></ul>

  <p>To avoid introducing any more fingerprinting vectors, user agents should use the same list for
  the APIs defined in this function as for the HTTP <code id="language-preferences:http-accept-language"><a href="/breakup/specs/core-algorithms/#http-accept-language">Accept-Language</a></code> header.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="language-preferences:fingerprinting-vector-2" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p></section>

  



  <section><h5 id="custom-handlers">7.6.1.3 Custom scheme and content handlers: the <code id="custom-handlers:dom-navigator-registerprotocolhandler"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code> and <code id="custom-handlers:dom-navigator-registercontenthandler"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code> methods</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorcontentutils">NavigatorContentUtils</dfn> {
  // content handler registration
  void <a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler" id="custom-handlers:dom-navigator-registerprotocolhandler-2">registerProtocolHandler</a>(DOMString scheme, DOMString url, DOMString title);
  void <a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler" id="custom-handlers:dom-navigator-registercontenthandler-2">registerContentHandler</a>(DOMString mimeType, DOMString url, DOMString title);
  DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-isprotocolhandlerregistered" id="custom-handlers:dom-navigator-isprotocolhandlerregistered">isProtocolHandlerRegistered</a>(DOMString scheme, DOMString url);
  DOMString <a href="/breakup/specs/browser-dom/#dom-navigator-iscontenthandlerregistered" id="custom-handlers:dom-navigator-iscontenthandlerregistered">isContentHandlerRegistered</a>(DOMString mimeType, DOMString url);
  void <a href="/breakup/specs/browser-dom/#dom-navigator-unregisterprotocolhandler" id="custom-handlers:dom-navigator-unregisterprotocolhandler">unregisterProtocolHandler</a>(DOMString scheme, DOMString url);
  void <a href="/breakup/specs/browser-dom/#dom-navigator-unregistercontenthandler" id="custom-handlers:dom-navigator-unregistercontenthandler">unregisterContentHandler</a>(DOMString mimeType, DOMString url);
};</pre>

  <p>The <dfn id="dom-navigator-registerprotocolhandler"><code>registerProtocolHandler()</code></dfn> method
  allows Web sites to register themselves as possible handlers for particular schemes. For example,
  an online telephone messaging service could register itself as a handler of the <code id="custom-handlers:sms-protocol"><a data-x-internal="sms-protocol" href="http://tools.ietf.org/html/rfc5724#section-2">sms:</a></code> scheme, so that if the user clicks on such a link, he is given the
  opportunity to use that Web site. Analogously, the <dfn id="dom-navigator-registercontenthandler"><code>registerContentHandler()</code></dfn> method allows
  Web sites to register themselves as possible handlers for content in a particular <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type">MIME
  type</a>. For example, the same online telephone messaging service could register itself as a
  handler for <code id="custom-handlers:text/vcard"><a href="#text/vcard">text/vcard</a></code> files, so that if the user has no native application capable
  of handling vCards, his Web browser can instead suggest he use that site to view contact
  information stored on vCards that he opens. <a href="#refsSMS">[SMS]</a> <a href="#refsRFC6350">[RFC6350]</a></p>

  <dl class="domintro"><dt><var>window</var> . <code id="custom-handlers:dom-navigator"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-registerprotocolhandler-3"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler</a></code>(<var>scheme</var>, <var>url</var>, <var>title</var>)</dt><dt><var>window</var> . <code id="custom-handlers:dom-navigator-2"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-registercontenthandler-3"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler</a></code>(<var>mimeType</var>, <var>url</var>, <var>title</var>)</dt><dd>

    <p>Registers a handler for the given scheme or content type, at the given URL, with the given
    title.</p>

    <p>The string "<code>%s</code>" in the URL is used as a placeholder for where to put
    the URL of the content to be handled.</p>

    <p>Throws a <code id="custom-handlers:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception if the user agent blocks the registration (this
    might happen if trying to register as a handler for "http", for instance).</p>

    <p>Throws a <code id="custom-handlers:syntaxerror"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception if the "<code>%s</code>" string is
    missing in the URL.</p>

   </dd></dl>

  

  <p>User agents may, within the constraints described in this section, do whatever they like when
  the methods are called. A UA could, for instance, prompt the user and offer the user the
  opportunity to add the site to a shortlist of handlers, or make the handlers his default, or
  cancel the request. UAs could provide such a UI through modal UI or through a non-modal transient
  notification interface. UAs could also simply silently collect the information, providing it only
  when relevant to the user.</p>

  <p>User agents should keep track of which sites have registered handlers (even if the user has
  declined such registrations) so that the user is not repeatedly prompted with the same
  request.</p>

  <p>The arguments to the methods have the following meanings and corresponding implementation
  requirements. The requirements that involve throwing exceptions must be processed in the order
  given below, stopping at the first exception thrown. (So the exceptions for the first argument
  take precedence over the exceptions for the second argument.)</p>

  <dl><dt><var>scheme</var> (<code id="custom-handlers:dom-navigator-registerprotocolhandler-4"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code> only)</dt><dd>

    <p>A scheme, such as "<code>mailto</code>" or "<code>web+auth</code>". The
    scheme must be compared in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive">ASCII case-insensitive</a> manner by user agents for the
    purposes of comparing with the scheme part of URLs that they consider against the list of
    registered handlers.</p>

    <p>The <var>scheme</var> value, if it contains a colon (as in "<code>mailto:</code>"),
    will never match anything, since schemes don't contain colons.</p>

    <p>If the <code id="custom-handlers:dom-navigator-registerprotocolhandler-5"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code>
    method is invoked with a scheme that is neither a <a href="/breakup/specs/browser-dom/#whitelisted-scheme" id="custom-handlers:whitelisted-scheme">whitelisted scheme</a> nor a scheme
    whose value starts with the substring "<code>web+</code>" and otherwise contains only
    <a href="/breakup/specs/core-algorithms/#lowercase-ascii-letters" id="custom-handlers:lowercase-ascii-letters">lowercase ASCII letters</a>, and whose length is at least five characters (including
    the "<code>web+</code>" prefix), the user agent must throw a <code id="custom-handlers:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code>
    exception.</p>

    <p>The following schemes are the <dfn id="whitelisted-scheme">whitelisted schemes</dfn>:</p>

    <ul class="brief"><li><code>bitcoin</code></li><li><code>geo</code></li><li><code>im</code></li><li><code>irc</code></li><li><code>ircs</code></li><li><code>magnet</code></li><li><code>mailto</code></li><li><code>mms</code></li><li><code>news</code></li><li><code>nntp</code></li><li><code>openpgp4fpr</code></li><li><code>sip</code></li><li><code>sms</code></li><li><code>smsto</code></li><li><code>ssh</code></li><li><code>tel</code></li><li><code>urn</code></li><li><code>webcal</code></li><li><code>wtai</code></li><li><code>xmpp</code></li></ul>

    <p class="note">This list can be changed. If there are schemes that should be added, please send
    feedback.</p>

    <p class="note">This list excludes any schemes that could reasonably be expected to be supported
    inline, e.g. in an <code id="custom-handlers:the-iframe-element"><a href="#the-iframe-element">iframe</a></code>, such as <code>http</code> or (more
    theoretically) <code>gopher</code>. If those were supported, they could potentially be
    used in man-in-the-middle attacks, by replacing pages that have frames with such content with
    content under the control of the protocol handler. If the user agent has native support for the
    schemes, this could further be used for cookie-theft attacks.</p>

   </dd><dt><var>mimeType</var> (<code id="custom-handlers:dom-navigator-registercontenthandler-4"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code> only)</dt><dd>

    <p>A <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-2">MIME type</a>, such as <code>model/vnd.flatland.3dml</code> or <code>application/vnd.google-earth.kml+xml</code>. The <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-3">MIME type</a> must be
    compared in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive-2">ASCII case-insensitive</a> manner by user agents for the purposes of
    comparing with MIME types of documents that they consider against the list of registered
    handlers.</p>

    <p>User agents must compare the given values only to the MIME type/subtype parts of content
    types, not to the complete type including parameters. Thus, if <var>mimeType</var>
    values passed to this method include characters such as commas or whitespace, or include MIME
    parameters, then the handler being registered will never be used.</p>

    <p class="note">The type is compared to the <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-4">MIME type</a> used by the user agent
    <em>after</em> the sniffing algorithms have been applied.</p>

    <p>If the <code id="custom-handlers:dom-navigator-registercontenthandler-5"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code>
    method is invoked with a <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-5">MIME type</a> that is in the <a href="/breakup/specs/browser-dom/#type-blacklist" id="custom-handlers:type-blacklist">type blacklist</a> or
    that the user agent has deemed a privileged type, the user agent must throw a
    <code id="custom-handlers:securityerror-3"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception.</p>

    <p>The following <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-6">MIME types</a> are in the <dfn id="type-blacklist">type
    blacklist</dfn>:</p>

    <ul class="brief"><li><code id="custom-handlers:application/x-www-form-urlencoded"><a href="#application/x-www-form-urlencoded">application/x-www-form-urlencoded</a></code></li><li><code id="custom-handlers:application/xhtml+xml"><a href="#application/xhtml+xml">application/xhtml+xml</a></code></li><li><code id="custom-handlers:application/xml"><a href="#application/xml">application/xml</a></code></li><li><code id="custom-handlers:image/gif"><a href="#image/gif">image/gif</a></code></li><li><code id="custom-handlers:image/jpeg"><a href="#image/jpeg">image/jpeg</a></code></li><li><code id="custom-handlers:image/png"><a href="#image/png">image/png</a></code></li><li><code id="custom-handlers:image/svg+xml"><a href="#image/svg+xml">image/svg+xml</a></code></li><li><code id="custom-handlers:multipart/x-mixed-replace"><a href="#multipart/x-mixed-replace">multipart/x-mixed-replace</a></code></li><li><code id="custom-handlers:text/cache-manifest"><a href="#text/cache-manifest">text/cache-manifest</a></code></li><li><code id="custom-handlers:text/css"><a href="#text/css">text/css</a></code></li><li><code id="custom-handlers:text/html"><a href="#text/html">text/html</a></code></li><li><code id="custom-handlers:text/ping"><a href="https://html.spec.whatwg.org/#text/ping">text/ping</a></code></li><li><code id="custom-handlers:text/plain"><a data-x-internal="text/plain" href="http://tools.ietf.org/html/rfc2046#section-4.1.3">text/plain</a></code></li><li><code id="custom-handlers:text/xml"><a href="#text/xml">text/xml</a></code></li><li>All types that the user agent supports displaying natively in a <a href="/breakup/specs/browser-dom/#browsing-context" id="custom-handlers:browsing-context">browsing context</a> during <a href="#navigate" id="custom-handlers:navigate">navigation</a>, except for <code id="custom-handlers:application/rss+xml"><a href="#application/rss+xml">application/rss+xml</a></code> and <code id="custom-handlers:application/atom+xml"><a href="#application/atom+xml">application/atom+xml</a></code></li></ul>

    <p class="note">This list can be changed. If there are MIME types that should be added, please
    send feedback.</p>

   </dd><dt><var>url</var></dt><dd>

    <p>A string used to build the <a href="/breakup/specs/core-algorithms/#url" id="custom-handlers:url">URL</a> of the page that will handle the requests.</p>

    <p>User agents must throw a <code id="custom-handlers:syntaxerror-2"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception if the <var>url</var>
    argument passed to one of these methods does not contain the exact literal string
    "<code>%s</code>".</p>

    <p>User agents must throw a <code id="custom-handlers:syntaxerror-3"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception if <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="custom-handlers:resolve-a-url">resolving</a> the <var>url</var> argument relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="custom-handlers:api-base-url">API base
    URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="custom-handlers:entry-settings-object">entry settings object</a> is not successful.</p>

    <p class="note">The resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url">absolute URL</a> would by definition not be a <a href="/breakup/specs/core-algorithms/#valid-url" id="custom-handlers:valid-url">valid
    URL</a> as it would include the string "<code>%s</code>" which is not a valid
    component in a URL.</p>

    <p>User agents must throw a <code id="custom-handlers:securityerror-4"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception if the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-2">absolute
    URL</a> has an <a href="/breakup/specs/browser-dom/#origin-2" id="custom-handlers:origin-2">origin</a> that differs from the <a href="/breakup/specs/browser-dom/#origin-2" id="custom-handlers:origin-2-2">origin</a> specified by the
    <a href="/breakup/specs/browser-dom/#entry-settings-object" id="custom-handlers:entry-settings-object-2">entry settings object</a>.</p>

    <p class="note">This is forcibly the case if the <code>%s</code> placeholder is in the
    scheme, host, or port parts of the URL.</p>

    <p>The resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-3">absolute URL</a> is the <dfn id="proto-url">proto-URL</dfn>. It identifies the
    handler for the purposes of the methods described below.</p>

    <p>When the user agent uses this handler, it must replace the first occurrence of the exact
    literal string "<code>%s</code>" in the <var>url</var> argument with an
    escaped version of the <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-4">absolute URL</a> of the content in question (as defined below),
    then <a href="/breakup/specs/core-algorithms/#resolve-a-url" id="custom-handlers:resolve-a-url-2">resolve</a> the resulting URL, relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="custom-handlers:api-base-url-2">API
    base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="custom-handlers:entry-settings-object-3">entry settings object</a> at the time the <code id="custom-handlers:dom-navigator-registercontenthandler-6"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code> or <code id="custom-handlers:dom-navigator-registerprotocolhandler-6"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code> methods were
    invoked, and then <a href="#navigate" id="custom-handlers:navigate-2">navigate</a> an appropriate <a href="/breakup/specs/browser-dom/#browsing-context" id="custom-handlers:browsing-context-2">browsing
    context</a> to the resulting URL using the GET method (<a href="/breakup/specs/core-algorithms/#concept-http-equivalent-get" id="custom-handlers:concept-http-equivalent-get">or equivalent</a> for non-HTTP URLs).</p>

    <p>To get the escaped version of the <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-5">absolute URL</a> of the content in question, the
    user agent must replace every character in that <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-6">absolute URL</a> that is not a
    character in the URL <a href="/breakup/specs/core-algorithms/#default-encode-set" id="custom-handlers:default-encode-set">default encode set</a> with the result of <a href="/breakup/specs/core-algorithms/#utf-8-percent-encode" id="custom-handlers:utf-8-percent-encode">UTF-8 percent encoding</a> that character.</p>

    <div class="example">

     <p>If the user had visited a site at <code>http://example.com/</code> that made the
     following call:</p>

     <pre>navigator.registerContentHandler('application/x-soup', 'soup?url=%s', 'SoupWeb')</pre>

     <p>...and then, much later, while visiting <code>http://www.example.net/</code>,
     clicked on a link such as:</p>

     <pre>&lt;a href="chickenkwi.soup"&gt;Download our Chicken Kwi soup!&lt;/a&gt;</pre>

     <p>...then, assuming this <code>chickenkwi.soup</code> file was served with the
     <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-7">MIME type</a> <code>application/x-soup</code>, the UA might navigate to the
     following URL:</p>

     <pre>http://example.com/soup?url=http://www.example.net/chickenk%C3%AFwi.soup</pre>

     <p>This site could then fetch the <code>chickenkwi.soup</code> file and do
     whatever it is that it does with soup (synthesise it and ship it to the user, or whatever).</p>

    </div>

   </dd><dt><var>title</var></dt><dd>

    <p>A descriptive title of the handler, which the UA might use to remind the user what the site
    in question is.</p>

   </dd></dl>

  <p>This section does not define how the pages registered by these methods are used, beyond the
  requirements on how to process the <var>url</var> value (see above). To some extent, the
  <a href="#navigate" id="custom-handlers:navigate-3">processing model for navigating across documents</a> defines some cases
  where these methods are relevant, but in general UAs may use this information wherever they would
  otherwise consider handing content to native plugins or helper applications.</p>

  <p>UAs must not use registered content handlers to handle content that was returned as part of a
  non-GET transaction (or rather, as part of any non-idempotent transaction), as the remote site
  would not be able to fetch the same data.</p>

  <hr>

  

  <p>In addition to the registration methods, there are also methods for determining if particular
  handlers have been registered, and for unregistering handlers.</p>

  <dl class="domintro"><dt><var>state</var> = <var>window</var> . <code id="custom-handlers:dom-navigator-3"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-isprotocolhandlerregistered-2"><a href="/breakup/specs/browser-dom/#dom-navigator-isprotocolhandlerregistered">isProtocolHandlerRegistered</a></code>(<var>scheme</var>, <var>url</var>)</dt><dt><var>state</var> = <var>window</var> . <code id="custom-handlers:dom-navigator-4"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-iscontenthandlerregistered-2"><a href="/breakup/specs/browser-dom/#dom-navigator-iscontenthandlerregistered">isContentHandlerRegistered</a></code>(<var>mimeType</var>, <var>url</var>)</dt><dd>

    <p>Returns one of the following strings describing the state of the handler given by the
    arguments:</p>

    <dl><dt><code>new</code>

     </dt><dd>Indicates that no attempt has been made to register the given handler (or that the handler
     has been unregistered). It would be appropriate to promote the availability of the handler or
     to just automatically register the handler.

     </dd><dt><code>registered</code>

     </dt><dd>Indicates that the given handler has been registered or that the site is blocked from
     registering the handler. Trying to register the handler again would have no effect.

     </dd><dt><code>declined</code>

     </dt><dd>Indicates that the given handler has been offered but was rejected. Trying to register the
     handler again may prompt the user again.

    </dd></dl>

   </dd><dt><var>window</var> . <code id="custom-handlers:dom-navigator-5"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-unregisterprotocolhandler-2"><a href="/breakup/specs/browser-dom/#dom-navigator-unregisterprotocolhandler">unregisterProtocolHandler</a></code>(<var>scheme</var>, <var>url</var>)</dt><dt><var>window</var> . <code id="custom-handlers:dom-navigator-6"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="custom-handlers:dom-navigator-unregistercontenthandler-2"><a href="/breakup/specs/browser-dom/#dom-navigator-unregistercontenthandler">unregisterContentHandler</a></code>(<var>mimeType</var>, <var>url</var>)</dt><dd>

    <p>Unregisters the handler given by the arguments.</p>

   </dd></dl>

  

  <p>The <dfn id="dom-navigator-isprotocolhandlerregistered"><code>isProtocolHandlerRegistered()</code></dfn>
  method must return the <a href="/breakup/specs/browser-dom/#handler-state-string" id="custom-handlers:handler-state-string">handler state string</a> that most closely describes the current
  state of the handler described by the two arguments to the method, where the first argument gives
  the scheme and the second gives the string used to build the <a href="/breakup/specs/core-algorithms/#url" id="custom-handlers:url-2">URL</a> of the page that
  will handle the requests.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="custom-handlers:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The first argument must be compared to the schemes for which custom protocol handlers are
  registered in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive-3">ASCII case-insensitive</a> manner to find the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and if that is successful, must
  then be matched against the <a href="/breakup/specs/browser-dom/#proto-url" id="custom-handlers:proto-url">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr>

  <p>The <dfn id="dom-navigator-iscontenthandlerregistered"><code>isContentHandlerRegistered()</code></dfn>
  method must return the <a href="/breakup/specs/browser-dom/#handler-state-string" id="custom-handlers:handler-state-string-2">handler state string</a> that most closely describes the current
  state of the handler described by the two arguments to the method, where the first argument gives
  the <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-8">MIME type</a> and the second gives the string used to build the <a href="/breakup/specs/core-algorithms/#url" id="custom-handlers:url-3">URL</a> of
  the page that will handle the requests.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="custom-handlers:fingerprinting-vector-2" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The first argument must be compared to the <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-9">MIME types</a> for which
  custom content handlers are registered in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive-4">ASCII case-insensitive</a> manner to find
  the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and if that is successful, must
  then be matched against the <a href="/breakup/specs/browser-dom/#proto-url" id="custom-handlers:proto-url-2">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr>

  <p>The <dfn id="handler-state-string">handler state strings</dfn> are the following strings.
  Each string describes several situations, as given by the following list.</p>

  <dl><dt><code>new</code>

   </dt><dd>The described handler has never been registered for the given scheme or type.

   </dd><dd>The described handler was once registered for the given scheme or type, but the site has
   since unregistered it. If the handler were to be reregistered, the user would be notified
   accordingly.

   </dd><dd>The described handler was once registered for the given scheme or type, but the site has
   since unregistered it, but the user has indicated that the site is to be blocked from registering
   the type again, so the user agent would ignore further registration attempts.


   </dd><dt><code>registered</code>

   </dt><dd>An attempt was made to register the described handler for the given scheme or type, but the
   user has not yet been notified, and the user agent would ignore further registration attempts.
   (Maybe the user agent batches registration requests to display them when the user requests to be
   notified about them, and the user has not yet requested that the user agent notify it of the
   previous registration attempt.)

   </dd><dd>The described handler is registered for the given scheme or type (maybe, or maybe not, as the
   default handler).

   </dd><dd>The described handler is permanently blocked from being (re)registered. (Maybe the user
   marked the registration attempt as spam, or blocked the site for other reasons.)


   </dd><dt><code>declined</code>

   </dt><dd>An attempt was made to register the described handler for the given scheme or type, but the
   user has not yet been notified; however, the user might be notified if another registration
   attempt were to be made. (Maybe the last registration attempt was made while the page was in the
   background and the user closed the page without looking at it, and the user agent requires
   confirmation for this registration attempt.)

   </dd><dd>An attempt was made to register the described handler for the given scheme or type, but the
   user has not yet responded.

   </dd><dd>An attempt was made to register the described handler for the given scheme or type, but the
   user declined the offer. The user has not indicated that the handler is to be permanently
   blocked, however, so another attempt to register the described handler might result in the user
   being prompted again.

   </dd><dd>The described handler was once registered for the given scheme or type, but the user has
   since removed it. The user has not indicated that the handler is to be permanently blocked,
   however, so another attempt to register the described handler might result in the user being
   prompted again.

  </dd></dl>

  <hr>

  <p>The <dfn id="dom-navigator-unregisterprotocolhandler"><code>unregisterProtocolHandler()</code></dfn>
  method must unregister the handler described by the two arguments to the method, where the first
  argument gives the scheme and the second gives the string used to build the <a href="/breakup/specs/core-algorithms/#url" id="custom-handlers:url-4">URL</a> of
  the page that will handle the requests.</p>

  <p>The first argument must be compared to the schemes for which custom protocol handlers are
  registered in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive-5">ASCII case-insensitive</a> manner to find the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and if that is successful, must
  then be matched against the <a href="/breakup/specs/browser-dom/#proto-url" id="custom-handlers:proto-url-3">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr>

  <p>The <dfn id="dom-navigator-unregistercontenthandler"><code>unregisterContentHandler()</code></dfn>
  method must unregister the handler described by the two arguments to the method, where the first
  argument gives the <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-10">MIME type</a> and the second gives the string used to build the
  <a href="/breakup/specs/core-algorithms/#url" id="custom-handlers:url-5">URL</a> of the page that will handle the requests.</p>

  <p>The first argument must be compared to the <a href="/breakup/specs/core-algorithms/#mime-type" id="custom-handlers:mime-type-11">MIME types</a> for which
  custom content handlers are registered in an <a href="/breakup/specs/core-algorithms/#ascii-case-insensitive" id="custom-handlers:ascii-case-insensitive-6">ASCII case-insensitive</a> manner to find
  the relevant handlers.</p>

  <p>The second argument must be preprocessed as described below, and if that is successful, must
  then be matched against the <a href="/breakup/specs/browser-dom/#proto-url" id="custom-handlers:proto-url-4">proto-URLs</a> of the relevant handlers to
  find the described handler.</p>

  <hr>

  <p>The second argument of the four methods described above must be preprocessed as follows:</p>

  <ol><li><p>If the string does not contain the substring "<code>%s</code>", abort these
   steps. There's no matching handler.</p></li><li><p><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="custom-handlers:resolve-a-url-3">Resolve</a> the string relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="custom-handlers:api-base-url-3">API base
   URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="custom-handlers:entry-settings-object-4">entry settings object</a>.</p></li><li><p>If this fails, then throw a <code id="custom-handlers:syntaxerror-4"><a href="/breakup/specs/core-algorithms/#syntaxerror">SyntaxError</a></code> exception, aborting the
   method.</p></li><li><p>If the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-7">absolute URL</a>'s <a href="/breakup/specs/browser-dom/#origin-2" id="custom-handlers:origin-2-3">origin</a> is not the <a href="/breakup/specs/browser-dom/#same-origin" id="custom-handlers:same-origin">same
   origin</a> as the <a href="/breakup/specs/browser-dom/#origin-2" id="custom-handlers:origin-2-4">origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="custom-handlers:entry-settings-object-5">entry settings object</a>,
   throw a <code id="custom-handlers:securityerror-5"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception, aborting the method.</p></li><li><p>Return the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="custom-handlers:absolute-url-8">absolute URL</a> as the result of preprocessing the
   argument.</p></li></ol>

  




  

  <section><h6 id="security-and-privacy">7.6.1.3.1 Security and privacy</h6>

  <p>These mechanisms can introduce a number of concerns, in particular privacy concerns.</p>

  <p><strong>Hijacking all Web usage.</strong> User agents should not allow schemes that are key to
  its normal operation, such as <code>http</code> or <code>https</code>, to be
  rerouted through third-party sites. This would allow a user's activities to be trivially tracked,
  and would allow user information, even in secure connections, to be collected.</p>

  <p><strong>Hijacking defaults.</strong> User agents are strongly urged to not automatically change
  any defaults, as this could lead the user to send data to remote hosts that the user is not
  expecting. New handlers registering themselves should never automatically cause those sites to be
  used.</p>

  <p><strong>Registration spamming.</strong> User agents should consider the possibility that a site
  will attempt to register a large number of handlers, possibly from multiple domains (e.g. by
  redirecting through a series of pages each on a different domain, and each registering a handler
  for <code id="security-and-privacy:video/mpeg"><a href="#video/mpeg">video/mpeg</a></code>  analogous practices abusing other Web browser features have
  been used by pornography Web sites for many years). User agents should gracefully handle such
  hostile attempts, protecting the user.</p>

  <p><strong>Misleading titles.</strong> User agents should not rely wholly on the <var>title</var>
  argument to the methods when presenting the registered handlers to the user, since sites could
  easily lie. For example, a site <code>hostile.example.net</code> could claim that it was
  registering the "Cuddly Bear Happy Content Handler". User agents should therefore use the
  handler's domain in any UI along with any title.</p>

  <p><strong>Hostile handler metadata.</strong> User agents should protect against typical attacks
  against strings embedded in their interface, for example ensuring that markup or escape characters
  in such strings are not executed, that null bytes are properly handled, that over-long strings do
  not cause crashes or buffer overruns, and so forth.</p>

  <p><strong>Leaking Intranet URLs.</strong> The mechanism described in this section can result in
  secret Intranet URLs being leaked, in the following manner:</p>

  <ol><li>The user registers a third-party content handler as the default handler for a content
   type.</li><li>The user then browses his corporate Intranet site and accesses a document that uses that
   content type.</li><li>The user agent contacts the third party and hands the third party the URL to the Intranet
   content.</li></ol>

  <p>No actual confidential file data is leaked in this manner, but the URLs themselves could
  contain confidential information. For example, the URL could be <code>http://www.corp.example.com/upcoming-aquisitions/the-sample-company.egf</code>, which
  might tell the third party that Example Corporation is intending to merge with The Sample Company.
  Implementors might wish to consider allowing administrators to disable this feature for certain
  subdomains, content types, or schemes.</p>

  <p><strong>Leaking secure URLs.</strong> User agents should not send HTTPS URLs to third-party
  sites registered as content handlers without the user's informed consent, for the same reason that
  user agents sometimes avoid sending <code id="security-and-privacy:http-referer"><a href="/breakup/specs/core-algorithms/#http-referer">Referer</a></code> (sic) HTTP headers
  from secure sites to third-party sites.</p>

  <p><strong>Leaking credentials.</strong> User agents must never send username or password
  information in the URLs that are escaped and included sent to the handler sites. User agents may
  even avoid attempting to pass to Web-based handlers the URLs of resources that are known to
  require authentication to access, as such sites would be unable to access the resources in
  question without prompting the user for credentials themselves (a practice that would require the
  user to know whether to trust the third-party handler, a decision many users are unable to make or
  even understand).</p>

  <p><strong>Interface interference.</strong> User agents should be prepared to handle intentionally
  long arguments to the methods. For example, if the user interface exposed consists of an "accept"
  button and a "deny" button, with the "accept" binding containing the name of the handler, it's
  important that a long name not cause the "deny" button to be pushed off the screen.</p>

  <p><strong>Fingerprinting users.</strong> Since a site can detect if it has attempted to register
  a particular handler or not, whether or not the user responds, the mechanism can be used to store
  data. User agents are therefore strongly urged to treat registrations in the same manner as
  cookies: clearing cookies for a site should also clear all registrations for that site, and
  disabling cookies for a site should also disable registrations.</p></section>

  



  

  <section><h6 id="sample-handler-impl">7.6.1.3.2 Sample user interface</h6>

  <p><i>This section is non-normative.</i></p>

  <p>A simple implementation of this feature for a desktop Web browser might work as follows.</p>

  <p>The <code id="sample-handler-impl:dom-navigator-registercontenthandler"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code> method
  could display a modal dialog box:</p>

  <p><img src="img/sample-content-handler-registration.png" width="534" alt="The modal dialog box could have the title 'Content Handler Registration', and could say 'This Web page: Kittens at work http://kittens.example.org/ ...would like permission to handle files of type: application/x-meowmeow using the following Web-based application: Kittens-at-work displayer http://kittens.example.org/?show=%s Do you trust the administrators of the &quot;kittens.example.org&quot; domain?' with two buttons, 'Trust kittens.example.org' and 'Cancel'." height="374"></p>

  <p>In this dialog box, "Kittens at work" is the title of the page that invoked the method,
  "http://kittens.example.org/" is the URL of that page, "application/x-meowmeow" is the string that
  was passed to the <code id="sample-handler-impl:dom-navigator-registercontenthandler-2"><a href="/breakup/specs/browser-dom/#dom-navigator-registercontenthandler">registerContentHandler()</a></code> method as its first
  argument (<var>mimeType</var>), "http://kittens.example.org/?show=%s" was the second
  argument (<var>url</var>), and "Kittens-at-work displayer" was the third argument (<var>title</var>).</p>

  <p>If the user clicks the Cancel button, then nothing further happens. If the user clicks the
  "Trust" button, then the handler is remembered.</p>

  <p>When the user then attempts to fetch a URL that uses the "application/x-meowmeow" <a href="/breakup/specs/core-algorithms/#mime-type" id="sample-handler-impl:mime-type">MIME
  type</a>, then it might display a dialog as follows:</p>

  <p><img src="img/sample-content-handler.png" width="577" alt="The dialog box could have the title 'Unknown File Type' and could say 'You have attempted to access:' followed by a URL, followed by a prompt such as 'How would you like FerretBrowser to handle this resource?' with three radio buttons, one saying 'Contact the FerretBrowser plugin registry to see if there is an official way to handle this resource.', one saying 'Pass this URL to a local application' with an application selector, and one saying 'Pass this URL to the &quot;Kittens-at-work displayer&quot; application at &quot;kittens.example.org&quot;', with a checkbox labeled 'Always do this for resources using the &quot;application/x-meowmeow&quot; type in future.', and with two buttons, 'Ok' and 'Cancel'." height="428"></p>

  <p>In this dialog, the third option is the one that was primed by the site registering itself
  earlier.</p>

  <p>If the user does select that option, then the browser, in accordance with the requirements
  described in the previous two sections, will redirect the user to
  "http://kittens.example.org/?show=data%3Aapplication/x-meowmeow;base64,S2l0dGVucyBhcmUgdGhlIGN1dGVzdCE%253D".</p>

  <p>The <code id="sample-handler-impl:dom-navigator-registerprotocolhandler"><a href="/breakup/specs/browser-dom/#dom-navigator-registerprotocolhandler">registerProtocolHandler()</a></code> method
  would work equivalently, but for schemes instead of unknown content types.</p></section></section>

  



  <section><h5 id="manually-releasing-the-storage-mutex">7.6.1.4 Manually releasing the storage mutex</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorstorageutils">NavigatorStorageUtils</dfn> {
  readonly attribute boolean <a href="/breakup/specs/browser-dom/#dom-navigator-cookieenabled" id="manually-releasing-the-storage-mutex:dom-navigator-cookieenabled">cookieEnabled</a>;
  void <a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates" id="manually-releasing-the-storage-mutex:dom-navigator-yieldforstorageupdates">yieldForStorageUpdates</a>();
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="manually-releasing-the-storage-mutex:dom-navigator"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="manually-releasing-the-storage-mutex:dom-navigator-cookieenabled-2"><a href="/breakup/specs/browser-dom/#dom-navigator-cookieenabled">cookieEnabled</a></code></dt><dd>

    <p>Returns false if setting a cookie will be ignored, and true otherwise.</p>

   </dd><dt><var>window</var> . <code id="manually-releasing-the-storage-mutex:dom-navigator-2"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="manually-releasing-the-storage-mutex:dom-navigator-yieldforstorageupdates-2"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">yieldForStorageUpdates</a></code>()</dt><dd>

    <p>If a script uses the <code id="manually-releasing-the-storage-mutex:dom-document-cookie"><a href="/breakup/specs/browser-dom/#dom-document-cookie">document.cookie</a></code> API, or the
    <code id="manually-releasing-the-storage-mutex:dom-localstorage"><a href="http://www.w3.org/TR/webstorage/#dom-localstorage">localStorage</a></code> API, the browser will block other scripts
    from accessing cookies or storage until the first script finishes.</p>

    <p>Calling the <code id="manually-releasing-the-storage-mutex:dom-navigator-yieldforstorageupdates-3"><a href="/breakup/specs/browser-dom/#dom-navigator-yieldforstorageupdates">navigator.yieldForStorageUpdates()</a></code> method
    tells the user agent to unblock any other scripts that may be blocked, even though the script
    hasn't returned.</p>

    <p>Values of cookies and items in the <code id="manually-releasing-the-storage-mutex:storage-2"><a href="http://www.w3.org/TR/webstorage/#storage-2">Storage</a></code> objects of <code id="manually-releasing-the-storage-mutex:dom-localstorage-2"><a href="http://www.w3.org/TR/webstorage/#dom-localstorage">localStorage</a></code> attributes can change after calling this method,
    whence its name.</p>

   </dd></dl>

  

   <p>The <dfn id="dom-navigator-cookieenabled"><code>cookieEnabled</code></dfn> attribute must
   return true if the user agent attempts to handle cookies according to the cookie specification,
   and false if it ignores cookie change requests. <a href="#refsCOOKIES">[COOKIES]</a></p>

   <p>The <dfn id="dom-navigator-yieldforstorageupdates"><code>yieldForStorageUpdates()</code></dfn> method,
   when invoked, must, if the <a href="/breakup/specs/browser-dom/#storage-mutex" id="manually-releasing-the-storage-mutex:storage-mutex">storage mutex</a> is owned by the <a href="/breakup/specs/browser-dom/#event-loop" id="manually-releasing-the-storage-mutex:event-loop">event loop</a> of
   the <a href="/breakup/specs/browser-dom/#concept-task" id="manually-releasing-the-storage-mutex:concept-task">task</a> that resulted in the method being called, release the
   <a href="/breakup/specs/browser-dom/#storage-mutex" id="manually-releasing-the-storage-mutex:storage-mutex-2">storage mutex</a> so that it is once again free. Otherwise, it must do nothing.</p></section>

  



  <section><h5 id="plugins-2">7.6.1.5 Plugins</h5>

  <pre class="idl">[NoInterfaceObject]
interface <dfn id="navigatorplugins">NavigatorPlugins</dfn> {
  [SameObject] readonly attribute <a href="/breakup/specs/browser-dom/#pluginarray" id="plugins-2:pluginarray">PluginArray</a> <a href="/breakup/specs/browser-dom/#dom-navigator-plugins" id="plugins-2:dom-navigator-plugins">plugins</a>;
  [SameObject] readonly attribute <a href="/breakup/specs/browser-dom/#mimetypearray" id="plugins-2:mimetypearray">MimeTypeArray</a> <a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes" id="plugins-2:dom-navigator-mimetypes">mimeTypes</a>;
  readonly attribute boolean <a href="/breakup/specs/browser-dom/#dom-navigator-javaenabled" id="plugins-2:dom-navigator-javaenabled">javaEnabled</a>;
};

interface <dfn id="pluginarray">PluginArray</dfn> {
  void <a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh" id="plugins-2:dom-pluginarray-refresh">refresh</a>(optional boolean reload = false);
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-pluginarray-length" id="plugins-2:dom-pluginarray-length">length</a>;
  getter <a href="/breakup/specs/browser-dom/#dom-plugin" id="plugins-2:dom-plugin">Plugin</a>? <a href="/breakup/specs/browser-dom/#dom-pluginarray-item" id="plugins-2:dom-pluginarray-item">item</a>(unsigned long index);
  getter <a href="/breakup/specs/browser-dom/#dom-plugin" id="plugins-2:dom-plugin-2">Plugin</a>? <a href="/breakup/specs/browser-dom/#dom-pluginarray-nameditem" id="plugins-2:dom-pluginarray-nameditem">namedItem</a>(DOMString name);
};

interface <dfn id="mimetypearray">MimeTypeArray</dfn> {
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-mimetypearray-length" id="plugins-2:dom-mimetypearray-length">length</a>;
  getter <a href="/breakup/specs/browser-dom/#mimetype" id="plugins-2:mimetype">MimeType</a>? <a href="/breakup/specs/browser-dom/#dom-mimetypearray-item" id="plugins-2:dom-mimetypearray-item">item</a>(unsigned long index);
  getter <a href="/breakup/specs/browser-dom/#mimetype" id="plugins-2:mimetype-2">MimeType</a>? <a href="/breakup/specs/browser-dom/#dom-mimetypearray-nameditem" id="plugins-2:dom-mimetypearray-nameditem">namedItem</a>(DOMString name);
};

interface <dfn id="dom-plugin">Plugin</dfn> {
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-plugin-name" id="plugins-2:dom-plugin-name">name</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-plugin-description" id="plugins-2:dom-plugin-description">description</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-plugin-filename" id="plugins-2:dom-plugin-filename">filename</a>;
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-plugin-length" id="plugins-2:dom-plugin-length">length</a>;
  getter <a href="/breakup/specs/browser-dom/#mimetype" id="plugins-2:mimetype-3">MimeType</a>? <a href="/breakup/specs/browser-dom/#dom-plugin-item" id="plugins-2:dom-plugin-item">item</a>(unsigned long index);
  getter <a href="/breakup/specs/browser-dom/#mimetype" id="plugins-2:mimetype-4">MimeType</a>? <a href="/breakup/specs/browser-dom/#dom-plugin-nameditem" id="plugins-2:dom-plugin-nameditem">namedItem</a>(DOMString name);
};

interface <dfn id="mimetype">MimeType</dfn> {
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-mimetype-type" id="plugins-2:dom-mimetype-type">type</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-mimetype-description" id="plugins-2:dom-mimetype-description">description</a>;
  readonly attribute DOMString <a href="/breakup/specs/browser-dom/#dom-mimetype-suffixes" id="plugins-2:dom-mimetype-suffixes">suffixes</a>; // comma-separated
  readonly attribute <a href="/breakup/specs/browser-dom/#dom-plugin" id="plugins-2:dom-plugin-3">Plugin</a> <a href="/breakup/specs/browser-dom/#dom-mimetype-enabledplugin" id="plugins-2:dom-mimetype-enabledplugin">enabledPlugin</a>;
};</pre>

  <dl class="domintro"><dt><var>window</var> . <code id="plugins-2:dom-navigator"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-2"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code> . <code id="plugins-2:dom-pluginarray-refresh-2"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh</a></code>( [ <var>refresh</var> ] )</dt><dd>
    <p>Updates the lists of supported plugins and MIME types for this page, and reloads the page if the lists have changed.</p>
    
   </dd><dt><var>window</var> . <code id="plugins-2:dom-navigator-2"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-3"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code> . <code id="plugins-2:dom-pluginarray-length-2"><a href="/breakup/specs/browser-dom/#dom-pluginarray-length">length</a></code></dt><dd>
    <p>Returns the number of plugins, represented by <code id="plugins-2:dom-plugin-4"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> objects, that the user agent reports.</p>
   </dd><dt><var>plugin</var> = <var>window</var> . <code id="plugins-2:dom-navigator-3"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-4"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code> . <code id="plugins-2:dom-pluginarray-item-2"><a href="/breakup/specs/browser-dom/#dom-pluginarray-item">item</a></code>(<var>index</var>)</dt><dt><var>window</var> . <code id="plugins-2:dom-navigator-4"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-5"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code>[<var>index</var>]</dt><dd>
    <p>Returns the specified <code id="plugins-2:dom-plugin-5"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object.</p>
   </dd><dt><var>plugin</var> = <var>window</var> . <code id="plugins-2:dom-navigator-5"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-6"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code> . <code id="plugins-2:dom-pluginarray-item-3"><a href="/breakup/specs/browser-dom/#dom-pluginarray-item">item</a></code>(<var>name</var>)</dt><dt><var>window</var> . <code id="plugins-2:dom-navigator-6"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-plugins-7"><a href="/breakup/specs/browser-dom/#dom-navigator-plugins">plugins</a></code>[<var>name</var>]</dt><dd>
    <p>Returns the <code id="plugins-2:dom-plugin-6"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object for the plugin with the given name.</p>
   </dd><dt><var>window</var> . <code id="plugins-2:dom-navigator-7"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-mimetypes-2"><a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes">mimeTypes</a></code> . <code id="plugins-2:dom-mimetypearray-length-2"><a href="/breakup/specs/browser-dom/#dom-mimetypearray-length">length</a></code></dt><dd>
    <p>Returns the number of MIME types, represented by <code id="plugins-2:mimetype-5"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects, supported by the plugins that the user agent reports.</p>
   </dd><dt><var>mimeType</var> = <var>window</var> . <code id="plugins-2:dom-navigator-8"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-mimetypes-3"><a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes">mimeTypes</a></code> . <code id="plugins-2:dom-mimetypearray-item-2"><a href="/breakup/specs/browser-dom/#dom-mimetypearray-item">item</a></code>(<var>index</var>)</dt><dt><var>window</var> . <code id="plugins-2:dom-navigator-9"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-mimetypes-4"><a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes">mimeTypes</a></code>[<var>index</var>]</dt><dd>
    <p>Returns the specified <code id="plugins-2:mimetype-6"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object.</p>
   </dd><dt><var>mimeType</var> = <var>window</var> . <code id="plugins-2:dom-navigator-10"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-mimetypes-5"><a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes">mimeTypes</a></code> . <code id="plugins-2:dom-mimetypearray-item-3"><a href="/breakup/specs/browser-dom/#dom-mimetypearray-item">item</a></code>(<var>name</var>)</dt><dt><var>window</var> . <code id="plugins-2:dom-navigator-11"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-mimetypes-6"><a href="/breakup/specs/browser-dom/#dom-navigator-mimetypes">mimeTypes</a></code>[<var>name</var>]</dt><dd>
    <p>Returns the <code id="plugins-2:mimetype-7"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object for the given MIME type.</p>
   </dd><dt><var>plugin</var> . <code id="plugins-2:dom-plugin-name-2"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code>
   </dt><dd>
    <p>Returns the plugin's name.</p>
   </dd><dt><var>plugin</var> . <code id="plugins-2:dom-plugin-description-2"><a href="/breakup/specs/browser-dom/#dom-plugin-description">description</a></code>
   </dt><dd>
    <p>Returns the plugin's description.</p>
   </dd><dt><var>plugin</var> . <code id="plugins-2:dom-plugin-filename-2"><a href="/breakup/specs/browser-dom/#dom-plugin-filename">filename</a></code>
   </dt><dd>
    <p>Returns the plugin library's filename, if applicable on the current platform.</p>
   </dd><dt><var>plugin</var> . <code id="plugins-2:dom-plugin-length-2"><a href="/breakup/specs/browser-dom/#dom-plugin-length">length</a></code></dt><dd>
    <p>Returns the number of MIME types, represented by <code id="plugins-2:mimetype-8"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects, supported by the plugin.</p>
   </dd><dt><var>mimeType</var> = <var>plugin</var> . <code id="plugins-2:dom-plugin-item-2"><a href="/breakup/specs/browser-dom/#dom-plugin-item">item</a></code>(<var>index</var>)</dt><dt><var>plugin</var>[<var>index</var>]</dt><dd>
    <p>Returns the specified <code id="plugins-2:mimetype-9"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object.</p>
   </dd><dt><var>mimeType</var> = <var>plugin</var> . <code id="plugins-2:dom-plugin-item-3"><a href="/breakup/specs/browser-dom/#dom-plugin-item">item</a></code>(<var>name</var>)</dt><dt><var>plugin</var>[<var>name</var>]</dt><dd>
    <p>Returns the <code id="plugins-2:mimetype-10"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object for the given MIME type.</p>
   </dd><dt><var>mimeType</var> . <code id="plugins-2:dom-mimetype-type-2"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code>
   </dt><dd>
    <p>Returns the MIME type.</p>
   </dd><dt><var>mimeType</var> . <code id="plugins-2:dom-mimetype-description-2"><a href="/breakup/specs/browser-dom/#dom-mimetype-description">description</a></code>
   </dt><dd>
    <p>Returns the MIME type's description.</p>
   </dd><dt><var>mimeType</var> . <code id="plugins-2:dom-mimetype-suffixes-2"><a href="/breakup/specs/browser-dom/#dom-mimetype-suffixes">suffixes</a></code>
   </dt><dd>
    <p>Returns the MIME type's typical file extensions, in a comma-separated list.</p>
   </dd><dt><var>mimeType</var> . <code id="plugins-2:dom-mimetype-enabledplugin-2"><a href="/breakup/specs/browser-dom/#dom-mimetype-enabledplugin">enabledPlugin</a></code>
   </dt><dd>
    <p>Returns the <code id="plugins-2:dom-plugin-7"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object that implements this MIME type.</p>
   </dd><dt><var>window</var> . <code id="plugins-2:dom-navigator-12"><a href="/breakup/specs/browser-dom/#dom-navigator">navigator</a></code> . <code id="plugins-2:dom-navigator-javaenabled-2"><a href="/breakup/specs/browser-dom/#dom-navigator-javaenabled">javaEnabled</a></code></dt><dd>
    <p>Returns true if there's a plugin that supports the MIME type "<code>application/x-java-vm</code>".</p>
   </dd></dl>

  

  <p>The <dfn id="dom-navigator-plugins"><code>navigator.plugins</code></dfn> attribute must
  return a <code id="plugins-2:pluginarray-2"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object.</p>

  <p>The <dfn id="dom-navigator-mimetypes"><code>navigator.mimeTypes</code></dfn> attribute must
  return a <code id="plugins-2:mimetypearray-2"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object.</p>

  <hr>

  <p>A <code id="plugins-2:pluginarray-3"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object represents none, some, or all of the <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin">plugins</a> supported by the user agent, each of which is represented by a <code id="plugins-2:dom-plugin-8"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object. Each of these <code id="plugins-2:dom-plugin-9"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code>
  objects may be <dfn id="hidden-plugin">hidden plugins</dfn>. A <a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin">hidden plugin</a> can't
  be enumerated, but can still be inspected by using its name.</p>

  <p class="note">The fewer <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-2">plugins</a> are represented by the
  <code id="plugins-2:pluginarray-4"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object, and of those, the more that are <a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-2">hidden</a>, the more the user's privacy will be protected. Each exposed plugin
  increases the number of bits that can be derived for fingerprinting. Hiding a plugin helps, but
  unless it is an extremely rare plugin, it is likely that a site attempting to derive the list of
  plugins can still determine whether the plugin is supported or not by probing for it by name (the
  names of popular plugins are widely known). Therefore not exposing a plugin at all is preferred.
  Unfortunately, many legacy sites use this feature to determine, for example, which plugin to use
  to play video. Not exposing any plugins at all might therefore not be entirely plausible.</p>

  <p>The <code id="plugins-2:pluginarray-5"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> objects created by a user agent must not be <a href="/breakup/specs/core-algorithms/#live" id="plugins-2:live">live</a>. The
  set of plugins represented by the objects must not change once an object is created, except when
  it is updated by the <code id="plugins-2:dom-pluginarray-refresh-3"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh()</a></code> method.</p>

  <p>Each <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-3">plugin</a> represented by a <code id="plugins-2:pluginarray-6"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> can support a number of
  <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type">MIME types</a>. For each such <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-4">plugin</a>, the user agent must
  pick one or more of these <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-2">MIME types</a> to be those that are
  <dfn id="explicitly-supported">explicitly supported</dfn>.</p>

  <p class="note">The <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported">explicitly supported</a> <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-3">MIME types</a> of
  a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-5">plugin</a> are those that are exposed through the <code id="plugins-2:dom-plugin-10"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> and <code id="plugins-2:mimetypearray-3"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> interfaces. As with <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-6">plugins</a> themselves, any variation between users regarding what is exposed
  allows sites to fingerprint users. User agents are therefore encouraged to expose the same <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-4">MIME types</a> for all users of a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-7">plugin</a>, regardless of the
  actual types supported... at least, within the constraints imposed by compatibility with legacy
  content.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices">supported property indices</a> of a <code id="plugins-2:pluginarray-7"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object are the
  numbers from zero to the number of non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-3">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-8">plugins</a> represented by the object, if any.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-pluginarray-length"><code>length</code></dfn> attribute must return the
  number of non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-4">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-9">plugins</a>
  represented by the object.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-2" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-pluginarray-item"><code>item()</code></dfn> method of a
  <code id="plugins-2:pluginarray-8"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object must return null if the argument is not one of the object's
  <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices-2">supported property indices</a>, and otherwise must return the result of running the
  following steps, using the method's argument as <var>index</var>:</p>

  <ol><li><p>Let <var>list</var> be the <code id="plugins-2:dom-plugin-11"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> objects
   representing the non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-5">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-10">plugins</a> represented by the <code id="plugins-2:pluginarray-9"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object.</p></li><li><p>Sort <var>list</var> alphabetically by the <code id="plugins-2:dom-plugin-name-3"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code> of each <code id="plugins-2:dom-plugin-12"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code>.</p></li><li><p>Return the <var>index</var>th entry in <var>list</var>.</p></li></ol>

  <p class="note">It is important <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-3" class="no-backref">for
  privacy</a> that the order of plugins not leak additional information, e.g. the order in which
  plugins were installed.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names">supported property names</a> of a <code id="plugins-2:pluginarray-10"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object are the values
  of the <code id="plugins-2:dom-plugin-name-4"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code> attributes of all the <code id="plugins-2:dom-plugin-13"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> objects represented by the <code id="plugins-2:pluginarray-11"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object. The
  properties exposed in this way must be <a href="/breakup/specs/core-algorithms/#unenumerable" id="plugins-2:unenumerable">unenumerable</a>.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-4" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-pluginarray-nameditem"><code>namedItem()</code></dfn> method of a
  <code id="plugins-2:pluginarray-12"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object must return null if the argument is not one of the object's
  <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names-2">supported property names</a>, and otherwise must return the <code id="plugins-2:dom-plugin-14"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object, of those represented by the <code id="plugins-2:pluginarray-13"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code>
  object, that has a <code id="plugins-2:dom-plugin-name-5"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code> equal to the method's argument.</p>

  <p>The <dfn id="dom-pluginarray-refresh"><code>refresh()</code></dfn> method of the
  <code id="plugins-2:pluginarray-14"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object of a <code id="plugins-2:navigator"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code> object, when invoked, must check to
  see if any <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-11">plugins</a> have been installed or reconfigured since the user
  agent created the <code id="plugins-2:pluginarray-15"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object. If so, and the method's argument is true, then
  the user agent must act as if the <code id="plugins-2:dom-location-reload"><a href="/breakup/specs/browser-dom/#dom-location-reload">location.reload()</a></code>
  method was called instead. Otherwise, the user agent must update the <code id="plugins-2:pluginarray-16"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code>
  object and <code id="plugins-2:mimetypearray-4"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object created for attributes of that <code id="plugins-2:navigator-2"><a href="/breakup/specs/browser-dom/#navigator">Navigator</a></code>
  object, and the <code id="plugins-2:dom-plugin-15"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> and <code id="plugins-2:mimetype-11"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects created
  for those <code id="plugins-2:pluginarray-17"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> and <code id="plugins-2:mimetypearray-5"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> objects, using the same <code id="plugins-2:dom-plugin-16"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> objects for cases where the <code id="plugins-2:dom-plugin-name-6"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code> is the same, and the same <code id="plugins-2:mimetype-12"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects for
  cases where the <code id="plugins-2:dom-mimetype-type-3"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> is the same, and creating new objects
  for cases where there were no matching objects immediately prior to the <code id="plugins-2:dom-pluginarray-refresh-4"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh()</a></code> call. Old <code id="plugins-2:dom-plugin-17"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code>
  and <code id="plugins-2:mimetype-13"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects must continue to return the same values that they had prior to
  the update, though naturally now the data is stale and may appear inconsistent (for example, an
  old <code id="plugins-2:mimetype-14"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> entry might list as its <code id="plugins-2:dom-mimetype-enabledplugin-3"><a href="/breakup/specs/browser-dom/#dom-mimetype-enabledplugin">enabledPlugin</a></code> a <code id="plugins-2:dom-plugin-18"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code>
  object that no longer lists that <code id="plugins-2:mimetype-15"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> as a supported <code id="plugins-2:mimetype-16"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code>).</p>

  <hr>

  <p>A <code id="plugins-2:mimetypearray-6"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object represents the <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-5">MIME types</a>
  <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-2">explicitly supported</a> by <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-12">plugins</a> supported by the user
  agent, each of which is represented by a <code id="plugins-2:mimetype-17"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object.</p>

  <p>The <code id="plugins-2:mimetypearray-7"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> objects created by a user agent must not be <a href="/breakup/specs/core-algorithms/#live" id="plugins-2:live-2">live</a>.
  The set of MIME types represented by the objects must not change once an object is created, except
  when it is updated by the <code id="plugins-2:pluginarray-18"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object's <code id="plugins-2:dom-pluginarray-refresh-5"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh()</a></code> method.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices-3">supported property indices</a> of a <code id="plugins-2:mimetypearray-8"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object are the
  numbers from zero to the number of <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-6">MIME types</a> <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-3">explicitly
  supported</a> by non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-6">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-13">plugins</a> represented by the corresponding <code id="plugins-2:pluginarray-19"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object, if
  any.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-5" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-mimetypearray-length"><code>length</code></dfn> attribute must return the
  number of <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-7">MIME types</a> <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-4">explicitly supported</a> by non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-7">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-14">plugins</a> represented by the
  corresponding <code id="plugins-2:pluginarray-20"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object, if any.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-6" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-mimetypearray-item"><code>item()</code></dfn> method of a
  <code id="plugins-2:mimetypearray-9"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object must return null if the argument is not one of the object's
  <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices-4">supported property indices</a>, and otherwise must return the result of running the
  following steps, using the method's argument as <var>index</var>:</p>

  <ol><li><p>Let <var>list</var> be the <code id="plugins-2:mimetype-18"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects representing the <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-8">MIME types</a> <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-5">explicitly supported</a> by non-<a href="/breakup/specs/browser-dom/#hidden-plugin" id="plugins-2:hidden-plugin-8">hidden</a> <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-15">plugins</a> represented by the corresponding
   <code id="plugins-2:pluginarray-21"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object, if any.</p></li><li><p>Sort <var>list</var> alphabetically by the <code id="plugins-2:dom-mimetype-type-4"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> of each <code id="plugins-2:mimetype-19"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code>.</p></li><li><p>Return the <var>index</var>th entry in <var>list</var>.</p></li></ol>

  <p class="note">It is important <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-7" class="no-backref">for
  privacy</a> that the order of MIME types not leak additional information, e.g. the order in
  which plugins were installed.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names-3">supported property names</a> of a <code id="plugins-2:mimetypearray-10"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object are the values
  of the <code id="plugins-2:dom-mimetype-type-5"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> attributes of all the <code id="plugins-2:mimetype-20"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code>
  objects represented by the <code id="plugins-2:mimetypearray-11"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object. The properties exposed in this way
  must be <a href="/breakup/specs/core-algorithms/#unenumerable" id="plugins-2:unenumerable-2">unenumerable</a>.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-8" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-mimetypearray-nameditem"><code>namedItem()</code></dfn> method of a
  <code id="plugins-2:mimetypearray-12"><a href="/breakup/specs/browser-dom/#mimetypearray">MimeTypeArray</a></code> object must return null if the argument is not one of the object's
  <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names-4">supported property names</a>, and otherwise must return the <code id="plugins-2:mimetype-21"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object
  that has a <code id="plugins-2:dom-mimetype-type-6"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> equal to the method's argument.</p>

  <hr>

  <p>A <code id="plugins-2:dom-plugin-19"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object represents a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-16">plugin</a>. It has
  several attributes to provide details about the plugin, and can be enumerated to obtain the list
  of <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-9">MIME types</a> that it <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-6">explicitly
  supports</a>.</p>

  <p>The <code id="plugins-2:dom-plugin-20"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> objects created by a user agent must not be
  <a href="/breakup/specs/core-algorithms/#live" id="plugins-2:live-3">live</a>. The set of MIME types represented by the objects, and the values of the
  objects' attributes, must not change once an object is created, except when updated by the
  <code id="plugins-2:pluginarray-22"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object's <code id="plugins-2:dom-pluginarray-refresh-6"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh()</a></code>
  method.</p>

  <p>The <dfn id="reported-mime-types">reported MIME types</dfn> for a <code id="plugins-2:dom-plugin-21"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object are the
  <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-10">MIME types</a> <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-7">explicitly supported</a> by the corresponding
  <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-17">plugin</a> when this object was last created or updated by <code id="plugins-2:dom-pluginarray-refresh-7"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">PluginArray.refresh()</a></code>, whichever happened most
  recently.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices-5">supported property indices</a> of a <code id="plugins-2:dom-plugin-22"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object
  are the numbers from zero to the number of <a href="/breakup/specs/browser-dom/#reported-mime-types" id="plugins-2:reported-mime-types">reported MIME types</a>.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-9" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-plugin-length"><code>length</code></dfn> attribute must return the number
  of <a href="/breakup/specs/browser-dom/#reported-mime-types" id="plugins-2:reported-mime-types-2">reported MIME types</a>.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-10" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-plugin-item"><code>item()</code></dfn> method of a <code id="plugins-2:dom-plugin-23"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object must return null if the argument is not one of the
  object's <a href="/breakup/specs/core-algorithms/#supported-property-indices" id="plugins-2:supported-property-indices-6">supported property indices</a>, and otherwise must return the result of running
  the following steps, using the method's argument as <var>index</var>:</p>

  <ol><li><p>Let <var>list</var> be the <code id="plugins-2:mimetype-22"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects representing the
   <a href="/breakup/specs/browser-dom/#reported-mime-types" id="plugins-2:reported-mime-types-3">reported MIME types</a>.</p></li><li><p>Sort <var>list</var> alphabetically by the <code id="plugins-2:dom-mimetype-type-7"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> of each <code id="plugins-2:mimetype-23"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code>.</p></li><li><p>Return the <var>index</var>th entry in <var>list</var>.</p></li></ol>

  <p class="note">It is important <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-11" class="no-backref">for
  privacy</a> that the order of MIME types not leak additional information, e.g. the order in
  which plugins were installed.</p>

  <p>The <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names-5">supported property names</a> of a <code id="plugins-2:dom-plugin-24"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object
  are the values of the <code id="plugins-2:dom-mimetype-type-8"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> attributes of the
  <code id="plugins-2:mimetype-24"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects representing the <a href="/breakup/specs/browser-dom/#reported-mime-types" id="plugins-2:reported-mime-types-4">reported MIME types</a>. The properties
  exposed in this way must be <a href="/breakup/specs/core-algorithms/#unenumerable" id="plugins-2:unenumerable-3">unenumerable</a>.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-12" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p>The <dfn id="dom-plugin-nameditem"><code>namedItem()</code></dfn> method of a <code id="plugins-2:dom-plugin-25"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object must return null if the argument is not one of the
  object's <a href="/breakup/specs/core-algorithms/#supported-property-names" id="plugins-2:supported-property-names-6">supported property names</a>, and otherwise must return the
  <code id="plugins-2:mimetype-25"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object that has a <code id="plugins-2:dom-mimetype-type-9"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> equal to the
  method's argument.</p>

  <p>The <dfn id="dom-plugin-name"><code>name</code></dfn> attribute must return the
  <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-18">plugin</a>'s name.</p>

  <p>The <dfn id="dom-plugin-description"><code>description</code></dfn> and <dfn id="dom-plugin-filename"><code>filename</code></dfn> attributes must return user-agent-defined
  (or, in all likelihood, <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-19">plugin</a>-defined) strings. In each case, the same string must
  be returned each time, except that the strings returned may change when the <code id="plugins-2:dom-pluginarray-refresh-8"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">PluginArray.refresh()</a></code> method updates the object.</p>

  <p class="warning">If the values returned by the <code id="plugins-2:dom-plugin-description-3"><a href="/breakup/specs/browser-dom/#dom-plugin-description">description</a></code> or <code id="plugins-2:dom-plugin-filename-3"><a href="/breakup/specs/browser-dom/#dom-plugin-filename">filename</a></code> attributes vary between versions of a
  <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-20">plugin</a>, they can be used both as a fingerprinting vector and, even more importantly,
  as a trivial way to determine what security vulnerabilities a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-21">plugin</a> (and thus a
  browser) may have. It is thus highly recommended that the <code id="plugins-2:dom-plugin-description-4"><a href="/breakup/specs/browser-dom/#dom-plugin-description">description</a></code> attribute just return the same value as the
  <code id="plugins-2:dom-plugin-name-7"><a href="/breakup/specs/browser-dom/#dom-plugin-name">name</a></code> attribute, and that the <code id="plugins-2:dom-plugin-filename-4"><a href="/breakup/specs/browser-dom/#dom-plugin-filename">filename</a></code> attribute return the empty string.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-13" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <hr>

  <p>A <code id="plugins-2:mimetype-26"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> object represents a <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-11">MIME type</a> that is, or was,
  <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-8">explicitly supported</a> by a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-22">plugin</a>.</p>

  <p>The <code id="plugins-2:mimetype-27"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code> objects created by a user agent must not be <a href="/breakup/specs/core-algorithms/#live" id="plugins-2:live-4">live</a>. The
  values of the objects' attributes must not change once an object is created, except when updated
  by the <code id="plugins-2:pluginarray-23"><a href="/breakup/specs/browser-dom/#pluginarray">PluginArray</a></code> object's <code id="plugins-2:dom-pluginarray-refresh-9"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">refresh()</a></code>
  method.</p>

  <p>The <dfn id="dom-mimetype-type"><code>type</code></dfn> attribute must return the
  <a href="/breakup/specs/core-algorithms/#valid-mime-type-with-no-parameters" id="plugins-2:valid-mime-type-with-no-parameters">valid MIME type with no parameters</a> describing the <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-12">MIME type</a>.</p>

  <p>The <dfn id="dom-mimetype-description"><code>description</code></dfn> and <dfn id="dom-mimetype-suffixes"><code>suffixes</code></dfn> attributes must return
  user-agent-defined (or, in all likelihood, <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-23">plugin</a>-defined) strings. In each case, the
  same string must be returned each time, except that the strings returned may change when the <code id="plugins-2:dom-pluginarray-refresh-10"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">PluginArray.refresh()</a></code> method updates the object.</p>

  <p class="warning">If the values returned by the <code id="plugins-2:dom-mimetype-description-3"><a href="/breakup/specs/browser-dom/#dom-mimetype-description">description</a></code> or <code id="plugins-2:dom-mimetype-suffixes-3"><a href="/breakup/specs/browser-dom/#dom-mimetype-suffixes">suffxies</a></code> attributes vary between versions of a
  <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-24">plugin</a>, they can be used both as a fingerprinting vector and, even more importantly,
  as a trivial way to determine what security vulnerabilities a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-25">plugin</a> (and thus a
  browser) may have. It is thus highly recommended that the <code id="plugins-2:dom-mimetype-description-4"><a href="/breakup/specs/browser-dom/#dom-mimetype-description">description</a></code> attribute just return the same value as the
  <code id="plugins-2:dom-mimetype-type-10"><a href="/breakup/specs/browser-dom/#dom-mimetype-type">type</a></code> attribute, and that the <code id="plugins-2:dom-mimetype-suffixes-4"><a href="/breakup/specs/browser-dom/#dom-mimetype-suffixes">suffixes</a></code> attribute return the empty string.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-14" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p>

  <p class="note">Commas in the <code id="plugins-2:dom-mimetype-suffixes-5"><a href="/breakup/specs/browser-dom/#dom-mimetype-suffixes">suffixes</a></code> attribute are
  interpreted as separating subsequent filename extensions, as in "<code>htm,html</code>".</p>

  <p>The <dfn id="dom-mimetype-enabledplugin"><code>enabledPlugin</code></dfn> attribute must
  return the <code id="plugins-2:dom-plugin-26"><a href="/breakup/specs/browser-dom/#dom-plugin">Plugin</a></code> object that represents the <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-26">plugin</a>
  that <a href="/breakup/specs/browser-dom/#explicitly-supported" id="plugins-2:explicitly-supported-9">explicitly supported</a> the <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-13">MIME type</a> that this <code id="plugins-2:mimetype-28"><a href="/breakup/specs/browser-dom/#mimetype">MimeType</a></code>
  object represents when this object was last created or updated by <code id="plugins-2:dom-pluginarray-refresh-11"><a href="/breakup/specs/browser-dom/#dom-pluginarray-refresh">PluginArray.refresh()</a></code>, whichever happened most
  recently.</p>

  <hr>

  <p>The <dfn id="dom-navigator-javaenabled"><code>navigator.javaEnabled</code></dfn> attribute
  must return true if the user agent supports a <a href="/breakup/specs/core-algorithms/#plugin" id="plugins-2:plugin-27">plugin</a> that supports the <a href="/breakup/specs/core-algorithms/#mime-type" id="plugins-2:mime-type-14">MIME
  type</a> "<code>application/x-java-vm</code>"; otherwise it must return false.
  <a href="/breakup/specs/html/#fingerprinting-vector" id="plugins-2:fingerprinting-vector-15" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
  </p></section></section>

  



  <section><h4 id="the-external-interface">7.6.2 The <code id="the-external-interface:external"><a href="/breakup/specs/browser-dom/#external">External</a></code> interface</h4>

  

  <p>The <dfn id="dom-external"><code>external</code></dfn> attribute of the <code id="the-external-interface:window"><a href="/breakup/specs/browser-dom/#window">Window</a></code>
  interface must return an instance of the <code id="the-external-interface:external-2"><a href="/breakup/specs/browser-dom/#external">External</a></code> interface.</p>

  

  <pre class="idl">interface <dfn id="external">External</dfn> {
  void <a href="/breakup/specs/browser-dom/#dom-external-addsearchprovider" id="the-external-interface:dom-external-addsearchprovider">AddSearchProvider</a>(DOMString engineURL);
  unsigned long <a href="/breakup/specs/browser-dom/#dom-external-issearchproviderinstalled" id="the-external-interface:dom-external-issearchproviderinstalled">IsSearchProviderInstalled</a>(DOMString engineURL);
};</pre>

  <p class="note">For historical reasons, members on this interface are capitalized.</p>

  <dl class="domintro"><dt><var>window</var> . <code id="the-external-interface:dom-external"><a href="/breakup/specs/browser-dom/#dom-external">external</a></code> . <code id="the-external-interface:dom-external-addsearchprovider-2"><a href="/breakup/specs/browser-dom/#dom-external-addsearchprovider">AddSearchProvider</a></code>( <var>url</var> )</dt><dd>

    <p>Adds the search engine described by the OpenSearch description document at <var>url</var>. <a href="#refsOPENSEARCH">[OPENSEARCH]</a></p>

    <p>The OpenSearch description document has to be on the same server as the script that calls
    this method.</p>

   </dd><dt><var>installed</var> = <var>window</var> . <code id="the-external-interface:dom-external-2"><a href="/breakup/specs/browser-dom/#dom-external">external</a></code> . <code id="the-external-interface:dom-external-issearchproviderinstalled-2"><a href="/breakup/specs/browser-dom/#dom-external-issearchproviderinstalled">IsSearchProviderInstalled</a></code>( <var>url</var> )</dt><dd>

    <p>Returns a value based on comparing <var>url</var> to the URLs of the results pages
    of the installed search engines.</p>

    <dl><dt>0 </dt><dd>None of the installed search engines match <var>url</var>.
     </dd><dt>1 </dt><dd>One or more installed search engines match <var>url</var>, but none are the user's default search engine.
     </dd><dt>2 </dt><dd>The user's default search engine matches <var>url</var>.
    </dd></dl>

    <p>The <var>url</var> is compared to the URLs of the results pages of the installed
    search engines using a prefix match. Only results pages on the same domain as the script that
    calls this method are checked.</p>

   </dd></dl>

  <p class="note">Another way of exposing search engines using OpenSearch description documents is
  using a <code id="the-external-interface:the-link-element"><a href="#the-link-element">link</a></code> element with the <code id="the-external-interface:link-type-search"><a href="#link-type-search">search</a></code> link type.</p>

  

   <p>The <dfn id="dom-external-addsearchprovider"><code>AddSearchProvider()</code></dfn> method,
   when invoked, must run the following steps:</p>

   <ol><li><p>Optionally, abort these steps. User agents may implement the method as a stub method that
    never does anything, or may arbitrarily ignore invocations with particular arguments for
    security, privacy, or usability reasons.</p></li><li><p><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-external-interface:resolve-a-url">Resolve</a> the value of the method's first argument
    relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-external-interface:api-base-url">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-external-interface:entry-settings-object">entry settings
    object</a>.</p></li><li><p>If this fails, abort these steps.</p></li><li><p>Process the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="the-external-interface:absolute-url">absolute URL</a> as the <a href="/breakup/specs/core-algorithms/#url" id="the-external-interface:url">URL</a> to an OpenSearch
    description document. <a href="#refsOPENSEARCH">[OPENSEARCH]</a></p></li></ol>

   <p>The <dfn id="dom-external-issearchproviderinstalled"><code>IsSearchProviderInstalled()</code></dfn>
   method, when invoked, must run the following steps:
   <a href="/breakup/specs/html/#fingerprinting-vector" id="the-external-interface:fingerprinting-vector" class="fingerprint" title="There is a potential fingerprinting vector here."><img alt="(This is a fingerprinting vector.)" src="img/fingerprint.png" width="46" height="64"></a>
   </p>

   <ol><li><p>Optionally, return 0 and abort these steps. User agents may implement the method as a
    stub method that never returns a non-zero value, or may arbitrarily ignore invocations with
    particular arguments for security, privacy, or usability reasons.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="the-external-interface:origin-2">origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-external-interface:entry-settings-object-2">entry settings object</a> is an
    opaque identifier (i.e. it has no host component), then return 0 and abort these steps.</p></li><li><p>Let <var>host1</var> be the host component of the <a href="/breakup/specs/browser-dom/#origin-2" id="the-external-interface:origin-2-2">origin</a> specified
    by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-external-interface:entry-settings-object-3">entry settings object</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#resolve-a-url" id="the-external-interface:resolve-a-url-2">Resolve</a> the <var>scriptURL</var> argument
    relative to the <a href="/breakup/specs/browser-dom/#api-base-url" id="the-external-interface:api-base-url-2">API base URL</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="the-external-interface:entry-settings-object-4">entry settings
    object</a>.</p></li><li><p>If this fails, return 0 and abort these steps.</p></li><li><p>Let <var>host2</var> be the <a href="/breakup/specs/core-algorithms/#concept-url-host" id="the-external-interface:concept-url-host">host</a> component
    of the resulting <a href="/breakup/specs/core-algorithms/#parsed-url" id="the-external-interface:parsed-url">parsed URL</a>.</p></li><li>

     <p>If the longest suffix in the Public Suffix List that matches the end of <var>host1</var> is different than the longest suffix in the Public Suffix List that
     matches the end of <var>host2</var>, then return 0 and abort these steps. <a href="#refsPSL">[PSL]</a></p>

     <p>If the next domain component of <var>host1</var> and <var>host2</var>
     after their common suffix are not the same, then return 0 and abort these steps.</p>

     

    </li><li><p>Let <var>search engines</var> be the list of search engines known by the user
    agent and made available to the user by the user agent for which the resulting <a href="/breakup/specs/core-algorithms/#absolute-url" id="the-external-interface:absolute-url-2">absolute
    URL</a> is a <a href="/breakup/specs/core-algorithms/#prefix-match" id="the-external-interface:prefix-match">prefix match</a> of the search engine's <a href="/breakup/specs/core-algorithms/#url" id="the-external-interface:url-2">URL</a>, if any. For
    search engines registered using OpenSearch description documents, the <a href="/breakup/specs/core-algorithms/#url" id="the-external-interface:url-3">URL</a> of the
    search engine corresponds to the URL given in a <code>Url</code> element whose <code>rel</code> attribute is "<code>results</code>" (the default). <a href="#refsOPENSEARCH">[OPENSEARCH]</a></p></li><li><p>If <var>search engines</var> is empty, return 0 and abort these steps.</p></li><li><p>If the user's default search engine (as determined by the user agent) is one of the
    search engines in <var>search engines</var>, then return 2 and abort these
    steps.</p></li><li><p>Return 1.</p></li></ol></section></section><section><h3 id="images">7.7 Images</h3>

  <pre class="idl">[Exposed=(Window,Worker)]
interface <dfn id="imagebitmap">ImageBitmap</dfn> {
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-imagebitmap-width" id="images:dom-imagebitmap-width">width</a>;
  readonly attribute unsigned long <a href="/breakup/specs/browser-dom/#dom-imagebitmap-height" id="images:dom-imagebitmap-height">height</a>;
};

typedef (<a href="#htmlimageelement" id="images:htmlimageelement">HTMLImageElement</a> or
         <a href="#htmlvideoelement" id="images:htmlvideoelement">HTMLVideoElement</a> or
         <a href="#htmlcanvaselement" id="images:htmlcanvaselement">HTMLCanvasElement</a> or
         <a href="/breakup/specs/core-algorithms/#blob" id="images:blob">Blob</a> or
         <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata" id="images:imagedata">ImageData</a> or
         <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d" id="images:canvasrenderingcontext2d">CanvasRenderingContext2D</a> or
         <a href="/breakup/specs/browser-dom/#imagebitmap" id="images:imagebitmap">ImageBitmap</a>) <dfn id="imagebitmapsource">ImageBitmapSource</dfn>;

[NoInterfaceObject, Exposed=(Window,Worker)]
interface <dfn id="imagebitmapfactories">ImageBitmapFactories</dfn> {
  <a href="/breakup/specs/core-algorithms/#promise" id="images:promise">Promise</a>&lt;ImageBitmap&gt; <a href="/breakup/specs/browser-dom/#dom-createimagebitmap" id="images:dom-createimagebitmap">createImageBitmap</a>(<a href="/breakup/specs/browser-dom/#imagebitmapsource" id="images:imagebitmapsource">ImageBitmapSource</a> image);
  <a href="/breakup/specs/core-algorithms/#promise" id="images:promise-2">Promise</a>&lt;ImageBitmap&gt; <a href="/breakup/specs/browser-dom/#dom-createimagebitmap" id="images:dom-createimagebitmap-2">createImageBitmap</a>(<a href="/breakup/specs/browser-dom/#imagebitmapsource" id="images:imagebitmapsource-2">ImageBitmapSource</a> image, long sx, long sy, long sw, long sh);
};
<a href="/breakup/specs/browser-dom/#window" id="images:window">Window</a> implements <a href="/breakup/specs/browser-dom/#imagebitmapfactories" id="images:imagebitmapfactories">ImageBitmapFactories</a>;
<a href="http://www.w3.org/TR/workers/#workerglobalscope" id="images:workerglobalscope">WorkerGlobalScope</a> implements <a href="/breakup/specs/browser-dom/#imagebitmapfactories" id="images:imagebitmapfactories-2">ImageBitmapFactories</a>;</pre>

  <p>An <code id="images:imagebitmap-2"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object represents a bitmap image that can be painted to a canvas
  without undue latency.</p>

  <p class="note">The exact judgement of what is undue latency of this is left up to the
  implementer, but in general if making use of the bitmap requires network I/O, or even local disk
  I/O, then the latency is probably undue; whereas if it only requires a blocking read from a GPU or
  system RAM, the latency is probably acceptable.</p>

  <dl class="domintro"><dt><var>promise</var> = <var>Window</var> . <code id="images:dom-createimagebitmap-3"><a href="/breakup/specs/browser-dom/#dom-createimagebitmap">createImageBitmap</a></code>(<var>image</var> [, <var>sx</var>, <var>sy</var>, <var>sw</var>, <var>sh</var> ] )</dt><dd>

    <p>Takes <var>image</var>, which can be an <code id="images:the-img-element"><a href="#the-img-element">img</a></code> element,
    <code id="images:the-video-element"><a href="#the-video-element">video</a></code>, or <code id="images:the-canvas-element"><a href="#the-canvas-element">canvas</a></code> element, a <code id="images:blob-2"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object, an
    <code id="images:imagedata-2"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata">ImageData</a></code> object, a <code id="images:canvasrenderingcontext2d-2"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object, or another
    <code id="images:imagebitmap-3"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object, and returns a <code id="images:promise-3"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> that is resolved when a
    new <code id="images:imagebitmap-4"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> is created.</p>

    <p>If no <code id="images:imagebitmap-5"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object can be constructed, for example because the provided
    <var>image</var> data is not actually an image, then the promise is rejected instead.</p>

    <p>If <var>sx</var>, <var>sy</var>, <var>sw</var>, and <var>sh</var> arguments are provided, the source image is cropped to the given pixels, with
    any pixels missing in the original replaced by transparent black. These coordinates are in the
    source image's pixel coordinate space, <em>not</em> in CSS pixels.</p>

    <p>Rejects the promise with an <code id="images:invalidstateerror"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception if the source image is not in a valid
    state (e.g. an <code id="images:the-img-element-2"><a href="#the-img-element">img</a></code> element that hasn't finished loading, or a
    <code id="images:canvasrenderingcontext2d-3"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object whose bitmap data has zero length along one or both
    dimensions, or an <code id="images:imagedata-3"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata">ImageData</a></code> object whose data is <code id="images:dom-imagedata-data"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#dom-imagedata-data">data</a></code> attribute has been <a href="/breakup/specs/core-algorithms/#concept-transferable-neutered" id="images:concept-transferable-neutered">neutered</a>). Rejects the promise with a <code id="images:securityerror"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code>
    exception if the script is not allowed to access the image data of the source image (e.g. a
    <code id="images:the-video-element-2"><a href="#the-video-element">video</a></code> that is <a href="/breakup/specs/core-algorithms/#cors-cross-origin" id="images:cors-cross-origin">CORS-cross-origin</a>, or a <code id="images:the-canvas-element-2"><a href="#the-canvas-element">canvas</a></code> being drawn
    on by a script in a worker from another <a href="/breakup/specs/browser-dom/#origin-2" id="images:origin-2">origin</a>).</p>

   </dd><dt><var>imageBitmap</var> . <code id="images:dom-imagebitmap-width-2"><a href="/breakup/specs/browser-dom/#dom-imagebitmap-width">width</a></code></dt><dd>

    <p>Returns the intrinsic width of the image, in CSS pixels.</p>

   </dd><dt><var>imageBitmap</var> . <code id="images:dom-imagebitmap-height-2"><a href="/breakup/specs/browser-dom/#dom-imagebitmap-height">height</a></code></dt><dd>

    <p>Returns the intrinsic height of the image, in CSS pixels.</p>

   </dd></dl>

  

  <p>An <code id="images:imagebitmap-6"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object always has associated bitmap data, with a width and a
  height. However, it is possible for this data to be corrupted. If an <code id="images:imagebitmap-7"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code>
  object's media data can be decoded without errors, it is said to be <dfn id="concept-imagebitmap-good">fully decodable</dfn>.</p>

  <p>An <code id="images:imagebitmap-8"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object can be obtained from a variety of different objects, using
  the <dfn id="dom-createimagebitmap"><code>createImageBitmap()</code></dfn> method. When invoked, the
  method must act as follows:</p>
  

  <dl><dt>If <var>image</var> is an <code id="images:the-img-element-3"><a href="#the-img-element">img</a></code> element

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-img-element-4"><a href="#the-img-element">img</a></code> element is not <a href="#img-all" id="images:img-all">completely
     available</a>, then return a promise rejected with an <code id="images:invalidstateerror-2"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these
     steps.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="images:origin-2-2">origin</a> of the <code id="images:the-img-element-5"><a href="#the-img-element">img</a></code> element's image is not the <a href="/breakup/specs/browser-dom/#same-origin" id="images:same-origin">same
     origin</a> as the <a href="/breakup/specs/browser-dom/#origin-2" id="images:origin-2-3">origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="images:entry-settings-object">entry settings object</a>,
     then return a promise rejected with a <code id="images:securityerror-2"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-img-element-6"><a href="#the-img-element">img</a></code> element's media data is not a bitmap (e.g. it's a vector
     graphic), then return a promise rejected with an <code id="images:invalidstateerror-3"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these
     steps.</p></li><li><p>Create a new <code id="images:imagebitmap-9"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-10"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be a copy of the <code id="images:the-img-element-7"><a href="#the-img-element">img</a></code>
     element's media data, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle">cropped to the source rectangle</a>. If this is an animated
     image, the <code id="images:imagebitmap-11"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data must only be taken from the default
     image of the animation (the one that the format defines is to be used when animation is not
     supported or is disabled), or, if there is no such image, the first frame of the
     animation.</p></li><li><p>Return a new <code id="images:promise-4"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps
     <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill">Resolve</a> the <code id="images:promise-5"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-12"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is a <code id="images:the-video-element-3"><a href="#the-video-element">video</a></code> element

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-2"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-video-element-4"><a href="#the-video-element">video</a></code> element's <code id="images:dom-media-networkstate"><a href="#dom-media-networkstate">networkState</a></code> attribute is <code id="images:dom-media-network_empty"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, then return a promise rejected with an
     <code id="images:invalidstateerror-4"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>If the <a href="/breakup/specs/browser-dom/#origin-2" id="images:origin-2-4">origin</a> of the <code id="images:the-video-element-5"><a href="#the-video-element">video</a></code> element is not the <a href="/breakup/specs/browser-dom/#same-origin" id="images:same-origin-2">same
     origin</a> as the <a href="/breakup/specs/browser-dom/#origin-2" id="images:origin-2-5">origin</a> specified by the <a href="/breakup/specs/browser-dom/#entry-settings-object" id="images:entry-settings-object-2">entry settings object</a>,
     then return a promise rejected with a <code id="images:securityerror-3"><a href="/breakup/specs/core-algorithms/#securityerror">SecurityError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-video-element-6"><a href="#the-video-element">video</a></code> element's <code id="images:dom-media-readystate"><a href="#dom-media-readystate">readyState</a></code> attribute is either <code id="images:dom-media-have_nothing"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code> or <code id="images:dom-media-have_metadata"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code>, then return a promise rejected with an
     <code id="images:invalidstateerror-5"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-13"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-14"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be a copy of the frame at the
     <a href="#current-playback-position" id="images:current-playback-position">current playback position</a>, at the <a href="#media-resource" id="images:media-resource">media resource</a>'s <a href="#concept-video-intrinsic-width" id="images:concept-video-intrinsic-width">intrinsic width</a> and <a href="#concept-video-intrinsic-height" id="images:concept-video-intrinsic-height">intrinsic height</a> (i.e. after any aspect-ratio
     correction has been applied), <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-2">cropped to the source rectangle</a>.</p>

     </li><li><p>Return a new <code id="images:promise-6"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps
     <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-2">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-2">Resolve</a> the <code id="images:promise-7"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-15"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is a <code id="images:the-canvas-element-3"><a href="#the-canvas-element">canvas</a></code> element

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-3"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-canvas-element-4"><a href="#the-canvas-element">canvas</a></code> element's bitmap data does not have its <a href="#concept-canvas-origin-clean" id="images:concept-canvas-origin-clean">origin-clean</a> flag set, then return a promise rejected with an
     <code id="images:invalidstateerror-6"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:the-canvas-element-5"><a href="#the-canvas-element">canvas</a></code> element's bitmap has either a horizontal dimension or a
     vertical dimension equal to zero, then return a promise rejected with an <code id="images:invalidstateerror-7"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and
     abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-16"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-17"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be a copy of the
     <code id="images:the-canvas-element-6"><a href="#the-canvas-element">canvas</a></code> element's bitmap data, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-3">cropped to the source
     rectangle</a>.</p></li><li><p>Return a new <code id="images:promise-8"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-3">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-3">Resolve</a> the <code id="images:promise-9"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-18"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is a <code id="images:blob-3"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-4"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:blob-4"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object has been disabled through the <code id="images:dom-blob-close"><a href="/breakup/specs/core-algorithms/#dom-blob-close">close()</a></code> method, then return a promise rejected with an <code id="images:invalidstateerror-8"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code>
     exception and abort these steps.</p></li><li><p>Return a new <code id="images:promise-10"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-4">in parallel</a>.</p></li><li><p>Read the <code id="images:blob-5"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object's data. If an <a href="/breakup/specs/core-algorithms/#file-error-read" id="images:file-error-read">error
     occurs during reading of the object</a>, then <a href="/breakup/specs/core-algorithms/#concept-resolver-reject" id="images:concept-resolver-reject">reject</a> the <code id="images:promise-11"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>'s associated <a href="/breakup/specs/core-algorithms/#concept-resolver" id="images:concept-resolver">resolver</a>, with null as the value, and abort these
     steps.</p></li><li><p>Apply the <a href="https://mimesniff.spec.whatwg.org/#rules-for-sniffing-images-specifically" id="images:content-type-sniffing:-image" data-x-internal="content-type-sniffing:-image">image sniffing rules</a> to
     determine the file format of the image data, with MIME type of the <code id="images:blob-6"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> (as given
     by the <code id="images:blob-7"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object's <code id="images:dom-blob-type"><a href="/breakup/specs/core-algorithms/#dom-blob-type">type</a></code> attribute) giving the
     official type.</p></li><li><p>If the image data is not in a supported file format (e.g. it's not actually an image at
     all), or if the image data is corrupted in some fatal way such that the image dimensions cannot
     be obtained, then <a href="/breakup/specs/core-algorithms/#concept-resolver-reject" id="images:concept-resolver-reject-2">reject</a> the
     <code id="images:promise-12"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>'s associated <a href="/breakup/specs/core-algorithms/#concept-resolver" id="images:concept-resolver-2">resolver</a>, with null as
     the value, and abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-19"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-20"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be the image data read from the
     <code id="images:blob-8"><a href="/breakup/specs/core-algorithms/#blob">Blob</a></code> object, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-4">cropped to the source rectangle</a>. If this is an animated
     image, the <code id="images:imagebitmap-21"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data must only be taken from the default
     image of the animation (the one that the format defines is to be used when animation is not
     supported or is disabled), or, if there is no such image, the first frame of the
     animation.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-4">Resolve</a> the <code id="images:promise-13"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-22"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is an <code id="images:imagedata-4"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata">ImageData</a></code> object

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-5"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <var>image</var> object's <code id="images:dom-imagedata-data-2"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#dom-imagedata-data">data</a></code>
     attribute has been <a href="/breakup/specs/core-algorithms/#concept-transferable-neutered" id="images:concept-transferable-neutered-2">neutered</a>, return a promise rejected with an
     <code id="images:invalidstateerror-9"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-23"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-24"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be the image data given by the
     <code id="images:imagedata-5"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata">ImageData</a></code> object, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-5">cropped to the source rectangle</a>.</p></li><li><p>Return a new <code id="images:promise-14"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-5">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-5">Resolve</a> the <code id="images:promise-15"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-25"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is a <code id="images:canvasrenderingcontext2d-4"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-6"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:canvasrenderingcontext2d-5"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object's <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#scratch-bitmap" id="images:scratch-bitmap">scratch bitmap</a> does
     not have its <a href="#concept-canvas-origin-clean" id="images:concept-canvas-origin-clean-2">origin-clean</a> flag set, then return a promise rejected with
     an <code id="images:invalidstateerror-10"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>If the <code id="images:canvasrenderingcontext2d-6"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object's <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#scratch-bitmap" id="images:scratch-bitmap-2">scratch bitmap</a> has
     either a horizontal dimension or a vertical dimension equal to zero, then return a promise rejected with an
     <code id="images:invalidstateerror-11"><a href="/breakup/specs/core-algorithms/#invalidstateerror">InvalidStateError</a></code> exception and abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-26"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-27"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be a copy of the
     <code id="images:canvasrenderingcontext2d-7"><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object's <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#scratch-bitmap" id="images:scratch-bitmap-3">scratch bitmap</a>, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-6">cropped to
     the source rectangle</a>.</p></li><li><p>Return a new <code id="images:promise-16"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps
     <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-6">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-6">Resolve</a> the <code id="images:promise-17"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-28"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd><dt>If <var>image</var> is an <code id="images:imagebitmap-29"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object

   </dt><dd>

    <ol><li><p>If either the <var>sw</var> or <var>sh</var> arguments are specified
     but zero, return a promise rejected with an <code id="images:indexsizeerror-7"><a href="/breakup/specs/core-algorithms/#indexsizeerror">IndexSizeError</a></code> exception and abort these steps.</p></li><li><p>Create a new <code id="images:imagebitmap-30"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object.</p></li><li><p>Let the <code id="images:imagebitmap-31"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's bitmap data be a copy of the <var>image</var> argument's bitmap data, <a href="/breakup/specs/browser-dom/#cropped-to-the-source-rectangle" id="images:cropped-to-the-source-rectangle-7">cropped to the source
     rectangle</a>.</p></li><li><p>Return a new <code id="images:promise-18"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code>, but continue running these steps
     <a href="/breakup/specs/core-algorithms/#in-parallel" id="images:in-parallel-7">in parallel</a>.</p></li><li><p><a href="/breakup/specs/core-algorithms/#concept-resolver-fulfill" id="images:concept-resolver-fulfill-7">Resolve</a> the <code id="images:promise-19"><a href="/breakup/specs/core-algorithms/#promise">Promise</a></code> with the new
     <code id="images:imagebitmap-32"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object as the value.</p></li></ol>

   </dd></dl>

  <p>When the steps above require that the user agent <dfn id="cropped-to-the-source-rectangle">crop bitmap data to the source rectangle</dfn>, the user agent must run the following
  steps:</p>

  <ol><li><p>Let <var>input</var> be the image data being cropped.</p></li><li><p>If the <var>sx</var>, <var>sy</var>, <var>sw</var>, and <var>sh</var> arguments are omitted, return <var>input</var>.</p></li><li><p>Place <var>input</var> on an infinite transparent black grid plane, positioned so
   that it's top left corner is at the origin of the plane, with the <var>x</var>-coordinate increasing to the right, and the <var>y</var>-coordinate
   increasing down, and with each pixel in the <var>input</var> image data occupying a cell
   on the plane's grid.</p></li><li>

    <p>Let <var>output</var> be the rectangle on the plane denoted by the rectangle whose
    corners are the four points (<var>sx</var>, <var>sy</var>), (<span><var>sx</var>+<var>sw</var></span>, <var>sy</var>), (<span><var>sx</var>+<var>sw</var></span>, <span><var>sy</var>+<var>sh</var></span>), (<var>sx</var>, <span><var>sy</var>+<var>sh</var></span>).</p>

    <p class="note">If either <var>sw</var> or <var>sh</var> are negative, then
    the top-left corner of this rectangle will be to the left or above the (<var>sx</var>,
    <var>sy</var>) point. If any of the pixels on this rectangle are outside the area where
    the <var>input</var> bitmap was placed, then they will be transparent black in <var>output</var>.</p>

   </li><li><p>Return <var>output</var>.</p></li></ol>

  <p>The <dfn id="dom-imagebitmap-width"><code>width</code></dfn> attribute must return the
  <code id="images:imagebitmap-33"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's width, in CSS pixels.</p>

  <p>The <dfn id="dom-imagebitmap-height"><code>height</code></dfn> attribute must return the
  <code id="images:imagebitmap-34"><a href="/breakup/specs/browser-dom/#imagebitmap">ImageBitmap</a></code> object's height, in CSS pixels.</p>

  

  <div class="example">

   <p>Using this API, a sprite sheet can be precut and prepared:</p>

   <pre>var sprites = {};
function loadMySprites() {
  var image = new Image();
  image.src = 'mysprites.png';
  var resolver;
  var promise = new Promise(function (arg) { resolver = arg });
  image.onload = function () {
    resolver(Promise.all(
      createImageBitmap(image,  0,  0, 40, 40).then(function (image) { sprites.woman = image }),
      createImageBitmap(image, 40,  0, 40, 40).then(function (image) { sprites.man   = image }),
      createImageBitmap(image, 80,  0, 40, 40).then(function (image) { sprites.tree  = image }),
      createImageBitmap(image,  0, 40, 40, 40).then(function (image) { sprites.hut   = image }),
      createImageBitmap(image, 40, 40, 40, 40).then(function (image) { sprites.apple = image }),
      createImageBitmap(image, 80, 40, 40, 40).then(function (image) { sprites.snake = image }),
    ));
  };
  return promise;
}

function runDemo() {
  var canvas = document.querySelector('canvas#demo');
  var context = canvas.getContext('2d');
  context.drawImage(sprites.tree, 30, 10);
  context.drawImage(sprites.snake, 70, 10);
}

loadMySprites().then(runDemo);</pre>

  </div></section><section><h3 id="animation-frames">7.8 Animation Frames</h3>

  <p>Each <code id="animation-frames:document"><a href="/breakup/specs/browser-dom/#document">Document</a></code> has a <dfn id="list-of-animation-frame-callbacks">list of animation frame callbacks</dfn>, which must be
  initially empty, and an <dfn id="animation-frame-callback-identifier">animation frame callback identifier</dfn>, which is a number which
  must initially be zero.</p>

  <p>When the <dfn id="dom-window-requestanimationframe"><code>requestAnimationFrame()</code></dfn> method is called,
  the user agent must run the following steps:</p>

  <ol><li><p>Let <var>document</var> be <a href="/breakup/specs/browser-dom/#concept-document-window" id="animation-frames:concept-document-window">the
   <code>Window</code> object's <code>Document</code> object</a>.</p></li><li><p>Increment <var>document</var>'s <a href="/breakup/specs/browser-dom/#animation-frame-callback-identifier" id="animation-frames:animation-frame-callback-identifier">animation frame callback identifier</a> by
   one.</p></li><li><p>Append the method's argument to <var>document</var>'s <a href="/breakup/specs/browser-dom/#list-of-animation-frame-callbacks" id="animation-frames:list-of-animation-frame-callbacks">list of animation frame
   callbacks</a>, associated with <var>document</var>'s <a href="/breakup/specs/browser-dom/#animation-frame-callback-identifier" id="animation-frames:animation-frame-callback-identifier-2">animation frame callback
   identifier</a>'s current value.</p></li><li><p>Return <var>document</var>'s <a href="/breakup/specs/browser-dom/#animation-frame-callback-identifier" id="animation-frames:animation-frame-callback-identifier-3">animation frame callback identifier</a>'s current
   value.</p></li></ol>

  <p>When the <dfn id="dom-window-cancelanimationframe"><code>cancelAnimationFrame()</code></dfn> method is called,
  the user agent must run the following steps:</p>

  <ol><li><p>Let <var>document</var> be <a href="/breakup/specs/browser-dom/#concept-document-window" id="animation-frames:concept-document-window-2">the
   <code>Window</code> object's <code>Document</code> object</a>.</p></li><li><p>Find the entry in <var>document</var>'s <a href="/breakup/specs/browser-dom/#list-of-animation-frame-callbacks" id="animation-frames:list-of-animation-frame-callbacks-2">list of animation frame callbacks</a>
   that is associated with the value given by the method's argument.</p></li><li><p>If there is such an entry, remove it from <var>document</var>'s <a href="/breakup/specs/browser-dom/#list-of-animation-frame-callbacks" id="animation-frames:list-of-animation-frame-callbacks-3">list of animation
   frame callbacks</a>.</p></li></ol>

  <p>When the user agent is to <dfn id="run-the-animation-frame-callbacks">run the animation frame callbacks</dfn> for a
  <code id="animation-frames:document-2"><a href="/breakup/specs/browser-dom/#document">Document</a></code> <var>doc</var> with a timestamp <var>now</var>, it must run the following
  steps:</p>

  <ol><li><p>Let <var>callbacks</var> be a list of the entries in <var>doc</var>'s <a href="/breakup/specs/browser-dom/#list-of-animation-frame-callbacks" id="animation-frames:list-of-animation-frame-callbacks-4">list of
   animation frame callbacks</a>, in the order in which they were added to the list.</p></li><li><p>Set <var>doc</var>'s <a href="/breakup/specs/browser-dom/#list-of-animation-frame-callbacks" id="animation-frames:list-of-animation-frame-callbacks-5">list of animation frame callbacks</a> to the empty
   list.</p></li><li><p>For each entry in <var>callbacks</var>, in order: <a href="http://heycam.github.io/webidl/#es-invoking-callback-functions" id="animation-frames:es-invoking-callback-functions" data-x-internal="es-invoking-callback-functions">invoke the callback</a>, passing
   <var>now</var> as the only argument, and if an exception is thrown, <a href="/breakup/specs/browser-dom/#report-the-exception" id="animation-frames:report-the-exception">report the
   exception</a>. <a href="#refsWEBIDL">[WEBIDL]</a></p></li></ol></section></body></html>